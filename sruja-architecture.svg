<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    version="1.1"
    width="100%"
    height="100%"
    viewBox="0 0 2400 1600">
    <title>Sruja Architecture: Interactive C4 Model with Requirements, ADRs &amp; Technology Choices</title>
    <desc>A comprehensive, shareable SVG file containing C4 architecture diagrams at multiple levels, requirements, user stories, ADRs, and technology choices for the Sruja architecture-as-code language.</desc>

    <!--
    ================================================================================
    1. STYLES (Embedded CSS)
    ================================================================================
    -->
    <style type="text/css">
        /* General Layout and Text */
        text { font-family: 'Segoe UI', 'Arial', sans-serif; fill: #2c3e50; }
        .title { font-size: 42px; font-weight: bold; fill: #2c3e50; }
        .subtitle { font-size: 20px; fill: #7f8c8d; }
        .section-header { font-size: 26px; font-weight: bold; fill: #34495e; text-decoration: underline; }
        .doc-text { font-size: 16px; line-height: 1.4; }
        .doc-list-item { font-size: 15px; line-height: 1.5; }
        .tech-badge { font-size: 14px; fill: #ffffff; font-weight: bold; }

        /* Diagram Elements (C4 Style) */
        .system-boundary { fill: none; stroke: #95a5a6; stroke-width: 3; stroke-dasharray: 10 5; }
        .container-boundary { fill: none; stroke: #bdc3c7; stroke-width: 2; stroke-dasharray: 5 3; }
        .system-box { fill: #3498db; stroke: #2980b9; stroke-width: 4; cursor: pointer; }
        .container-box { fill: #f1c40f; stroke: #f39c12; stroke-width: 3; cursor: pointer; }
        .component-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; cursor: pointer; }
        .person-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 4; cursor: pointer; }
        .db-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 3; cursor: pointer; }
        .external-box { fill: #95a5a6; stroke: #7f8c8d; stroke-width: 3; cursor: pointer; }
        
        .interactive:hover { opacity: 0.85; transform: scale(1.02); }
        .selected { stroke-width: 6 !important; opacity: 0.95; filter: drop-shadow(0 0 8px rgba(52, 152, 219, 0.6)); }

        /* Buttons and UI */
        .button { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 2; cursor: pointer; rx: 5; }
        .button:hover { fill: #dfe6e9; stroke: #3498db; stroke-width: 2.5; }
        .button-active { fill: #3498db; stroke: #2980b9; }
        .button-text { font-size: 16px; font-weight: bold; text-anchor: middle; alignment-baseline: central; fill: #2c3e50; pointer-events: none; }
        .button-text-active { fill: #ffffff; }

        /* The Documentation Panel */
        #docPanel { fill: #ffffff; stroke: #bdc3c7; stroke-width: 2; rx: 8; }
        .filter-button { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 1.5; cursor: pointer; rx: 3; }
        .filter-button:hover { fill: #d5dbdb; }
        .filter-button-active { fill: #3498db; stroke: #2980b9; }
        .filter-text { font-size: 13px; text-anchor: middle; alignment-baseline: central; fill: #2c3e50; pointer-events: none; }
        .filter-text-active { fill: #ffffff; }

        /* Scrollable content area */
        .scrollable { overflow: visible; }
    </style>

    <!--
    ================================================================================
    2. DATA STORE (Hidden XML for Documentation)
    ================================================================================
    -->
    <defs>
        <!-- Level 1: System Context Data -->
        <g id="data-level1-overview" style="display:none;">
            <text x="0" y="0" class="section-header">System Context: Sruja Architecture</text>
            <text x="0" y="40" class="subtitle">Level 1 - High-level system interactions</text>
            <text x="0" y="80" class="doc-text">Sruja is an architecture-as-code language tool that enables developers to define, validate, and export software architecture using a domain-specific language.</text>
        </g>

        <g id="data-developer" style="display:none;">
            <text x="0" y="0" class="section-header">Developer (Person)</text>
            <text x="0" y="40" class="subtitle">Primary User of Sruja</text>
            <text x="0" y="80" class="doc-text">Software architects, developers, and teams who need to document, validate, and visualize their system architecture.</text>
            <text x="0" y="120" class="section-header">User Stories</text>
            <text x="0" y="160" class="doc-list-item">- US1: As a developer, I want to define architecture in code so it's version-controlled and reviewable.</text>
            <text x="0" y="185" class="doc-list-item">- US2: As an architect, I want to validate architecture rules so I can catch issues early.</text>
            <text x="0" y="210" class="doc-list-item">- US3: As a team, I want to export diagrams so we can share architecture with stakeholders.</text>
        </g>

        <g id="data-sruja-system" style="display:none;">
            <text x="0" y="0" class="section-header">Sruja System</text>
            <text x="0" y="40" class="subtitle">The complete Sruja architecture-as-code platform</text>
            <text x="0" y="80" class="doc-text">Sruja provides a DSL for defining software architecture following C4 model principles, with built-in validation, formatting, and export capabilities.</text>
            <text x="0" y="120" class="section-header">Key Capabilities</text>
            <text x="0" y="160" class="doc-list-item">- Parse and validate .sruja DSL files</text>
            <text x="0" y="185" class="doc-list-item">- Export to D2 format for diagram generation</text>
            <text x="0" y="210" class="doc-list-item">- Format and lint architecture definitions</text>
            <text x="0" y="235" class="doc-list-item">- Support requirements, ADRs, and metadata</text>
        </g>

        <g id="data-external-filesystem" style="display:none;">
            <text x="0" y="0" class="section-header">File System (External)</text>
            <text x="0" y="40" class="subtitle">Local file system for .sruja files</text>
            <text x="0" y="80" class="doc-text">Sruja reads and writes .sruja architecture definition files from the local file system.</text>
        </g>

        <!-- Level 2: Container Data -->
        <g id="data-cli" style="display:none;">
            <text x="0" y="0" class="section-header">CLI Container</text>
            <text x="0" y="40" class="subtitle">Command-line interface (cmd/sruja)</text>
            <text x="0" y="80" class="doc-text">Entry point for all Sruja operations. Built with Cobra framework for command management.</text>
            <text x="0" y="120" class="section-header">Technology</text>
            <text x="0" y="160" class="doc-list-item">- Go 1.25+</text>
            <text x="0" y="185" class="doc-list-item">- Cobra CLI framework</text>
            <text x="0" y="210" class="section-header">Commands</text>
            <text x="0" y="250" class="doc-list-item">- compile: Validate and compile .sruja files</text>
            <text x="0" y="275" class="doc-list-item">- lint: Check for architecture issues</text>
            <text x="0" y="300" class="doc-list-item">- fmt: Format .sruja files</text>
            <text x="0" y="325" class="doc-list-item">- export: Export to D2 or other formats</text>
            <text x="0" y="350" class="doc-list-item">- tree: Visualize architecture hierarchy</text>
            <text x="0" y="375" class="doc-list-item">- explain: Get explanations for elements</text>
        </g>

        <g id="data-language-parser" style="display:none;">
            <text x="0" y="0" class="section-header">Language Parser Container</text>
            <text x="0" y="40" class="subtitle">DSL parser and AST (pkg/language)</text>
            <text x="0" y="80" class="doc-text">Parses .sruja DSL files into an Abstract Syntax Tree (AST) representation.</text>
            <text x="0" y="120" class="section-header">Technology</text>
            <text x="0" y="160" class="doc-list-item">- Go parser combinators</text>
            <text x="0" y="185" class="doc-list-item">- Custom lexer and tokenizer</text>
            <text x="0" y="210" class="section-header">Key Components</text>
            <text x="0" y="250" class="doc-list-item">- Lexer: Tokenizes input</text>
            <text x="0" y="275" class="doc-list-item">- Parser: Builds AST from tokens</text>
            <text x="0" y="300" class="doc-list-item">- AST: Represents architecture structure</text>
            <text x="0" y="325" class="doc-list-item">- Printer: Formats AST back to DSL</text>
            <text x="0" y="350" class="section-header">Requirements</text>
            <text x="0" y="390" class="doc-list-item">- R1: Must parse C4 model elements (system, container, component)</text>
            <text x="0" y="415" class="doc-list-item">- R2: Must support requirements and ADRs</text>
            <text x="0" y="440" class="doc-list-item">- R3: Must provide source location for error reporting</text>
        </g>

        <g id="data-validation-engine" style="display:none;">
            <text x="0" y="0" class="section-header">Validation Engine Container</text>
            <text x="0" y="40" class="subtitle">Architecture validation (pkg/engine)</text>
            <text x="0" y="80" class="doc-text">Validates architecture definitions against rules to ensure correctness and consistency.</text>
            <text x="0" y="120" class="section-header">Technology</text>
            <text x="0" y="160" class="doc-list-item">- Go validation framework</text>
            <text x="0" y="185" class="doc-list-item">- Rule-based validation system</text>
            <text x="0" y="210" class="section-header">Validation Rules</text>
            <text x="0" y="250" class="doc-list-item">- Unique ID rule: Ensures all elements have unique identifiers</text>
            <text x="0" y="275" class="doc-list-item">- Valid reference rule: Checks that references exist</text>
            <text x="0" y="300" class="doc-list-item">- Cycle detection: Prevents circular dependencies</text>
            <text x="0" y="325" class="doc-list-item">- Orphan detection: Finds unreferenced elements</text>
            <text x="0" y="350" class="doc-list-item">- External dependency rule: Validates external system references</text>
            <text x="0" y="375" class="section-header">ADR 001</text>
            <text x="0" y="415" class="doc-text">Title: Rule-based validation architecture</text>
            <text x="0" y="445" class="doc-text">Status: Accepted</text>
            <text x="0" y="475" class="doc-text">Decision: Use a pluggable rule system to allow extensible validation without modifying core engine.</text>
        </g>

        <g id="data-exporters" style="display:none;">
            <text x="0" y="0" class="section-header">Exporters Container</text>
            <text x="0" y="40" class="subtitle">Format exporters (pkg/export)</text>
            <text x="0" y="80" class="doc-text">Converts AST to various output formats for visualization and documentation.</text>
            <text x="0" y="120" class="section-header">Technology</text>
            <text x="0" y="160" class="doc-list-item">- D2 exporter (primary)</text>
            <text x="0" y="185" class="doc-list-item">- Extensible exporter interface</text>
            <text x="0" y="210" class="section-header">Export Formats</text>
            <text x="0" y="250" class="doc-list-item">- D2: For diagram generation</text>
            <text x="0" y="275" class="doc-text">(Future: PlantUML, Mermaid, JSON, etc.)</text>
            <text x="0" y="310" class="section-header">ADR 002</text>
            <text x="0" y="350" class="doc-text">Title: D2 as primary export format</text>
            <text x="0" y="380" class="doc-text">Status: Accepted</text>
            <text x="0" y="410" class="doc-text">Decision: D2 provides excellent diagram rendering and is actively maintained. Chosen over PlantUML for better modern tooling support.</text>
        </g>

        <g id="data-dx-helpers" style="display:none;">
            <text x="0" y="0" class="section-header">DX Helpers Container</text>
            <text x="0" y="40" class="subtitle">Developer experience utilities (pkg/dx)</text>
            <text x="0" y="80" class="doc-text">Provides enhanced error messages, explanations, and developer-friendly output formatting.</text>
            <text x="0" y="120" class="section-header">Technology</text>
            <text x="0" y="160" class="doc-list-item">- Go error enhancement</text>
            <text x="0" y="185" class="doc-list-item">- Context-aware messaging</text>
            <text x="0" y="210" class="section-header">Key Features</text>
            <text x="0" y="250" class="doc-list-item">- Error enhancement with file/line context</text>
            <text x="0" y="275" class="doc-list-item">- Element explanations</text>
            <text x="0" y="300" class="doc-list-item">- CLI formatting utilities</text>
        </g>

        <!-- Level 3: Component Data -->
        <g id="data-cobra-commands" style="display:none;">
            <text x="0" y="0" class="section-header">Cobra Commands Component</text>
            <text x="0" y="40" class="subtitle">Command definitions (cmd/sruja/cobra.go)</text>
            <text x="0" y="80" class="doc-text">Defines all CLI commands using Cobra framework.</text>
        </g>

        <g id="data-lexer" style="display:none;">
            <text x="0" y="0" class="section-header">Lexer Component</text>
            <text x="0" y="40" class="subtitle">Tokenization (pkg/language/lexer.go)</text>
            <text x="0" y="80" class="doc-text">Converts source code into tokens for parsing.</text>
        </g>

        <g id="data-parser-core" style="display:none;">
            <text x="0" y="0" class="section-header">Parser Core Component</text>
            <text x="0" y="40" class="subtitle">AST construction (pkg/language/parser.go)</text>
            <text x="0" y="80" class="doc-text">Builds AST from tokens using parser combinators.</text>
        </g>

        <g id="data-ast" style="display:none;">
            <text x="0" y="0" class="section-header">AST Component</text>
            <text x="0" y="40" class="subtitle">Abstract Syntax Tree (pkg/language/ast.go)</text>
            <text x="0" y="80" class="doc-text">Represents parsed architecture structure with source locations.</text>
        </g>

        <g id="data-validator" style="display:none;">
            <text x="0" y="0" class="section-header">Validator Component</text>
            <text x="0" y="40" class="subtitle">Validation orchestration (pkg/engine/validator.go)</text>
            <text x="0" y="80" class="doc-text">Orchestrates validation rules execution.</text>
        </g>

        <g id="data-d2-exporter" style="display:none;">
            <text x="0" y="0" class="section-header">D2 Exporter Component</text>
            <text x="0" y="40" class="subtitle">D2 format generation (pkg/export/d2/d2.go)</text>
            <text x="0" y="80" class="doc-text">Converts AST to D2 diagram format.</text>
        </g>

        <!-- Requirements Summary -->
        <g id="data-requirements" style="display:none;">
            <text x="0" y="0" class="section-header">All Requirements</text>
            <text x="0" y="40" class="subtitle">Functional, Constraint, and Performance Requirements</text>
            <text x="0" y="80" class="doc-text">R1 (Functional): Must parse C4 model elements (system, container, component, person, datastore)</text>
            <text x="0" y="110" class="doc-text">R2 (Functional): Must support requirements and ADRs in DSL</text>
            <text x="0" y="140" class="doc-text">R3 (Functional): Must provide source location for error reporting</text>
            <text x="0" y="170" class="doc-text">R4 (Constraint): Must be written in Go</text>
            <text x="0" y="200" class="doc-text">R5 (Performance): Must parse files &lt; 10MB within 1 second</text>
            <text x="0" y="230" class="doc-text">R6 (Functional): Must validate architecture rules (cycles, orphans, unique IDs)</text>
            <text x="0" y="260" class="doc-text">R7 (Functional): Must export to D2 format</text>
            <text x="0" y="290" class="doc-text">R8 (Functional): Must format .sruja files consistently</text>
        </g>

        <!-- ADRs Summary -->
        <g id="data-adrs" style="display:none;">
            <text x="0" y="0" class="section-header">All Architectural Decision Records</text>
            <text x="0" y="40" class="subtitle">Key architectural decisions made for Sruja</text>
            <text x="0" y="80" class="section-header">ADR 001: Rule-based Validation Architecture</text>
            <text x="0" y="120" class="doc-text">Status: Accepted</text>
            <text x="0" y="150" class="doc-text">Decision: Use a pluggable rule system to allow extensible validation without modifying core engine. This enables community contributions and custom validation rules.</text>
            <text x="0" y="200" class="section-header">ADR 002: D2 as Primary Export Format</text>
            <text x="0" y="240" class="doc-text">Status: Accepted</text>
            <text x="0" y="270" class="doc-text">Decision: D2 provides excellent diagram rendering and is actively maintained. Chosen over PlantUML for better modern tooling support and cleaner syntax.</text>
            <text x="0" y="320" class="section-header">ADR 003: Go as Implementation Language</text>
            <text x="0" y="360" class="doc-text">Status: Accepted</text>
            <text x="0" y="390" class="doc-text">Decision: Go chosen for its excellent tooling, fast compilation, single binary distribution, and strong standard library for text processing.</text>
        </g>

        <!-- Technology Choices Summary -->
        <g id="data-technologies" style="display:none;">
            <text x="0" y="0" class="section-header">Technology Stack</text>
            <text x="0" y="40" class="subtitle">Technologies used in Sruja implementation</text>
            <text x="0" y="80" class="section-header">Core Technologies</text>
            <text x="0" y="120" class="doc-list-item">- Go 1.25+: Primary implementation language</text>
            <text x="0" y="145" class="doc-list-item">- Cobra: CLI framework for command management</text>
            <text x="0" y="170" class="doc-list-item">- Custom Parser: Parser combinators for DSL parsing</text>
            <text x="0" y="195" class="section-header">Export Technologies</text>
            <text x="0" y="235" class="doc-list-item">- D2: Primary diagram export format</text>
            <text x="0" y="260" class="section-header">Documentation Technologies</text>
            <text x="0" y="300" class="doc-list-item">- Hugo: Static site generator for docs (learn/)</text>
            <text x="0" y="325" class="doc-list-item">- TypeScript/React: Interactive playground components</text>
        </g>
    </defs>

    <!--
    ================================================================================
    3. MAIN VIEW (The Architecture Diagram + Document Panel)
    ================================================================================
    -->

    <!-- Header with Title and Level Navigation -->
    <rect x="0" y="0" width="2400" height="100" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
    <text x="1200" y="40" class="title" text-anchor="middle">Sruja Architecture</text>
    <text x="1200" y="70" class="subtitle" text-anchor="middle">Interactive C4 Model with Requirements, ADRs &amp; Technology Choices</text>

    <!-- C4 Level Navigation Buttons -->
    <g id="levelButtons">
        <rect id="btnLevel1" x="50" y="120" width="180" height="40" class="button button-active" data-level="1"/>
        <text x="140" y="145" class="button-text button-text-active">Level 1: System Context</text>
        
        <rect id="btnLevel2" x="250" y="120" width="180" height="40" class="button" data-level="2"/>
        <text x="340" y="145" class="button-text">Level 2: Containers</text>
        
        <rect id="btnLevel3" x="450" y="120" width="180" height="40" class="button" data-level="3"/>
        <text x="540" y="145" class="button-text">Level 3: Components</text>
    </g>

    <!-- Filter Buttons -->
    <g id="filterButtons">
        <rect id="btnAll" x="700" y="120" width="100" height="30" class="filter-button filter-button-active" data-filter="all"/>
        <text x="750" y="138" class="filter-text filter-text-active">All</text>
        
        <rect id="btnRequirements" x="820" y="120" width="120" height="30" class="filter-button" data-filter="requirements"/>
        <text x="880" y="138" class="filter-text">Requirements</text>
        
        <rect id="btnADRs" x="960" y="120" width="80" height="30" class="filter-button" data-filter="adrs"/>
        <text x="1000" y="138" class="filter-text">ADRs</text>
        
        <rect id="btnTech" x="1060" y="120" width="100" height="30" class="filter-button" data-filter="tech"/>
        <text x="1110" y="138" class="filter-text">Technology</text>
    </g>

    <!-- Diagram Area (Left) -->
    <g id="diagramArea">
        <!-- Level 1: System Context -->
        <g id="level1" style="display:block;">
            <rect x="50" y="180" width="1100" height="1200" fill="#fcfcfc" stroke="#e0e0e0" stroke-width="2" rx="10" ry="10"/>
            
            <!-- Person: Developer -->
            <rect id="person-developer" x="100" y="600" width="150" height="120" class="person-box interactive" data-content-id="data-developer"/>
            <text x="175" y="650" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="18">Developer</text>
            <text x="175" y="675" text-anchor="middle" fill="#ffffff" font-size="14">[Person]</text>
            <text x="175" y="700" text-anchor="middle" fill="#ffffff" font-size="12">Click for Docs</text>

            <!-- System: Sruja -->
            <rect x="400" y="300" width="700" height="800" class="system-boundary" rx="15" ry="15"/>
            <text x="420" y="330" font-size="24" font-weight="bold">Sruja System</text>
            
            <rect id="system-sruja" x="450" y="400" width="600" height="200" class="system-box interactive" data-content-id="data-sruja-system"/>
            <text x="750" y="480" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="24">Sruja</text>
            <text x="750" y="510" text-anchor="middle" fill="#ffffff" font-size="18">Architecture-as-Code</text>
            <text x="750" y="540" text-anchor="middle" fill="#ffffff" font-size="16">Language Tool</text>
            <text x="750" y="570" text-anchor="middle" fill="#ffffff" font-size="14">Click for Docs</text>

            <!-- External: File System -->
            <rect id="external-filesystem" x="1200" y="600" width="150" height="120" class="external-box interactive" data-content-id="data-external-filesystem"/>
            <text x="1275" y="650" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="18">File System</text>
            <text x="1275" y="675" text-anchor="middle" fill="#ffffff" font-size="14">[External]</text>
            <text x="1275" y="700" text-anchor="middle" fill="#ffffff" font-size="12">Click for Docs</text>

            <!-- Relationships -->
            <line x1="250" y1="660" x2="450" y2="500" stroke="#7f8c8d" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="350" y="580" font-size="16" fill="#7f8c8d" text-anchor="middle">Uses</text>
            
            <line x1="1050" y1="500" x2="1200" y2="660" stroke="#7f8c8d" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="1125" y="580" font-size="16" fill="#7f8c8d" text-anchor="middle">Reads/Writes</text>
        </g>

        <!-- Level 2: Containers -->
        <g id="level2" style="display:none;">
            <rect x="50" y="180" width="1100" height="1200" fill="#fcfcfc" stroke="#e0e0e0" stroke-width="2" rx="10" ry="10"/>
            
            <rect x="400" y="300" width="700" height="1000" class="system-boundary" rx="15" ry="15"/>
            <text x="420" y="330" font-size="24" font-weight="bold">Sruja System</text>

            <!-- CLI Container -->
            <rect id="container-cli" x="450" y="400" width="280" height="180" class="container-box interactive" data-content-id="data-cli"/>
            <text x="590" y="460" text-anchor="middle" font-weight="bold" font-size="20">CLI</text>
            <text x="590" y="490" text-anchor="middle" font-size="16">[Container: CLI]</text>
            <text x="590" y="520" text-anchor="middle" font-size="14">cmd/sruja</text>
            <text x="590" y="550" text-anchor="middle" font-size="12">Click for Docs</text>

            <!-- Language Parser Container -->
            <rect id="container-parser" x="770" y="400" width="280" height="180" class="container-box interactive" data-content-id="data-language-parser"/>
            <text x="910" y="460" text-anchor="middle" font-weight="bold" font-size="20">Language Parser</text>
            <text x="910" y="490" text-anchor="middle" font-size="16">[Container: Library]</text>
            <text x="910" y="520" text-anchor="middle" font-size="14">pkg/language</text>
            <text x="910" y="550" text-anchor="middle" font-size="12">Click for Docs</text>

            <!-- Validation Engine Container -->
            <rect id="container-engine" x="450" y="620" width="280" height="180" class="container-box interactive" data-content-id="data-validation-engine"/>
            <text x="590" y="680" text-anchor="middle" font-weight="bold" font-size="20">Validation Engine</text>
            <text x="590" y="710" text-anchor="middle" font-size="16">[Container: Library]</text>
            <text x="590" y="740" text-anchor="middle" font-size="14">pkg/engine</text>
            <text x="590" y="770" text-anchor="middle" font-size="12">Click for Docs</text>

            <!-- Exporters Container -->
            <rect id="container-exporters" x="770" y="620" width="280" height="180" class="container-box interactive" data-content-id="data-exporters"/>
            <text x="910" y="680" text-anchor="middle" font-weight="bold" font-size="20">Exporters</text>
            <text x="910" y="710" text-anchor="middle" font-size="16">[Container: Library]</text>
            <text x="910" y="740" text-anchor="middle" font-size="14">pkg/export</text>
            <text x="910" y="770" text-anchor="middle" font-size="12">Click for Docs</text>

            <!-- DX Helpers Container -->
            <rect id="container-dx" x="610" y="840" width="280" height="180" class="container-box interactive" data-content-id="data-dx-helpers"/>
            <text x="750" y="900" text-anchor="middle" font-weight="bold" font-size="20">DX Helpers</text>
            <text x="750" y="930" text-anchor="middle" font-size="16">[Container: Library]</text>
            <text x="750" y="960" text-anchor="middle" font-size="14">pkg/dx</text>
            <text x="750" y="990" text-anchor="middle" font-size="12">Click for Docs</text>

            <!-- Relationships -->
            <line x1="590" y1="580" x2="910" y2="490" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="750" y="530" font-size="14" fill="#7f8c8d" text-anchor="middle">Parses</text>
            
            <line x1="590" y1="620" x2="590" y2="620" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="520" y="610" font-size="14" fill="#7f8c8d">Validates</text>
            
            <line x1="730" y1="680" x2="770" y2="710" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="750" y="690" font-size="14" fill="#7f8c8d" text-anchor="middle">Exports</text>
            
            <line x1="730" y1="800" x2="610" y2="840" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="670" y="820" font-size="14" fill="#7f8c8d">Uses</text>
        </g>

        <!-- Level 3: Components -->
        <g id="level3" style="display:none;">
            <rect x="50" y="180" width="1100" height="1200" fill="#fcfcfc" stroke="#e0e0e0" stroke-width="2" rx="10" ry="10"/>
            
            <rect x="400" y="300" width="700" height="1000" class="system-boundary" rx="15" ry="15"/>
            <text x="420" y="330" font-size="24" font-weight="bold">Sruja System</text>

            <!-- CLI Components -->
            <rect x="430" y="380" width="300" height="200" class="container-boundary" rx="10" ry="10"/>
            <text x="450" y="400" font-size="18" font-weight="bold">CLI Container</text>
            
            <rect id="component-cobra" x="450" y="420" width="260" height="140" class="component-box interactive" data-content-id="data-cobra-commands"/>
            <text x="580" y="480" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="16">Cobra Commands</text>
            <text x="580" y="510" text-anchor="middle" fill="#ffffff" font-size="12">[Component]</text>
            <text x="580" y="540" text-anchor="middle" fill="#ffffff" font-size="11">Click for Docs</text>

            <!-- Parser Components -->
            <rect x="750" y="380" width="300" height="200" class="container-boundary" rx="10" ry="10"/>
            <text x="770" y="400" font-size="18" font-weight="bold">Language Parser Container</text>
            
            <rect id="component-lexer" x="770" y="420" width="120" height="140" class="component-box interactive" data-content-id="data-lexer"/>
            <text x="830" y="480" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="14">Lexer</text>
            <text x="830" y="510" text-anchor="middle" fill="#ffffff" font-size="11">[Component]</text>
            
            <rect id="component-parser" x="910" y="420" width="120" height="140" class="component-box interactive" data-content-id="data-parser-core"/>
            <text x="970" y="480" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="14">Parser</text>
            <text x="970" y="510" text-anchor="middle" fill="#ffffff" font-size="11">[Component]</text>
            
            <rect id="component-ast" x="770" y="580" width="260" height="140" class="component-box interactive" data-content-id="data-ast"/>
            <text x="900" y="640" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="14">AST</text>
            <text x="900" y="670" text-anchor="middle" fill="#ffffff" font-size="11">[Component]</text>

            <!-- Engine Components -->
            <rect x="430" y="620" width="300" height="200" class="container-boundary" rx="10" ry="10"/>
            <text x="450" y="640" font-size="18" font-weight="bold">Validation Engine Container</text>
            
            <rect id="component-validator" x="450" y="660" width="260" height="140" class="component-box interactive" data-content-id="data-validator"/>
            <text x="580" y="720" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="16">Validator</text>
            <text x="580" y="750" text-anchor="middle" fill="#ffffff" font-size="12">[Component]</text>

            <!-- Export Components -->
            <rect x="750" y="620" width="300" height="200" class="container-boundary" rx="10" ry="10"/>
            <text x="770" y="640" font-size="18" font-weight="bold">Exporters Container</text>
            
            <rect id="component-d2" x="770" y="660" width="260" height="140" class="component-box interactive" data-content-id="data-d2-exporter"/>
            <text x="900" y="720" text-anchor="middle" font-weight="bold" fill="#ffffff" font-size="16">D2 Exporter</text>
            <text x="900" y="750" text-anchor="middle" fill="#ffffff" font-size="12">[Component]</text>
        </g>

        <!-- Arrowhead definition -->
        <marker id="arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="#7f8c8d" />
        </marker>
    </g>

    <!-- Documentation Panel (Right) -->
    <g id="docPanelContainer">
        <rect id="docPanel" x="1200" y="180" width="1150" height="1200" rx="8" ry="8"/>
        
        <!-- Quick Access Buttons -->
        <g id="quickAccess">
            <rect id="btnQuickReq" x="1250" y="200" width="140" height="35" class="filter-button" data-content-id="data-requirements"/>
            <text x="1320" y="220" class="filter-text" text-anchor="middle">All Requirements</text>
            
            <rect id="btnQuickADR" x="1410" y="200" width="120" height="35" class="filter-button" data-content-id="data-adrs"/>
            <text x="1470" y="220" class="filter-text" text-anchor="middle">All ADRs</text>
            
            <rect id="btnQuickTech" x="1550" y="200" width="140" height="35" class="filter-button" data-content-id="data-technologies"/>
            <text x="1620" y="220" class="filter-text" text-anchor="middle">Technology Stack</text>
        </g>

        <!-- Initial Placeholder Text -->
        <g id="initialText">
            <text x="1775" y="650" class="title" text-anchor="middle" fill="#bdc3c7">Click a component</text>
            <text x="1775" y="700" class="subtitle" text-anchor="middle">to view its documentation</text>
            <text x="1775" y="750" class="subtitle" text-anchor="middle">or use quick access buttons above</text>
        </g>

        <!-- Content Injection Area -->
        <g id="contentInjection" transform="translate(1250, 260)">
            <!-- Content will be injected here by JavaScript -->
        </g>
    </g>

    <!--
    ================================================================================
    4. EMBEDDED JAVASCRIPT LOGIC
    ================================================================================
    -->
    <script type="text/ecmascript">
    <![CDATA[
        // --- State Management ---
        let currentLevel = 1;
        let currentFilter = 'all';
        let selectedElement = null;

        // --- Content Loading ---
        function loadContent(dataId) {
            const sourceGroup = document.getElementById(dataId);
            const injectionArea = document.getElementById('contentInjection');
            const initialText = document.getElementById('initialText');
            
            if (!sourceGroup) {
                console.error("Content ID not found: " + dataId);
                return;
            }

            initialText.style.display = 'none';
            injectionArea.innerHTML = '';

            let yOffset = 0;
            const lineHeight = 30;

            Array.from(sourceGroup.children).forEach(child => {
                const clonedChild = child.cloneNode(true);
                clonedChild.setAttribute('y', yOffset);

                if (clonedChild.classList.contains('section-header')) {
                    yOffset += 50;
                } else if (clonedChild.classList.contains('doc-list-item')) {
                    yOffset += 28;
                } else {
                    yOffset += 35;
                }

                injectionArea.appendChild(clonedChild);
            });
        }

        // --- Level Switching ---
        function switchLevel(level) {
            currentLevel = level;
            
            // Hide all levels
            document.getElementById('level1').style.display = 'none';
            document.getElementById('level2').style.display = 'none';
            document.getElementById('level3').style.display = 'none';
            
            // Show selected level
            document.getElementById('level' + level).style.display = 'block';
            
            // Update button states
            document.querySelectorAll('[data-level]').forEach(btn => {
                const btnLevel = parseInt(btn.getAttribute('data-level'));
                if (btnLevel === level) {
                    btn.classList.add('button-active');
                    btn.querySelector('.button-text').classList.add('button-text-active');
                } else {
                    btn.classList.remove('button-active');
                    btn.querySelector('.button-text').classList.remove('button-text-active');
                }
            });
            
            // Clear selection
            clearSelection();
        }

        // --- Selection Management ---
        function selectElement(element) {
            clearSelection();
            selectedElement = element;
            element.classList.add('selected');
        }

        function clearSelection() {
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            selectedElement = null;
            document.querySelectorAll('.interactive').forEach(el => {
                el.classList.remove('selected');
            });
        }

        // --- Event Listeners ---
        function setupListeners() {
            // Level navigation buttons
            document.querySelectorAll('[data-level]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const level = parseInt(this.getAttribute('data-level'));
                    switchLevel(level);
                });
            });

            // Interactive diagram elements
            document.querySelectorAll('.interactive').forEach(element => {
                const dataId = element.getAttribute('data-content-id');
                if (dataId) {
                    element.addEventListener('click', function(e) {
                        e.stopPropagation();
                        loadContent(dataId);
                        selectElement(this);
                    });
                }
            });

            // Quick access buttons
            document.querySelectorAll('#quickAccess [data-content-id]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const dataId = this.getAttribute('data-content-id');
                    loadContent(dataId);
                    clearSelection();
                });
            });

            // Filter buttons (for future filtering functionality)
            document.querySelectorAll('[data-filter]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    currentFilter = filter;
                    
                    // Update button states
                    document.querySelectorAll('[data-filter]').forEach(b => {
                        if (b.getAttribute('data-filter') === filter) {
                            b.classList.add('filter-button-active');
                            b.querySelector('.filter-text').classList.add('filter-text-active');
                        } else {
                            b.classList.remove('filter-button-active');
                            b.querySelector('.filter-text').classList.remove('filter-text-active');
                        }
                    });
                });
            });

            // Click outside to deselect
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.interactive') && !e.target.closest('.button') && !e.target.closest('.filter-button')) {
                    clearSelection();
                }
            });
        }

        // --- Initialization ---
        function init() {
            setupListeners();
            switchLevel(1);
        }

        // Run initialization
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        // Fallback for SVG loaded as image/object
        if (typeof window !== 'undefined') {
            window.addEventListener('load', function() {
                if (document.getElementById('level1')) {
                    init();
                }
            });
        }
    ]]>
    </script>
</svg>

