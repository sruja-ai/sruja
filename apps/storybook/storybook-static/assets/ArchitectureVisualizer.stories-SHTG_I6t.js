import{r as ui,g as fi,R as Ke,a as j,j as f}from"./iframe-CLHqt8sP.js";import{s as de,d as $o,i as xn,T as Xt,a as Gt,t as hi}from"./transform-8mVIBRNT.js";import{i as qt}from"./value-Ci_hQPd5.js";import{r as pi}from"./index-AZTZg61A.js";import"./index-DRowAfMf.js";import{c as le}from"./createLucideIcon-Byd03hVy.js";import{X as Ho}from"./x-B9rRl5ji.js";import{E as mi}from"./elk.bundled-BsTYLubE.js";import{C as gi}from"./chevron-right-DPD-XivR.js";import"./preload-helper-PPVm8Dsz.js";import"./index-dLArjxyT.js";const yi=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],xi=le("box",yi);const wi=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],wn=le("building-2",wi);const vi=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],bi=le("chevron-down",vi);const Ei=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Si=le("chevron-up",Ei);const Ni=[["path",{d:"M15.536 11.293a1 1 0 0 0 0 1.414l2.376 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z",key:"1uwlt4"}],["path",{d:"M2.297 11.293a1 1 0 0 0 0 1.414l2.377 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414L6.088 8.916a1 1 0 0 0-1.414 0z",key:"10291m"}],["path",{d:"M8.916 17.912a1 1 0 0 0 0 1.415l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.415l-2.377-2.376a1 1 0 0 0-1.414 0z",key:"1tqoq1"}],["path",{d:"M8.916 4.674a1 1 0 0 0 0 1.414l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z",key:"1x6lto"}]],Ci=le("component",Ni);const Mi=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ki=le("database",Mi);const Ii=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Pi=le("info",Ii);const ji=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Ai=le("message-square",ji);const Di=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],_i=le("pause",Di);const Ti=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],an=le("play",Ti);const Li=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Ri=le("skip-back",Li);const zi=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],$i=le("skip-forward",zi);const Hi=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Fi=le("tag",Hi);const Oi=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],cn=le("user",Oi);function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Vi(e){let t;for(;t=e.sourceEvent;)e=t;return e}function fe(e,t){if(e=Vi(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const Bi={passive:!1},et={capture:!0,passive:!1};function Kt(e){e.stopImmediatePropagation()}function ze(e){e.preventDefault(),e.stopImmediatePropagation()}function Fo(e){var t=e.document.documentElement,n=de(e).on("dragstart.drag",ze,et);"onselectstart"in t?n.on("selectstart.drag",ze,et):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Oo(e,t){var n=e.document.documentElement,o=de(e).on("dragstart.drag",null);t&&(o.on("click.drag",ze,et),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ut=e=>()=>e;function ln(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:r,x:i,y:c,dx:h,dy:a,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:a,enumerable:!0,configurable:!0},_:{value:p}})}ln.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wi(e){return!e.ctrlKey&&!e.button}function Zi(){return this.parentNode}function Yi(e,t){return t??{x:e.x,y:e.y}}function Ui(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vo(){var e=Wi,t=Zi,n=Yi,o=Ui,s={},r=$o("start","drag","end"),i=0,c,h,a,p,d=0;function u(y){y.on("mousedown.drag",x).filter(o).on("touchstart.drag",v).on("touchmove.drag",m,Bi).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function x(y,C){if(!(p||!e.call(this,y,C))){var N=l(this,t.call(this,y,C),y,C,"mouse");N&&(de(y.view).on("mousemove.drag",g,et).on("mouseup.drag",w,et),Fo(y.view),Kt(y),a=!1,c=y.clientX,h=y.clientY,N("start",y))}}function g(y){if(ze(y),!a){var C=y.clientX-c,N=y.clientY-h;a=C*C+N*N>d}s.mouse("drag",y)}function w(y){de(y.view).on("mousemove.drag mouseup.drag",null),Oo(y.view,a),ze(y),s.mouse("end",y)}function v(y,C){if(e.call(this,y,C)){var N=y.changedTouches,S=t.call(this,y,C),k=N.length,D,F;for(D=0;D<k;++D)(F=l(this,S,y,C,N[D].identifier,N[D]))&&(Kt(y),F("start",y,N[D]))}}function m(y){var C=y.changedTouches,N=C.length,S,k;for(S=0;S<N;++S)(k=s[C[S].identifier])&&(ze(y),k("drag",y,C[S]))}function b(y){var C=y.changedTouches,N=C.length,S,k;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),S=0;S<N;++S)(k=s[C[S].identifier])&&(Kt(y),k("end",y,C[S]))}function l(y,C,N,S,k,D){var F=r.copy(),_=fe(D||N,C),L,z,E;if((E=n.call(y,new ln("beforestart",{sourceEvent:N,target:u,identifier:k,active:i,x:_[0],y:_[1],dx:0,dy:0,dispatch:F}),S))!=null)return L=E.x-_[0]||0,z=E.y-_[1]||0,function I(M,A,P){var T=_,R;switch(M){case"start":s[k]=I,R=i++;break;case"end":delete s[k],--i;case"drag":_=fe(P||A,C),R=i;break}F.call(M,y,new ln(M,{sourceEvent:A,subject:E,target:u,identifier:k,active:R,x:_[0]+L,y:_[1]+z,dx:_[0]-T[0],dy:_[1]-T[1],dispatch:F}),S)}}return u.filter=function(y){return arguments.length?(e=typeof y=="function"?y:ut(!!y),u):e},u.container=function(y){return arguments.length?(t=typeof y=="function"?y:ut(y),u):t},u.subject=function(y){return arguments.length?(n=typeof y=="function"?y:ut(y),u):n},u.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:ut(!!y),u):o},u.on=function(){var y=r.on.apply(r,arguments);return y===r?u:y},u.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,u):Math.sqrt(d)},u}var Xi=1e-12;function Zn(e){return((e=Math.exp(e))+1/e)/2}function Gi(e){return((e=Math.exp(e))-1/e)/2}function qi(e){return((e=Math.exp(2*e))-1)/(e+1)}const Dt=(function e(t,n,o){function s(r,i){var c=r[0],h=r[1],a=r[2],p=i[0],d=i[1],u=i[2],x=p-c,g=d-h,w=x*x+g*g,v,m;if(w<Xi)m=Math.log(u/a)/t,v=function(S){return[c+S*x,h+S*g,a*Math.exp(t*S*m)]};else{var b=Math.sqrt(w),l=(u*u-a*a+o*w)/(2*a*n*b),y=(u*u-a*a-o*w)/(2*u*n*b),C=Math.log(Math.sqrt(l*l+1)-l),N=Math.log(Math.sqrt(y*y+1)-y);m=(N-C)/t,v=function(S){var k=S*m,D=Zn(C),F=a/(n*b)*(D*qi(t*k+C)-Gi(C));return[c+F*x,h+F*g,a*D/Zn(t*k+C)]}}return v.duration=m*1e3*t/Math.SQRT2,v}return s.rho=function(r){var i=Math.max(.001,+r),c=i*i,h=c*c;return e(i,c,h)},s})(Math.SQRT2,2,4),ft=e=>()=>e;function Ki(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Qt(e){e.stopImmediatePropagation()}function qe(e){e.preventDefault(),e.stopImmediatePropagation()}function Qi(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ji(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Yn(){return this.__zoom||xn}function ea(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ta(){return navigator.maxTouchPoints||"ontouchstart"in this}function na(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i))}function Bo(){var e=Qi,t=Ji,n=na,o=ea,s=ta,r=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],c=250,h=Dt,a=$o("start","zoom","end"),p,d,u,x=500,g=150,w=0,v=10;function m(E){E.property("__zoom",Yn).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",F).filter(s).on("touchstart.zoom",_).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",z).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(E,I,M,A){var P=E.selection?E.selection():E;P.property("__zoom",Yn),E!==P?C(E,I,M,A):P.interrupt().each(function(){N(this,arguments).event(A).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},m.scaleBy=function(E,I,M,A){m.scaleTo(E,function(){var P=this.__zoom.k,T=typeof I=="function"?I.apply(this,arguments):I;return P*T},M,A)},m.scaleTo=function(E,I,M,A){m.transform(E,function(){var P=t.apply(this,arguments),T=this.__zoom,R=M==null?y(P):typeof M=="function"?M.apply(this,arguments):M,H=T.invert(R),$=typeof I=="function"?I.apply(this,arguments):I;return n(l(b(T,$),R,H),P,i)},M,A)},m.translateBy=function(E,I,M,A){m.transform(E,function(){return n(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof M=="function"?M.apply(this,arguments):M),t.apply(this,arguments),i)},null,A)},m.translateTo=function(E,I,M,A,P){m.transform(E,function(){var T=t.apply(this,arguments),R=this.__zoom,H=A==null?y(T):typeof A=="function"?A.apply(this,arguments):A;return n(xn.translate(H[0],H[1]).scale(R.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof M=="function"?-M.apply(this,arguments):-M),T,i)},A,P)};function b(E,I){return I=Math.max(r[0],Math.min(r[1],I)),I===E.k?E:new Xt(I,E.x,E.y)}function l(E,I,M){var A=I[0]-M[0]*E.k,P=I[1]-M[1]*E.k;return A===E.x&&P===E.y?E:new Xt(E.k,A,P)}function y(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function C(E,I,M,A){E.on("start.zoom",function(){N(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(A).end()}).tween("zoom",function(){var P=this,T=arguments,R=N(P,T).event(A),H=t.apply(P,T),$=M==null?y(H):typeof M=="function"?M.apply(P,T):M,W=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),V=P.__zoom,U=typeof I=="function"?I.apply(P,T):I,q=h(V.invert($).concat(W/V.k),U.invert($).concat(W/U.k));return function(Y){if(Y===1)Y=U;else{var O=q(Y),Z=W/O[2];Y=new Xt(Z,$[0]-O[0]*Z,$[1]-O[1]*Z)}R.zoom(null,Y)}})}function N(E,I,M){return!M&&E.__zooming||new S(E,I)}function S(E,I){this.that=E,this.args=I,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,I),this.taps=0}S.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,I){return this.mouse&&E!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var I=de(this.that).datum();a.call(E,this.that,new Ki(E,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:a}),I)}};function k(E,...I){if(!e.apply(this,arguments))return;var M=N(this,I).event(E),A=this.__zoom,P=Math.max(r[0],Math.min(r[1],A.k*Math.pow(2,o.apply(this,arguments)))),T=fe(E);if(M.wheel)(M.mouse[0][0]!==T[0]||M.mouse[0][1]!==T[1])&&(M.mouse[1]=A.invert(M.mouse[0]=T)),clearTimeout(M.wheel);else{if(A.k===P)return;M.mouse=[T,A.invert(T)],Gt(this),M.start()}qe(E),M.wheel=setTimeout(R,g),M.zoom("mouse",n(l(b(A,P),M.mouse[0],M.mouse[1]),M.extent,i));function R(){M.wheel=null,M.end()}}function D(E,...I){if(u||!e.apply(this,arguments))return;var M=E.currentTarget,A=N(this,I,!0).event(E),P=de(E.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",W,!0),T=fe(E,M),R=E.clientX,H=E.clientY;Fo(E.view),Qt(E),A.mouse=[T,this.__zoom.invert(T)],Gt(this),A.start();function $(V){if(qe(V),!A.moved){var U=V.clientX-R,q=V.clientY-H;A.moved=U*U+q*q>w}A.event(V).zoom("mouse",n(l(A.that.__zoom,A.mouse[0]=fe(V,M),A.mouse[1]),A.extent,i))}function W(V){P.on("mousemove.zoom mouseup.zoom",null),Oo(V.view,A.moved),qe(V),A.event(V).end()}}function F(E,...I){if(e.apply(this,arguments)){var M=this.__zoom,A=fe(E.changedTouches?E.changedTouches[0]:E,this),P=M.invert(A),T=M.k*(E.shiftKey?.5:2),R=n(l(b(M,T),A,P),t.apply(this,I),i);qe(E),c>0?de(this).transition().duration(c).call(C,R,A,E):de(this).call(m.transform,R,A,E)}}function _(E,...I){if(e.apply(this,arguments)){var M=E.touches,A=M.length,P=N(this,I,E.changedTouches.length===A).event(E),T,R,H,$;for(Qt(E),R=0;R<A;++R)H=M[R],$=fe(H,this),$=[$,this.__zoom.invert($),H.identifier],P.touch0?!P.touch1&&P.touch0[2]!==$[2]&&(P.touch1=$,P.taps=0):(P.touch0=$,T=!0,P.taps=1+!!p);p&&(p=clearTimeout(p)),T&&(P.taps<2&&(d=$[0],p=setTimeout(function(){p=null},x)),Gt(this),P.start())}}function L(E,...I){if(this.__zooming){var M=N(this,I).event(E),A=E.changedTouches,P=A.length,T,R,H,$;for(qe(E),T=0;T<P;++T)R=A[T],H=fe(R,this),M.touch0&&M.touch0[2]===R.identifier?M.touch0[0]=H:M.touch1&&M.touch1[2]===R.identifier&&(M.touch1[0]=H);if(R=M.that.__zoom,M.touch1){var W=M.touch0[0],V=M.touch0[1],U=M.touch1[0],q=M.touch1[1],Y=(Y=U[0]-W[0])*Y+(Y=U[1]-W[1])*Y,O=(O=q[0]-V[0])*O+(O=q[1]-V[1])*O;R=b(R,Math.sqrt(Y/O)),H=[(W[0]+U[0])/2,(W[1]+U[1])/2],$=[(V[0]+q[0])/2,(V[1]+q[1])/2]}else if(M.touch0)H=M.touch0[0],$=M.touch0[1];else return;M.zoom("touch",n(l(R,H,$),M.extent,i))}}function z(E,...I){if(this.__zooming){var M=N(this,I).event(E),A=E.changedTouches,P=A.length,T,R;for(Qt(E),u&&clearTimeout(u),u=setTimeout(function(){u=null},x),T=0;T<P;++T)R=A[T],M.touch0&&M.touch0[2]===R.identifier?delete M.touch0:M.touch1&&M.touch1[2]===R.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(R=fe(R,this),Math.hypot(d[0]-R[0],d[1]-R[1])<v)){var H=de(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return m.wheelDelta=function(E){return arguments.length?(o=typeof E=="function"?E:ft(+E),m):o},m.filter=function(E){return arguments.length?(e=typeof E=="function"?E:ft(!!E),m):e},m.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:ft(!!E),m):s},m.extent=function(E){return arguments.length?(t=typeof E=="function"?E:ft([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),m):t},m.scaleExtent=function(E){return arguments.length?(r[0]=+E[0],r[1]=+E[1],m):[r[0],r[1]]},m.translateExtent=function(E){return arguments.length?(i[0][0]=+E[0][0],i[1][0]=+E[1][0],i[0][1]=+E[0][1],i[1][1]=+E[1][1],m):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},m.constrain=function(E){return arguments.length?(n=E,m):n},m.duration=function(E){return arguments.length?(c=+E,m):c},m.interpolate=function(E){return arguments.length?(h=E,m):h},m.on=function(){var E=a.on.apply(a,arguments);return E===a?m:E},m.clickDistance=function(E){return arguments.length?(w=(E=+E)*E,m):Math.sqrt(w)},m.tapDistance=function(E){return arguments.length?(v=+E,m):v},m}const ge={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},tt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Wo=["Enter"," ","Escape"],Zo={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var He;(function(e){e.Strict="strict",e.Loose="loose"})(He||(He={}));var je;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(je||(je={}));var nt;(function(e){e.Partial="partial",e.Full="full"})(nt||(nt={}));const Yo={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Fe;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Fe||(Fe={}));var B;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(B||(B={}));const Un={[B.Left]:B.Right,[B.Right]:B.Left,[B.Top]:B.Bottom,[B.Bottom]:B.Top};function Uo(e){return e===null?null:e?"valid":"invalid"}const Xo=e=>"id"in e&&"source"in e&&"target"in e,oa=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),vn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),it=(e,t=[0,0])=>{const{width:n,height:o}=ve(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},sa=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):vn(s)?s:t.nodeLookup.get(s.id));const c=i?_t(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Rt(o,c)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return zt(n)},at=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(s=>{(t.filter===void 0||t.filter(s))&&(n=Rt(n,_t(s)),o=!0)}),o?zt(n):{x:0,y:0,width:0,height:0}},bn=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const c={...lt(t,[n,o,s]),width:t.width/s,height:t.height/s},h=[];for(const a of e.values()){const{measured:p,selectable:d=!0,hidden:u=!1}=a;if(i&&!d||u)continue;const x=p.width??a.width??a.initialWidth??null,g=p.height??a.height??a.initialHeight??null,w=ot(c,Ve(a)),v=(x??0)*(g??0),m=r&&w>0;(!a.internals.handleBounds||m||w>=v||a.dragging)&&h.push(a)}return h},ra=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function ia(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&(t?.includeHiddenNodes||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function aa({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const c=ia(e,i),h=at(c),a=En(h,t,n,i?.minZoom??s,i?.maxZoom??r,i?.padding??.1);return await o.setViewport(a,{duration:i?.duration,ease:i?.ease,interpolate:i?.interpolate}),Promise.resolve(!0)}function Go({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),c=i.parentId?n.get(i.parentId):void 0,{x:h,y:a}=c?c.internals.positionAbsolute:{x:0,y:0},p=i.origin??o;let d=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!c)r?.("005",ge.error005());else{const x=c.measured.width,g=c.measured.height;x&&g&&(d=[[h,a],[h+x,a+g]])}else c&&Be(i.extent)&&(d=[[i.extent[0][0]+h,i.extent[0][1]+a],[i.extent[1][0]+h,i.extent[1][1]+a]]);const u=Be(d)?Ae(t,d,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&r?.("015",ge.error015()),{position:{x:u.x-h+(i.measured.width??0)*p[0],y:u.y-a+(i.measured.height??0)*p[1]},positionAbsolute:u}}async function ca({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const x=r.has(u.id),g=!x&&u.parentId&&i.find(w=>w.id===u.parentId);(x||g)&&i.push(u)}const c=new Set(t.map(u=>u.id)),h=o.filter(u=>u.deletable!==!1),p=ra(i,h);for(const u of h)c.has(u.id)&&!p.find(g=>g.id===u.id)&&p.push(u);if(!s)return{edges:p,nodes:i};const d=await s({nodes:i,edges:p});return typeof d=="boolean"?d?{edges:p,nodes:i}:{edges:[],nodes:[]}:d}const Oe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ae=(e={x:0,y:0},t,n)=>({x:Oe(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Oe(e.y,t[0][1],t[1][1]-(n?.height??0))});function qo(e,t,n){const{width:o,height:s}=ve(n),{x:r,y:i}=n.internals.positionAbsolute;return Ae(e,[[r,i],[r+o,i+s]],t)}const Xn=(e,t,n)=>e<t?Oe(Math.abs(e-t),1,t)/t:e>n?-Oe(Math.abs(e-n),1,t)/t:0,Ko=(e,t,n=15,o=40)=>{const s=Xn(e.x,o,t.width-o)*n,r=Xn(e.y,o,t.height-o)*n;return[s,r]},Rt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),dn=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),zt=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ve=(e,t=[0,0])=>{const{x:n,y:o}=vn(e)?e.internals.positionAbsolute:it(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},_t=(e,t=[0,0])=>{const{x:n,y:o}=vn(e)?e.internals.positionAbsolute:it(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},Qo=(e,t)=>zt(Rt(dn(e),dn(t))),ot=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Gn=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),la=(e,t)=>{},ct=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),lt=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const c={x:(e-n)/s,y:(t-o)/s};return r?ct(c,i):c},Tt=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function Te(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function da(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Te(e,n),s=Te(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=Te(e.top??e.y??0,n),s=Te(e.bottom??e.y??0,n),r=Te(e.left??e.x??0,t),i=Te(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ua(e,t,n,o,s,r){const{x:i,y:c}=Tt(e,[t,n,o]),{x:h,y:a}=Tt({x:e.x+e.width,y:e.y+e.height},[t,n,o]),p=s-h,d=r-a;return{left:Math.floor(i),top:Math.floor(c),right:Math.floor(p),bottom:Math.floor(d)}}const En=(e,t,n,o,s,r)=>{const i=da(r,t,n),c=(t-i.x)/e.width,h=(n-i.y)/e.height,a=Math.min(c,h),p=Oe(a,o,s),d=e.x+e.width/2,u=e.y+e.height/2,x=t/2-d*p,g=n/2-u*p,w=ua(e,x,g,p,t,n),v={left:Math.min(w.left-i.left,0),top:Math.min(w.top-i.top,0),right:Math.min(w.right-i.right,0),bottom:Math.min(w.bottom-i.bottom,0)};return{x:x-v.left+v.right,y:g-v.top+v.bottom,zoom:p}},st=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Be(e){return e!=null&&e!=="parent"}function ve(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Jo(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function es(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const c=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*c[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*c[1]}return r}function qn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function fa(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function ha(e){return{...Zo,...e||{}}}function Qe(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=pe(e),c=lt({x:r-(s?.left??0),y:i-(s?.top??0)},o),{x:h,y:a}=n?ct(c,t):c;return{xSnapped:h,ySnapped:a,...c}}const Sn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ts=e=>e?.getRootNode?.()||window?.document,pa=["INPUT","SELECT","TEXTAREA"];function ns(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:pa.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const os=e=>"clientX"in e,pe=(e,t)=>{const n=os(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},Kn=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const c=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(c.left-n.left)/o,y:(c.top-n.top)/o,...Sn(i)}})};function ss({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:c}){const h=e*.125+s*.375+i*.375+n*.125,a=t*.125+r*.375+c*.375+o*.125,p=Math.abs(h-e),d=Math.abs(a-t);return[h,a,p,d]}function ht(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case B.Left:return[t-ht(t-o,r),n];case B.Right:return[t+ht(o-t,r),n];case B.Top:return[t,n-ht(n-s,r)];case B.Bottom:return[t,n+ht(s-n,r)]}}function rs({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:r=B.Top,curvature:i=.25}){const[c,h]=Qn({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[a,p]=Qn({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[d,u,x,g]=ss({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:h,targetControlX:a,targetControlY:p});return[`M${e},${t} C${c},${h} ${a},${p} ${o},${s}`,d,u,x,g]}function is({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,c=o<t?o+i:o-i;return[r,c,s,i]}function ma({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:s=!1,zIndexMode:r="basic"}){if(r==="manual")return o;const i=s&&n?o+1e3:o,c=Math.max(e.parentId||s&&e.selected?e.internals.z:0,t.parentId||s&&t.selected?t.internals.z:0);return i+c}function ga({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=Rt(_t(e),_t(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return ot(i,zt(r))>0}const ya=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,xa=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),wa=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||ya;let s;return Xo(e)?s={...e}:s={...e,id:o(e)},xa(s,t)?t:(s.sourceHandle===null&&delete s.sourceHandle,s.targetHandle===null&&delete s.targetHandle,t.concat(s))};function as({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,c]=is({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,c]}const Jn={[B.Left]:{x:-1,y:0},[B.Right]:{x:1,y:0},[B.Top]:{x:0,y:-1},[B.Bottom]:{x:0,y:1}},va=({source:e,sourcePosition:t=B.Bottom,target:n})=>t===B.Left||t===B.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},eo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ba({source:e,sourcePosition:t=B.Bottom,target:n,targetPosition:o=B.Top,center:s,offset:r,stepPosition:i}){const c=Jn[t],h=Jn[o],a={x:e.x+c.x*r,y:e.y+c.y*r},p={x:n.x+h.x*r,y:n.y+h.y*r},d=va({source:a,sourcePosition:t,target:p}),u=d.x!==0?"x":"y",x=d[u];let g=[],w,v;const m={x:0,y:0},b={x:0,y:0},[,,l,y]=is({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(c[u]*h[u]===-1){u==="x"?(w=s.x??a.x+(p.x-a.x)*i,v=s.y??(a.y+p.y)/2):(w=s.x??(a.x+p.x)/2,v=s.y??a.y+(p.y-a.y)*i);const N=[{x:w,y:a.y},{x:w,y:p.y}],S=[{x:a.x,y:v},{x:p.x,y:v}];c[u]===x?g=u==="x"?N:S:g=u==="x"?S:N}else{const N=[{x:a.x,y:p.y}],S=[{x:p.x,y:a.y}];if(u==="x"?g=c.x===x?S:N:g=c.y===x?N:S,t===o){const L=Math.abs(e[u]-n[u]);if(L<=r){const z=Math.min(r-1,r-L);c[u]===x?m[u]=(a[u]>e[u]?-1:1)*z:b[u]=(p[u]>n[u]?-1:1)*z}}if(t!==o){const L=u==="x"?"y":"x",z=c[u]===h[L],E=a[L]>p[L],I=a[L]<p[L];(c[u]===1&&(!z&&E||z&&I)||c[u]!==1&&(!z&&I||z&&E))&&(g=u==="x"?N:S)}const k={x:a.x+m.x,y:a.y+m.y},D={x:p.x+b.x,y:p.y+b.y},F=Math.max(Math.abs(k.x-g[0].x),Math.abs(D.x-g[0].x)),_=Math.max(Math.abs(k.y-g[0].y),Math.abs(D.y-g[0].y));F>=_?(w=(k.x+D.x)/2,v=g[0].y):(w=g[0].x,v=(k.y+D.y)/2)}return[[e,{x:a.x+m.x,y:a.y+m.y},...g,{x:p.x+b.x,y:p.y+b.y},n],w,v,l,y]}function Ea(e,t,n,o){const s=Math.min(eo(e,t)/2,eo(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const a=e.x<n.x?-1:1,p=e.y<n.y?1:-1;return`L ${r+s*a},${i}Q ${r},${i} ${r},${i+s*p}`}const c=e.x<n.x?1:-1,h=e.y<n.y?-1:1;return`L ${r},${i+s*h}Q ${r},${i} ${r+s*c},${i}`}function un({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:r=B.Top,borderRadius:i=5,centerX:c,centerY:h,offset:a=20,stepPosition:p=.5}){const[d,u,x,g,w]=ba({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:c,y:h},offset:a,stepPosition:p});return[d.reduce((m,b,l)=>{let y="";return l>0&&l<d.length-1?y=Ea(d[l-1],b,d[l+1],i):y=`${l===0?"M":"L"}${b.x} ${b.y}`,m+=y,m},""),u,x,g,w]}function to(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Sa(e){const{sourceNode:t,targetNode:n}=e;if(!to(t)||!to(n))return null;const o=t.internals.handleBounds||no(t.handles),s=n.internals.handleBounds||no(n.handles),r=oo(o?.source??[],e.sourceHandle),i=oo(e.connectionMode===He.Strict?s?.target??[]:(s?.target??[]).concat(s?.source??[]),e.targetHandle);if(!r||!i)return e.onError?.("008",ge.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=r?.position||B.Bottom,h=i?.position||B.Top,a=De(t,r,c),p=De(n,i,h);return{sourceX:a.x,sourceY:a.y,targetX:p.x,targetY:p.y,sourcePosition:c,targetPosition:h}}function no(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function De(e,t,n=B.Left,o=!1){const s=(t?.x??0)+e.internals.positionAbsolute.x,r=(t?.y??0)+e.internals.positionAbsolute.y,{width:i,height:c}=t??ve(e);if(o)return{x:s+i/2,y:r+c/2};switch(t?.position??n){case B.Top:return{x:s+i/2,y:r};case B.Right:return{x:s+i,y:r+c/2};case B.Bottom:return{x:s+i/2,y:r+c};case B.Left:return{x:s,y:r+c/2}}}function oo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function fn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Na(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,c)=>([c.markerStart||o,c.markerEnd||s].forEach(h=>{if(h&&typeof h=="object"){const a=fn(h,t);r.has(a)||(i.push({id:a,color:h.color||n,...h}),r.add(a))}}),i),[]).sort((i,c)=>i.id.localeCompare(c.id))}const cs=1e3,Ca=10,Nn={nodeOrigin:[0,0],nodeExtent:tt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},Ma={...Nn,checkEquality:!0};function Cn(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function ka(e,t,n){const o=Cn(Nn,n);for(const s of e.values())if(s.parentId)kn(s,e,t,o);else{const r=it(s,o.nodeOrigin),i=Be(s.extent)?s.extent:o.nodeExtent,c=Ae(r,i,ve(s));s.internals.positionAbsolute=c}}function Ia(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const s of e.handles){const r={id:s.id,width:s.width??1,height:s.height??1,nodeId:e.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?n.push(r):s.type==="target"&&o.push(r)}return{source:n,target:o}}function Mn(e){return e==="manual"}function hn(e,t,n,o={}){const s=Cn(Ma,o),r={i:0},i=new Map(t),c=s?.elevateNodesOnSelect&&!Mn(s.zIndexMode)?cs:0;let h=e.length>0;t.clear(),n.clear();for(const a of e){let p=i.get(a.id);if(s.checkEquality&&a===p?.internals.userNode)t.set(a.id,p);else{const d=it(a,s.nodeOrigin),u=Be(a.extent)?a.extent:s.nodeExtent,x=Ae(d,u,ve(a));p={...s.defaults,...a,measured:{width:a.measured?.width,height:a.measured?.height},internals:{positionAbsolute:x,handleBounds:Ia(a,p),z:ls(a,c,s.zIndexMode),userNode:a}},t.set(a.id,p)}(p.measured===void 0||p.measured.width===void 0||p.measured.height===void 0)&&!p.hidden&&(h=!1),a.parentId&&kn(p,t,n,o,r)}return h}function Pa(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function kn(e,t,n,o,s){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:c,zIndexMode:h}=Cn(Nn,o),a=e.parentId,p=t.get(a);if(!p){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Pa(e,n),s&&!p.parentId&&p.internals.rootParentIndex===void 0&&h==="auto"&&(p.internals.rootParentIndex=++s.i,p.internals.z=p.internals.z+s.i*Ca),s&&p.internals.rootParentIndex!==void 0&&(s.i=p.internals.rootParentIndex);const d=r&&!Mn(h)?cs:0,{x:u,y:x,z:g}=ja(e,p,i,c,d,h),{positionAbsolute:w}=e.internals,v=u!==w.x||x!==w.y;(v||g!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:v?{x:u,y:x}:w,z:g}})}function ls(e,t,n){const o=he(e.zIndex)?e.zIndex:0;return Mn(n)?o:o+(e.selected?t:0)}function ja(e,t,n,o,s,r){const{x:i,y:c}=t.internals.positionAbsolute,h=ve(e),a=it(e,n),p=Be(e.extent)?Ae(a,e.extent,h):a;let d=Ae({x:i+p.x,y:c+p.y},o,h);e.extent==="parent"&&(d=qo(d,h,t));const u=ls(e,s,r),x=t.internals.z??0;return{x:d.x,y:d.y,z:x>=u?x+1:u}}function In(e,t,n,o=[0,0]){const s=[],r=new Map;for(const i of e){const c=t.get(i.parentId);if(!c)continue;const h=r.get(i.parentId)?.expandedRect??Ve(c),a=Qo(h,i.rect);r.set(i.parentId,{expandedRect:a,parent:c})}return r.size>0&&r.forEach(({expandedRect:i,parent:c},h)=>{const a=c.internals.positionAbsolute,p=ve(c),d=c.origin??o,u=i.x<a.x?Math.round(Math.abs(a.x-i.x)):0,x=i.y<a.y?Math.round(Math.abs(a.y-i.y)):0,g=Math.max(p.width,Math.round(i.width)),w=Math.max(p.height,Math.round(i.height)),v=(g-p.width)*d[0],m=(w-p.height)*d[1];(u>0||x>0||v||m)&&(s.push({id:h,type:"position",position:{x:c.position.x-u+v,y:c.position.y-x+m}}),n.get(h)?.forEach(b=>{e.some(l=>l.id===b.id)||s.push({id:b.id,type:"position",position:{x:b.position.x+u,y:b.position.y+x}})})),(p.width<i.width||p.height<i.height||u||x)&&s.push({id:h,type:"dimensions",setAttributes:!0,dimensions:{width:g+(u?d[0]*u-v:0),height:w+(x?d[1]*x-m:0)}})}),s}function Aa(e,t,n,o,s,r,i){const c=o?.querySelector(".xyflow__viewport");let h=!1;if(!c)return{changes:[],updatedInternals:h};const a=[],p=window.getComputedStyle(c),{m22:d}=new window.DOMMatrixReadOnly(p.transform),u=[];for(const x of e.values()){const g=t.get(x.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),h=!0;continue}const w=Sn(x.nodeElement),v=g.measured.width!==w.width||g.measured.height!==w.height;if(!!(w.width&&w.height&&(v||!g.internals.handleBounds||x.force))){const b=x.nodeElement.getBoundingClientRect(),l=Be(g.extent)?g.extent:r;let{positionAbsolute:y}=g.internals;g.parentId&&g.extent==="parent"?y=qo(y,w,t.get(g.parentId)):l&&(y=Ae(y,l,w));const C={...g,measured:w,internals:{...g.internals,positionAbsolute:y,handleBounds:{source:Kn("source",x.nodeElement,b,d,g.id),target:Kn("target",x.nodeElement,b,d,g.id)}}};t.set(g.id,C),g.parentId&&kn(C,t,n,{nodeOrigin:s,zIndexMode:i}),h=!0,v&&(a.push({id:g.id,type:"dimensions",dimensions:w}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:Ve(C,s)}))}}if(u.length>0){const x=In(u,t,n,s);a.push(...x)}return{changes:a,updatedInternals:h}}async function Da({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),c=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(c)}function so(e,t,n,o,s,r){let i=s;const c=o.get(i)||new Map;o.set(i,c.set(n,t)),i=`${s}-${e}`;const h=o.get(i)||new Map;if(o.set(i,h.set(n,t)),r){i=`${s}-${e}-${r}`;const a=o.get(i)||new Map;o.set(i,a.set(n,t))}}function ds(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:c=null}=o,h={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:c},a=`${s}-${i}--${r}-${c}`,p=`${r}-${c}--${s}-${i}`;so("source",h,p,e,s,i),so("target",h,a,e,r,c),t.set(o.id,o)}}function us(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:us(n,t):!1}function ro(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function _a(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!us(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const c=e.get(r);c&&s.set(r,{id:r,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return s}function Jt({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const s=[];for(const[i,c]of t){const h=n.get(i)?.internals.userNode;h&&s.push({...h,position:c.position,dragging:o})}if(!e)return[s[0],s];const r=n.get(e)?.internals.userNode;return[r?{...r,position:t.get(e)?.position||r.position,dragging:o}:s[0],s]}function Ta({dragItems:e,snapGrid:t,x:n,y:o}){const s=e.values().next().value;if(!s)return null;const r={x:n-s.distance.x,y:o-s.distance.y},i=ct(r,t);return{x:i.x-r.x,y:i.y-r.y}}function La({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,c=new Map,h=!1,a={x:0,y:0},p=null,d=!1,u=null,x=!1,g=!1,w=null;function v({noDragClassName:b,handleSelector:l,domNode:y,isSelectable:C,nodeId:N,nodeClickDistance:S=0}){u=de(y);function k({x:L,y:z}){const{nodeLookup:E,nodeExtent:I,snapGrid:M,snapToGrid:A,nodeOrigin:P,onNodeDrag:T,onSelectionDrag:R,onError:H,updateNodePositions:$}=t();r={x:L,y:z};let W=!1;const V=c.size>1,U=V&&I?dn(at(c)):null,q=V&&A?Ta({dragItems:c,snapGrid:M,x:L,y:z}):null;for(const[Y,O]of c){if(!E.has(Y))continue;let Z={x:L-O.distance.x,y:z-O.distance.y};A&&(Z=q?{x:Math.round(Z.x+q.x),y:Math.round(Z.y+q.y)}:ct(Z,M));let Q=null;if(V&&I&&!O.extent&&U){const{positionAbsolute:G}=O.internals,ee=G.x-U.x+I[0][0],ne=G.x+O.measured.width-U.x2+I[1][0],te=G.y-U.y+I[0][1],ie=G.y+O.measured.height-U.y2+I[1][1];Q=[[ee,te],[ne,ie]]}const{position:K,positionAbsolute:X}=Go({nodeId:Y,nextPosition:Z,nodeLookup:E,nodeExtent:Q||I,nodeOrigin:P,onError:H});W=W||O.position.x!==K.x||O.position.y!==K.y,O.position=K,O.internals.positionAbsolute=X}if(g=g||W,!!W&&($(c,!0),w&&(o||T||!N&&R))){const[Y,O]=Jt({nodeId:N,dragItems:c,nodeLookup:E});o?.(w,c,Y,O),T?.(w,Y,O),N||R?.(w,O)}}async function D(){if(!p)return;const{transform:L,panBy:z,autoPanSpeed:E,autoPanOnNodeDrag:I}=t();if(!I){h=!1,cancelAnimationFrame(i);return}const[M,A]=Ko(a,p,E);(M!==0||A!==0)&&(r.x=(r.x??0)-M/L[2],r.y=(r.y??0)-A/L[2],await z({x:M,y:A})&&k(r)),i=requestAnimationFrame(D)}function F(L){const{nodeLookup:z,multiSelectionActive:E,nodesDraggable:I,transform:M,snapGrid:A,snapToGrid:P,selectNodesOnDrag:T,onNodeDragStart:R,onSelectionDragStart:H,unselectNodesAndEdges:$}=t();d=!0,(!T||!C)&&!E&&N&&(z.get(N)?.selected||$()),C&&T&&N&&e?.(N);const W=Qe(L.sourceEvent,{transform:M,snapGrid:A,snapToGrid:P,containerBounds:p});if(r=W,c=_a(z,I,W,N),c.size>0&&(n||R||!N&&H)){const[V,U]=Jt({nodeId:N,dragItems:c,nodeLookup:z});n?.(L.sourceEvent,c,V,U),R?.(L.sourceEvent,V,U),N||H?.(L.sourceEvent,U)}}const _=Vo().clickDistance(S).on("start",L=>{const{domNode:z,nodeDragThreshold:E,transform:I,snapGrid:M,snapToGrid:A}=t();p=z?.getBoundingClientRect()||null,x=!1,g=!1,w=L.sourceEvent,E===0&&F(L),r=Qe(L.sourceEvent,{transform:I,snapGrid:M,snapToGrid:A,containerBounds:p}),a=pe(L.sourceEvent,p)}).on("drag",L=>{const{autoPanOnNodeDrag:z,transform:E,snapGrid:I,snapToGrid:M,nodeDragThreshold:A,nodeLookup:P}=t(),T=Qe(L.sourceEvent,{transform:E,snapGrid:I,snapToGrid:M,containerBounds:p});if(w=L.sourceEvent,(L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1||N&&!P.has(N))&&(x=!0),!x){if(!h&&z&&d&&(h=!0,D()),!d){const R=pe(L.sourceEvent,p),H=R.x-a.x,$=R.y-a.y;Math.sqrt(H*H+$*$)>A&&F(L)}(r.x!==T.xSnapped||r.y!==T.ySnapped)&&c&&d&&(a=pe(L.sourceEvent,p),k(T))}}).on("end",L=>{if(!(!d||x)&&(h=!1,d=!1,cancelAnimationFrame(i),c.size>0)){const{nodeLookup:z,updateNodePositions:E,onNodeDragStop:I,onSelectionDragStop:M}=t();if(g&&(E(c,!1),g=!1),s||I||!N&&M){const[A,P]=Jt({nodeId:N,dragItems:c,nodeLookup:z,dragging:!1});s?.(L.sourceEvent,c,A,P),I?.(L.sourceEvent,A,P),N||M?.(L.sourceEvent,P)}}}).filter(L=>{const z=L.target;return!L.button&&(!b||!ro(z,`.${b}`,y))&&(!l||ro(z,l,y))});u.call(_)}function m(){u?.on(".drag",null)}return{update:v,destroy:m}}function Ra(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())ot(s,Ve(r))>0&&o.push(r);return o}const za=250;function $a(e,t,n,o){let s=[],r=1/0;const i=Ra(e,n,t+za);for(const c of i){const h=[...c.internals.handleBounds?.source??[],...c.internals.handleBounds?.target??[]];for(const a of h){if(o.nodeId===a.nodeId&&o.type===a.type&&o.id===a.id)continue;const{x:p,y:d}=De(c,a,a.position,!0),u=Math.sqrt(Math.pow(p-e.x,2)+Math.pow(d-e.y,2));u>t||(u<r?(s=[{...a,x:p,y:d}],r=u):u===r&&s.push({...a,x:p,y:d}))}}if(!s.length)return null;if(s.length>1){const c=o.type==="source"?"target":"source";return s.find(h=>h.type===c)??s[0]}return s[0]}function fs(e,t,n,o,s,r=!1){const i=o.get(e);if(!i)return null;const c=s==="strict"?i.internals.handleBounds?.[t]:[...i.internals.handleBounds?.source??[],...i.internals.handleBounds?.target??[]],h=(n?c?.find(a=>a.id===n):c?.[0])??null;return h&&r?{...h,...De(i,h,h.position,!0)}:h}function hs(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ha(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ps=()=>!0;function Fa(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:c,nodeLookup:h,lib:a,autoPanOnConnect:p,flowId:d,panBy:u,cancelConnection:x,onConnectStart:g,onConnect:w,onConnectEnd:v,isValidConnection:m=ps,onReconnectEnd:b,updateConnection:l,getTransform:y,getFromHandle:C,autoPanSpeed:N,dragThreshold:S=1,handleDomNode:k}){const D=ts(e.target);let F=0,_;const{x:L,y:z}=pe(e),E=hs(r,k),I=c?.getBoundingClientRect();let M=!1;if(!I||!E)return;const A=fs(s,E,o,h,t);if(!A)return;let P=pe(e,I),T=!1,R=null,H=!1,$=null;function W(){if(!p||!I)return;const[K,X]=Ko(P,I,N);u({x:K,y:X}),F=requestAnimationFrame(W)}const V={...A,nodeId:s,type:E,position:A.position},U=h.get(s);let Y={inProgress:!0,isValid:null,from:De(U,V,B.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:U,to:P,toHandle:null,toPosition:Un[V.position],toNode:null,pointer:P};function O(){M=!0,l(Y),g?.(e,{nodeId:s,handleId:o,handleType:E})}S===0&&O();function Z(K){if(!M){const{x:ie,y:be}=pe(K),we=ie-L,Ie=be-z;if(!(we*we+Ie*Ie>S*S))return;O()}if(!C()||!V){Q(K);return}const X=y();P=pe(K,I),_=$a(lt(P,X,!1,[1,1]),n,h,V),T||(W(),T=!0);const G=ms(K,{handle:_,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:m,doc:D,lib:a,flowId:d,nodeLookup:h});$=G.handleDomNode,R=G.connection,H=Ha(!!_,G.isValid);const ee=h.get(s),ne=ee?De(ee,V,B.Left,!0):Y.from,te={...Y,from:ne,isValid:H,to:G.toHandle&&H?Tt({x:G.toHandle.x,y:G.toHandle.y},X):P,toHandle:G.toHandle,toPosition:H&&G.toHandle?G.toHandle.position:Un[V.position],toNode:G.toHandle?h.get(G.toHandle.nodeId):null,pointer:P};l(te),Y=te}function Q(K){if(!("touches"in K&&K.touches.length>0)){if(M){(_||$)&&R&&H&&w?.(R);const{inProgress:X,...G}=Y,ee={...G,toPosition:Y.toHandle?Y.toPosition:null};v?.(K,ee),r&&b?.(K,ee)}x(),cancelAnimationFrame(F),T=!1,H=!1,R=null,$=null,D.removeEventListener("mousemove",Z),D.removeEventListener("mouseup",Q),D.removeEventListener("touchmove",Z),D.removeEventListener("touchend",Q)}}D.addEventListener("mousemove",Z),D.addEventListener("mouseup",Q),D.addEventListener("touchmove",Z),D.addEventListener("touchend",Q)}function ms(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:c,flowId:h,isValidConnection:a=ps,nodeLookup:p}){const d=r==="target",u=t?i.querySelector(`.${c}-flow__handle[data-id="${h}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x,y:g}=pe(e),w=i.elementFromPoint(x,g),v=w?.classList.contains(`${c}-flow__handle`)?w:u,m={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const b=hs(void 0,v),l=v.getAttribute("data-nodeid"),y=v.getAttribute("data-handleid"),C=v.classList.contains("connectable"),N=v.classList.contains("connectableend");if(!l||!b)return m;const S={source:d?l:o,sourceHandle:d?y:s,target:d?o:l,targetHandle:d?s:y};m.connection=S;const D=C&&N&&(n===He.Strict?d&&b==="source"||!d&&b==="target":l!==o||y!==s);m.isValid=D&&a(S),m.toHandle=fs(l,b,y,p,n,!0)}return m}const pn={onPointerDown:Fa,isValid:ms};function Oa({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=de(e);function r({translateExtent:c,width:h,height:a,zoomStep:p=1,pannable:d=!0,zoomable:u=!0,inversePan:x=!1}){const g=l=>{if(l.sourceEvent.type!=="wheel"||!t)return;const y=n(),C=l.sourceEvent.ctrlKey&&st()?10:1,N=-l.sourceEvent.deltaY*(l.sourceEvent.deltaMode===1?.05:l.sourceEvent.deltaMode?1:.002)*p,S=y[2]*Math.pow(2,N*C);t.scaleTo(S)};let w=[0,0];const v=l=>{(l.sourceEvent.type==="mousedown"||l.sourceEvent.type==="touchstart")&&(w=[l.sourceEvent.clientX??l.sourceEvent.touches[0].clientX,l.sourceEvent.clientY??l.sourceEvent.touches[0].clientY])},m=l=>{const y=n();if(l.sourceEvent.type!=="mousemove"&&l.sourceEvent.type!=="touchmove"||!t)return;const C=[l.sourceEvent.clientX??l.sourceEvent.touches[0].clientX,l.sourceEvent.clientY??l.sourceEvent.touches[0].clientY],N=[C[0]-w[0],C[1]-w[1]];w=C;const S=o()*Math.max(y[2],Math.log(y[2]))*(x?-1:1),k={x:y[0]-N[0]*S,y:y[1]-N[1]*S},D=[[0,0],[h,a]];t.setViewportConstrained({x:k.x,y:k.y,zoom:y[2]},D,c)},b=Bo().on("start",v).on("zoom",d?m:null).on("zoom.wheel",u?g:null);s.call(b,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:fe}}const $t=e=>({x:e.x,y:e.y,zoom:e.k}),en=({x:e,y:t,zoom:n})=>xn.translate(e,t).scale(n),Le=(e,t)=>e.target.closest(`.${t}`),gs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Va=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,tn=(e,t=0,n=Va,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},ys=e=>{const t=e.ctrlKey&&st()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Ba({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:c,onPanZoom:h,onPanZoomEnd:a}){return p=>{if(Le(p,t))return p.ctrlKey&&p.preventDefault(),!1;p.preventDefault(),p.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(p.ctrlKey&&i){const v=fe(p),m=ys(p),b=d*Math.pow(2,m);o.scaleTo(n,b,v,p);return}const u=p.deltaMode===1?20:1;let x=s===je.Vertical?0:p.deltaX*u,g=s===je.Horizontal?0:p.deltaY*u;!st()&&p.shiftKey&&s!==je.Vertical&&(x=p.deltaY*u,g=0),o.translateBy(n,-(x/d)*r,-(g/d)*r,{internal:!0});const w=$t(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(h?.(p,w),e.panScrollTimeout=setTimeout(()=>{a?.(p,w),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c?.(p,w))}}function Wa({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,c=Le(o,e);if(o.ctrlKey&&r&&c&&o.preventDefault(),i||c)return null;o.preventDefault(),n.call(this,o,s)}}function Za({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const s=$t(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=s,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,s)}}function Ya({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{e.usedRightMouseButton=!!(n&&gs(t,e.mouseButton??0)),r.sourceEvent?.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!r.sourceEvent?.internal&&s?.(r.sourceEvent,$t(r.transform))}}function Ua({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{if(!i.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,r&&gs(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s)){const c=$t(i.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s?.(i.sourceEvent,c)},n?150:0)}}}function Xa({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:c,noPanClassName:h,lib:a,connectionInProgress:p}){return d=>{const u=e||t,x=n&&d.ctrlKey,g=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Le(d,`${a}-flow__node`)||Le(d,`${a}-flow__edge`)))return!0;if(!o&&!u&&!s&&!r&&!n||i||p&&!g||Le(d,c)&&g||Le(d,h)&&(!g||s&&g&&!e)||!n&&d.ctrlKey&&g)return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!u&&!s&&!x&&g||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;const w=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||g)&&w}}function Ga({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:s,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:c,onDraggingChange:h}){const a={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=e.getBoundingClientRect(),d=Bo().scaleExtent([t,n]).translateExtent(o),u=de(e).call(d);b({x:s.x,y:s.y,zoom:Oe(s.zoom,t,n)},[[0,0],[p.width,p.height]],o);const x=u.on("wheel.zoom"),g=u.on("dblclick.zoom");d.wheelDelta(ys);function w(_,L){return u?new Promise(z=>{d?.interpolate(L?.interpolate==="linear"?qt:Dt).transform(tn(u,L?.duration,L?.ease,()=>z(!0)),_)}):Promise.resolve(!1)}function v({noWheelClassName:_,noPanClassName:L,onPaneContextMenu:z,userSelectionActive:E,panOnScroll:I,panOnDrag:M,panOnScrollMode:A,panOnScrollSpeed:P,preventScrolling:T,zoomOnPinch:R,zoomOnScroll:H,zoomOnDoubleClick:$,zoomActivationKeyPressed:W,lib:V,onTransformChange:U,connectionInProgress:q,paneClickDistance:Y,selectionOnDrag:O}){E&&!a.isZoomingOrPanning&&m();const Z=I&&!W&&!E;d.clickDistance(O?1/0:!he(Y)||Y<0?0:Y);const Q=Z?Ba({zoomPanValues:a,noWheelClassName:_,d3Selection:u,d3Zoom:d,panOnScrollMode:A,panOnScrollSpeed:P,zoomOnPinch:R,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:c}):Wa({noWheelClassName:_,preventScrolling:T,d3ZoomHandler:x});if(u.on("wheel.zoom",Q,{passive:!1}),!E){const X=Za({zoomPanValues:a,onDraggingChange:h,onPanZoomStart:i});d.on("start",X);const G=Ya({zoomPanValues:a,panOnDrag:M,onPaneContextMenu:!!z,onPanZoom:r,onTransformChange:U});d.on("zoom",G);const ee=Ua({zoomPanValues:a,panOnDrag:M,panOnScroll:I,onPaneContextMenu:z,onPanZoomEnd:c,onDraggingChange:h});d.on("end",ee)}const K=Xa({zoomActivationKeyPressed:W,panOnDrag:M,zoomOnScroll:H,panOnScroll:I,zoomOnDoubleClick:$,zoomOnPinch:R,userSelectionActive:E,noPanClassName:L,noWheelClassName:_,lib:V,connectionInProgress:q});d.filter(K),$?u.on("dblclick.zoom",g):u.on("dblclick.zoom",null)}function m(){d.on("zoom",null)}async function b(_,L,z){const E=en(_),I=d?.constrain()(E,L,z);return I&&await w(I),new Promise(M=>M(I))}async function l(_,L){const z=en(_);return await w(z,L),new Promise(E=>E(z))}function y(_){if(u){const L=en(_),z=u.property("__zoom");(z.k!==_.zoom||z.x!==_.x||z.y!==_.y)&&d?.transform(u,L,null,{sync:!0})}}function C(){const _=u?hi(u.node()):{x:0,y:0,k:1};return{x:_.x,y:_.y,zoom:_.k}}function N(_,L){return u?new Promise(z=>{d?.interpolate(L?.interpolate==="linear"?qt:Dt).scaleTo(tn(u,L?.duration,L?.ease,()=>z(!0)),_)}):Promise.resolve(!1)}function S(_,L){return u?new Promise(z=>{d?.interpolate(L?.interpolate==="linear"?qt:Dt).scaleBy(tn(u,L?.duration,L?.ease,()=>z(!0)),_)}):Promise.resolve(!1)}function k(_){d?.scaleExtent(_)}function D(_){d?.translateExtent(_)}function F(_){const L=!he(_)||_<0?0:_;d?.clickDistance(L)}return{update:v,destroy:m,setViewport:l,setViewportConstrained:b,getViewport:C,scaleTo:N,scaleBy:S,setScaleExtent:k,setTranslateExtent:D,syncViewport:y,setClickDistance:F}}var We;(function(e){e.Line="line",e.Handle="handle"})(We||(We={}));function qa({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,c=n-o,h=[i>0?1:i<0?-1:0,c>0?1:c<0?-1:0];return i&&s&&(h[0]=h[0]*-1),c&&r&&(h[1]=h[1]*-1),h}function io(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function Ee(e,t){return Math.max(0,t-e)}function Se(e,t){return Math.max(0,e-t)}function pt(e,t,n){return Math.max(0,t-e,e-n)}function ao(e,t){return e?!t:t}function Ka(e,t,n,o,s,r,i,c){let{affectsX:h,affectsY:a}=t;const{isHorizontal:p,isVertical:d}=t,u=p&&d,{xSnapped:x,ySnapped:g}=n,{minWidth:w,maxWidth:v,minHeight:m,maxHeight:b}=o,{x:l,y,width:C,height:N,aspectRatio:S}=e;let k=Math.floor(p?x-e.pointerX:0),D=Math.floor(d?g-e.pointerY:0);const F=C+(h?-k:k),_=N+(a?-D:D),L=-r[0]*C,z=-r[1]*N;let E=pt(F,w,v),I=pt(_,m,b);if(i){let P=0,T=0;h&&k<0?P=Ee(l+k+L,i[0][0]):!h&&k>0&&(P=Se(l+F+L,i[1][0])),a&&D<0?T=Ee(y+D+z,i[0][1]):!a&&D>0&&(T=Se(y+_+z,i[1][1])),E=Math.max(E,P),I=Math.max(I,T)}if(c){let P=0,T=0;h&&k>0?P=Se(l+k,c[0][0]):!h&&k<0&&(P=Ee(l+F,c[1][0])),a&&D>0?T=Se(y+D,c[0][1]):!a&&D<0&&(T=Ee(y+_,c[1][1])),E=Math.max(E,P),I=Math.max(I,T)}if(s){if(p){const P=pt(F/S,m,b)*S;if(E=Math.max(E,P),i){let T=0;!h&&!a||h&&!a&&u?T=Se(y+z+F/S,i[1][1])*S:T=Ee(y+z+(h?k:-k)/S,i[0][1])*S,E=Math.max(E,T)}if(c){let T=0;!h&&!a||h&&!a&&u?T=Ee(y+F/S,c[1][1])*S:T=Se(y+(h?k:-k)/S,c[0][1])*S,E=Math.max(E,T)}}if(d){const P=pt(_*S,w,v)/S;if(I=Math.max(I,P),i){let T=0;!h&&!a||a&&!h&&u?T=Se(l+_*S+L,i[1][0])/S:T=Ee(l+(a?D:-D)*S+L,i[0][0])/S,I=Math.max(I,T)}if(c){let T=0;!h&&!a||a&&!h&&u?T=Ee(l+_*S,c[1][0])/S:T=Se(l+(a?D:-D)*S,c[0][0])/S,I=Math.max(I,T)}}}D=D+(D<0?I:-I),k=k+(k<0?E:-E),s&&(u?F>_*S?D=(ao(h,a)?-k:k)/S:k=(ao(h,a)?-D:D)*S:p?(D=k/S,a=h):(k=D*S,h=a));const M=h?l+k:l,A=a?y+D:y;return{width:C+(h?-k:k),height:N+(a?-D:D),x:r[0]*k*(h?-1:1)+M,y:r[1]*D*(a?-1:1)+A}}const xs={width:0,height:0,x:0,y:0},Qa={...xs,pointerX:0,pointerY:0,aspectRatio:1};function Ja(e){return[[0,0],[e.measured.width,e.measured.height]]}function ec(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,c=n[0]*r,h=n[1]*i;return[[o-c,s-h],[o+r-c,s+i-h]]}function tc({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=de(e);let i={controlDirection:io("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:a,boundaries:p,keepAspectRatio:d,resizeDirection:u,onResizeStart:x,onResize:g,onResizeEnd:w,shouldResize:v}){let m={...xs},b={...Qa};i={boundaries:p,resizeDirection:u,keepAspectRatio:d,controlDirection:io(a)};let l,y=null,C=[],N,S,k,D=!1;const F=Vo().on("start",_=>{const{nodeLookup:L,transform:z,snapGrid:E,snapToGrid:I,nodeOrigin:M,paneDomNode:A}=n();if(l=L.get(t),!l)return;y=A?.getBoundingClientRect()??null;const{xSnapped:P,ySnapped:T}=Qe(_.sourceEvent,{transform:z,snapGrid:E,snapToGrid:I,containerBounds:y});m={width:l.measured.width??0,height:l.measured.height??0,x:l.position.x??0,y:l.position.y??0},b={...m,pointerX:P,pointerY:T,aspectRatio:m.width/m.height},N=void 0,l.parentId&&(l.extent==="parent"||l.expandParent)&&(N=L.get(l.parentId),S=N&&l.extent==="parent"?Ja(N):void 0),C=[],k=void 0;for(const[R,H]of L)if(H.parentId===t&&(C.push({id:R,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const $=ec(H,l,H.origin??M);k?k=[[Math.min($[0][0],k[0][0]),Math.min($[0][1],k[0][1])],[Math.max($[1][0],k[1][0]),Math.max($[1][1],k[1][1])]]:k=$}x?.(_,{...m})}).on("drag",_=>{const{transform:L,snapGrid:z,snapToGrid:E,nodeOrigin:I}=n(),M=Qe(_.sourceEvent,{transform:L,snapGrid:z,snapToGrid:E,containerBounds:y}),A=[];if(!l)return;const{x:P,y:T,width:R,height:H}=m,$={},W=l.origin??I,{width:V,height:U,x:q,y:Y}=Ka(b,i.controlDirection,M,i.boundaries,i.keepAspectRatio,W,S,k),O=V!==R,Z=U!==H,Q=q!==P&&O,K=Y!==T&&Z;if(!Q&&!K&&!O&&!Z)return;if((Q||K||W[0]===1||W[1]===1)&&($.x=Q?q:m.x,$.y=K?Y:m.y,m.x=$.x,m.y=$.y,C.length>0)){const ne=q-P,te=Y-T;for(const ie of C)ie.position={x:ie.position.x-ne+W[0]*(V-R),y:ie.position.y-te+W[1]*(U-H)},A.push(ie)}if((O||Z)&&($.width=O&&(!i.resizeDirection||i.resizeDirection==="horizontal")?V:m.width,$.height=Z&&(!i.resizeDirection||i.resizeDirection==="vertical")?U:m.height,m.width=$.width,m.height=$.height),N&&l.expandParent){const ne=W[0]*($.width??0);$.x&&$.x<ne&&(m.x=ne,b.x=b.x-($.x-ne));const te=W[1]*($.height??0);$.y&&$.y<te&&(m.y=te,b.y=b.y-($.y-te))}const X=qa({width:m.width,prevWidth:R,height:m.height,prevHeight:H,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),G={...m,direction:X};v?.(_,G)!==!1&&(D=!0,g?.(_,G),o($,A))}).on("end",_=>{D&&(w?.(_,{...m}),s?.({...m}),D=!1)});r.call(F)}function h(){r.on(".drag",null)}return{update:c,destroy:h}}var nn={exports:{}},on={};var co;function nc(){if(co)return on;co=1;var e=ui(),t=pi();function n(a,p){return a===p&&(a!==0||1/a===1/p)||a!==a&&p!==p}var o=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,r=e.useRef,i=e.useEffect,c=e.useMemo,h=e.useDebugValue;return on.useSyncExternalStoreWithSelector=function(a,p,d,u,x){var g=r(null);if(g.current===null){var w={hasValue:!1,value:null};g.current=w}else w=g.current;g=c(function(){function m(N){if(!b){if(b=!0,l=N,N=u(N),x!==void 0&&w.hasValue){var S=w.value;if(x(S,N))return y=S}return y=N}if(S=y,o(l,N))return S;var k=u(N);return x!==void 0&&x(S,k)?(l=N,S):(l=N,y=k)}var b=!1,l,y,C=d===void 0?null:d;return[function(){return m(p())},C===null?void 0:function(){return m(C())}]},[p,d,u,x]);var v=s(a,g[0],g[1]);return i(function(){w.hasValue=!0,w.value=v},[v]),h(v),v},on}var lo;function oc(){return lo||(lo=1,nn.exports=nc()),nn.exports}var sc=oc();const rc=fi(sc),ic={},uo=e=>{let t;const n=new Set,o=(p,d)=>{const u=typeof p=="function"?p(t):p;if(!Object.is(u,t)){const x=t;t=d??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(g=>g(t,x))}},s=()=>t,h={setState:o,getState:s,getInitialState:()=>a,subscribe:p=>(n.add(p),()=>n.delete(p)),destroy:()=>{(ic?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(o,s,h);return h},ac=e=>e?uo(e):uo,{useDebugValue:cc}=Ke,{useSyncExternalStoreWithSelector:lc}=rc,dc=e=>e;function ws(e,t=dc,n){const o=lc(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return cc(o),o}const fo=(e,t)=>{const n=ac(e),o=(s,r=t)=>ws(n,s,r);return Object.assign(o,n),o},uc=(e,t)=>e?fo(e,t):fo;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const Ht=j.createContext(null),fc=Ht.Provider,vs=ge.error001();function J(e,t){const n=j.useContext(Ht);if(n===null)throw new Error(vs);return ws(n,e,t)}function se(){const e=j.useContext(Ht);if(e===null)throw new Error(vs);return j.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ho={display:"none"},hc={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},bs="react-flow__node-desc",Es="react-flow__edge-desc",pc="react-flow__aria-live",mc=e=>e.ariaLiveMessage,gc=e=>e.ariaLabelConfig;function yc({rfId:e}){const t=J(mc);return f.jsx("div",{id:`${pc}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:hc,children:t})}function xc({rfId:e,disableKeyboardA11y:t}){const n=J(gc);return f.jsxs(f.Fragment,{children:[f.jsx("div",{id:`${bs}-${e}`,style:ho,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),f.jsx("div",{id:`${Es}-${e}`,style:ho,children:n["edge.a11yDescription.default"]}),!t&&f.jsx(yc,{rfId:e})]})}const Ft=j.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return f.jsx("div",{className:re(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});Ft.displayName="Panel";function wc({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:f.jsx(Ft,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:f.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const vc=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},mt=e=>e.id;function bc(e,t){return oe(e.selectedNodes.map(mt),t.selectedNodes.map(mt))&&oe(e.selectedEdges.map(mt),t.selectedEdges.map(mt))}function Ec({onSelectionChange:e}){const t=se(),{selectedNodes:n,selectedEdges:o}=J(vc,bc);return j.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const Sc=e=>!!e.onSelectionChangeHandlers;function Nc({onSelectionChange:e}){const t=J(Sc);return e||t?f.jsx(Ec,{onSelectionChange:e}):null}const Ss=[0,0],Cc={x:0,y:0,zoom:1},Mc=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],po=[...Mc,"rfId"],kc=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),mo={translateExtent:tt,nodeOrigin:Ss,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function Ic(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:c,setDefaultNodesAndEdges:h}=J(kc,oe),a=se();j.useEffect(()=>(h(e.defaultNodes,e.defaultEdges),()=>{p.current=mo,c()}),[]);const p=j.useRef(mo);return j.useEffect(()=>{for(const d of po){const u=e[d],x=p.current[d];u!==x&&(typeof e[d]>"u"||(d==="nodes"?t(u):d==="edges"?n(u):d==="minZoom"?o(u):d==="maxZoom"?s(u):d==="translateExtent"?r(u):d==="nodeExtent"?i(u):d==="ariaLabelConfig"?a.setState({ariaLabelConfig:ha(u)}):d==="fitView"?a.setState({fitViewQueued:u}):d==="fitViewOptions"?a.setState({fitViewOptions:u}):a.setState({[d]:u})))}p.current=e},po.map(d=>e[d])),null}function go(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Pc(e){const[t,n]=j.useState(e==="system"?null:e);return j.useEffect(()=>{if(e!=="system"){n(e);return}const o=go(),s=()=>n(o?.matches?"dark":"light");return s(),o?.addEventListener("change",s),()=>{o?.removeEventListener("change",s)}},[e]),t!==null?t:go()?.matches?"dark":"light"}const yo=typeof document<"u"?document:null;function rt(e=null,t={target:yo,actInsideInputWithModifier:!0}){const[n,o]=j.useState(!1),s=j.useRef(!1),r=j.useRef(new Set([])),[i,c]=j.useMemo(()=>{if(e!==null){const a=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),p=a.reduce((d,u)=>d.concat(...u),[]);return[a,p]}return[[],[]]},[e]);return j.useEffect(()=>{const h=t?.target??yo,a=t?.actInsideInputWithModifier??!0;if(e!==null){const p=x=>{if(s.current=x.ctrlKey||x.metaKey||x.shiftKey||x.altKey,(!s.current||s.current&&!a)&&ns(x))return!1;const w=wo(x.code,c);if(r.current.add(x[w]),xo(i,r.current,!1)){const v=x.composedPath?.()?.[0]||x.target,m=v?.nodeName==="BUTTON"||v?.nodeName==="A";t.preventDefault!==!1&&(s.current||!m)&&x.preventDefault(),o(!0)}},d=x=>{const g=wo(x.code,c);xo(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(x[g]),x.key==="Meta"&&r.current.clear(),s.current=!1},u=()=>{r.current.clear(),o(!1)};return h?.addEventListener("keydown",p),h?.addEventListener("keyup",d),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{h?.removeEventListener("keydown",p),h?.removeEventListener("keyup",d),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),n}function xo(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function wo(e,t){return t.includes(e)?"code":"key"}const jc=()=>{const e=se();return j.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:c}=e.getState(),h=En(t,o,s,r,i,n?.padding??.1);return c?(await c.setViewport(h,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:c,y:h}=i.getBoundingClientRect(),a={x:t.x-c,y:t.y-h},p=n.snapGrid??s,d=n.snapToGrid??r;return lt(a,o,d,p)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=Tt(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function Ns(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const c={...r};for(const h of i)Ac(h,c);n.push(c)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function Ac(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Cs(e,t){return Ns(e,t)}function Ms(e,t){return Ns(e,t)}function Pe(e,t){return{id:e,type:"select",selected:t}}function Re(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(Pe(r.id,i)))}return o}function vo({items:e=[],lookup:t}){const n=[],o=new Map(e.map(s=>[s.id,s]));for(const[s,r]of e.entries()){const i=t.get(r.id),c=i?.internals?.userNode??i;c!==void 0&&c!==r&&n.push({id:r.id,item:r,type:"replace"}),c===void 0&&n.push({item:r,type:"add",index:s})}for(const[s]of t)o.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function bo(e){return{id:e.id,type:"remove"}}const Eo=e=>oa(e),Dc=e=>Xo(e);function ks(e){return j.forwardRef(e)}const _c=typeof window<"u"?j.useLayoutEffect:j.useEffect;function So(e){const[t,n]=j.useState(BigInt(0)),[o]=j.useState(()=>Tc(()=>n(s=>s+BigInt(1))));return _c(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function Tc(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Is=j.createContext(null);function Lc({children:e}){const t=se(),n=j.useCallback(c=>{const{nodes:h=[],setNodes:a,hasDefaultNodes:p,onNodesChange:d,nodeLookup:u,fitViewQueued:x,onNodesChangeMiddlewareMap:g}=t.getState();let w=h;for(const m of c)w=typeof m=="function"?m(w):m;let v=vo({items:w,lookup:u});for(const m of g.values())v=m(v);p&&a(w),v.length>0?d?.(v):x&&window.requestAnimationFrame(()=>{const{fitViewQueued:m,nodes:b,setNodes:l}=t.getState();m&&l(b)})},[]),o=So(n),s=j.useCallback(c=>{const{edges:h=[],setEdges:a,hasDefaultEdges:p,onEdgesChange:d,edgeLookup:u}=t.getState();let x=h;for(const g of c)x=typeof g=="function"?g(x):g;p?a(x):d&&d(vo({items:x,lookup:u}))},[]),r=So(s),i=j.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return f.jsx(Is.Provider,{value:i,children:e})}function Rc(){const e=j.useContext(Is);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const zc=e=>!!e.panZoom;function Pn(){const e=jc(),t=se(),n=Rc(),o=J(zc),s=j.useMemo(()=>{const r=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},c=d=>{n.edgeQueue.push(d)},h=d=>{const{nodeLookup:u,nodeOrigin:x}=t.getState(),g=Eo(d)?d:u.get(d.id),w=g.parentId?es(g.position,g.measured,g.parentId,u,x):g.position,v={...g,position:w,width:g.measured?.width??g.width,height:g.measured?.height??g.height};return Ve(v)},a=(d,u,x={replace:!1})=>{i(g=>g.map(w=>{if(w.id===d){const v=typeof u=="function"?u(w):u;return x.replace&&Eo(v)?v:{...w,...v}}return w}))},p=(d,u,x={replace:!1})=>{c(g=>g.map(w=>{if(w.id===d){const v=typeof u=="function"?u(w):u;return x.replace&&Dc(v)?v:{...w,...v}}return w}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>r(d)?.internals.userNode,getInternalNode:r,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(u=>({...u}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:c,addNodes:d=>{const u=Array.isArray(d)?d:[d];n.nodeQueue.push(x=>[...x,...u])},addEdges:d=>{const u=Array.isArray(d)?d:[d];n.edgeQueue.push(x=>[...x,...u])},toObject:()=>{const{nodes:d=[],edges:u=[],transform:x}=t.getState(),[g,w,v]=x;return{nodes:d.map(m=>({...m})),edges:u.map(m=>({...m})),viewport:{x:g,y:w,zoom:v}}},deleteElements:async({nodes:d=[],edges:u=[]})=>{const{nodes:x,edges:g,onNodesDelete:w,onEdgesDelete:v,triggerNodeChanges:m,triggerEdgeChanges:b,onDelete:l,onBeforeDelete:y}=t.getState(),{nodes:C,edges:N}=await ca({nodesToRemove:d,edgesToRemove:u,nodes:x,edges:g,onBeforeDelete:y}),S=N.length>0,k=C.length>0;if(S){const D=N.map(bo);v?.(N),b(D)}if(k){const D=C.map(bo);w?.(C),m(D)}return(k||S)&&l?.({nodes:C,edges:N}),{deletedNodes:C,deletedEdges:N}},getIntersectingNodes:(d,u=!0,x)=>{const g=Gn(d),w=g?d:h(d),v=x!==void 0;return w?(x||t.getState().nodes).filter(m=>{const b=t.getState().nodeLookup.get(m.id);if(b&&!g&&(m.id===d.id||!b.internals.positionAbsolute))return!1;const l=Ve(v?m:b),y=ot(l,w);return u&&y>0||y>=l.width*l.height||y>=w.width*w.height}):[]},isNodeIntersecting:(d,u,x=!0)=>{const w=Gn(d)?d:h(d);if(!w)return!1;const v=ot(w,u);return x&&v>0||v>=u.width*u.height||v>=w.width*w.height},updateNode:a,updateNodeData:(d,u,x={replace:!1})=>{a(d,g=>{const w=typeof u=="function"?u(g):u;return x.replace?{...g,data:w}:{...g,data:{...g.data,...w}}},x)},updateEdge:p,updateEdgeData:(d,u,x={replace:!1})=>{p(d,g=>{const w=typeof u=="function"?u(g):u;return x.replace?{...g,data:w}:{...g,data:{...g.data,...w}}},x)},getNodesBounds:d=>{const{nodeLookup:u,nodeOrigin:x}=t.getState();return sa(d,{nodeLookup:u,nodeOrigin:x})},getHandleConnections:({type:d,id:u,nodeId:x})=>Array.from(t.getState().connectionLookup.get(`${x}-${d}${u?`-${u}`:""}`)?.values()??[]),getNodeConnections:({type:d,handleId:u,nodeId:x})=>Array.from(t.getState().connectionLookup.get(`${x}${d?u?`-${d}-${u}`:`-${d}`:""}`)?.values()??[]),fitView:async d=>{const u=t.getState().fitViewResolver??fa();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:u}),n.nodeQueue.push(x=>[...x]),u.promise}}},[]);return j.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const No=e=>e.selected,$c=typeof window<"u"?window:void 0;function Hc({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=se(),{deleteElements:o}=Pn(),s=rt(e,{actInsideInputWithModifier:!1}),r=rt(t,{target:$c});j.useEffect(()=>{if(s){const{edges:i,nodes:c}=n.getState();o({nodes:c.filter(No),edges:i.filter(No)}),n.setState({nodesSelectionActive:!1})}},[s]),j.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function Fc(e){const t=se();j.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=Sn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",ge.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const Ot={position:"absolute",width:"100%",height:"100%",top:0,left:0},Oc=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Vc({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=je.Free,zoomOnDoubleClick:i=!0,panOnDrag:c=!0,defaultViewport:h,translateExtent:a,minZoom:p,maxZoom:d,zoomActivationKeyCode:u,preventScrolling:x=!0,children:g,noWheelClassName:w,noPanClassName:v,onViewportChange:m,isControlledViewport:b,paneClickDistance:l,selectionOnDrag:y}){const C=se(),N=j.useRef(null),{userSelectionActive:S,lib:k,connectionInProgress:D}=J(Oc,oe),F=rt(u),_=j.useRef();Fc(N);const L=j.useCallback(z=>{m?.({x:z[0],y:z[1],zoom:z[2]}),b||C.setState({transform:z})},[m,b]);return j.useEffect(()=>{if(N.current){_.current=Ga({domNode:N.current,minZoom:p,maxZoom:d,translateExtent:a,viewport:h,onDraggingChange:M=>C.setState({paneDragging:M}),onPanZoomStart:(M,A)=>{const{onViewportChangeStart:P,onMoveStart:T}=C.getState();T?.(M,A),P?.(A)},onPanZoom:(M,A)=>{const{onViewportChange:P,onMove:T}=C.getState();T?.(M,A),P?.(A)},onPanZoomEnd:(M,A)=>{const{onViewportChangeEnd:P,onMoveEnd:T}=C.getState();T?.(M,A),P?.(A)}});const{x:z,y:E,zoom:I}=_.current.getViewport();return C.setState({panZoom:_.current,transform:[z,E,I],domNode:N.current.closest(".react-flow")}),()=>{_.current?.destroy()}}},[]),j.useEffect(()=>{_.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:c,zoomActivationKeyPressed:F,preventScrolling:x,noPanClassName:v,userSelectionActive:S,noWheelClassName:w,lib:k,onTransformChange:L,connectionInProgress:D,selectionOnDrag:y,paneClickDistance:l})},[e,t,n,o,s,r,i,c,F,x,v,S,w,k,L,D,y,l]),f.jsx("div",{className:"react-flow__renderer",ref:N,style:Ot,children:g})}const Bc=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Wc(){const{userSelectionActive:e,userSelectionRect:t}=J(Bc,oe);return e&&t?f.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const sn=(e,t)=>n=>{n.target===t.current&&e?.(n)},Zc=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Yc({isSelecting:e,selectionKeyPressed:t,selectionMode:n=nt.Full,panOnDrag:o,paneClickDistance:s,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:c,onPaneClick:h,onPaneContextMenu:a,onPaneScroll:p,onPaneMouseEnter:d,onPaneMouseMove:u,onPaneMouseLeave:x,children:g}){const w=se(),{userSelectionActive:v,elementsSelectable:m,dragging:b,connectionInProgress:l}=J(Zc,oe),y=m&&(e||v),C=j.useRef(null),N=j.useRef(),S=j.useRef(new Set),k=j.useRef(new Set),D=j.useRef(!1),F=P=>{if(D.current||l){D.current=!1;return}h?.(P),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},_=P=>{if(Array.isArray(o)&&o?.includes(2)){P.preventDefault();return}a?.(P)},L=p?P=>p(P):void 0,z=P=>{D.current&&(P.stopPropagation(),D.current=!1)},E=P=>{const{domNode:T}=w.getState();if(N.current=T?.getBoundingClientRect(),!N.current)return;const R=P.target===C.current;if(!R&&!!P.target.closest(".nokey")||!e||!(r&&R||t)||P.button!==0||!P.isPrimary)return;P.target?.setPointerCapture?.(P.pointerId),D.current=!1;const{x:W,y:V}=pe(P.nativeEvent,N.current);w.setState({userSelectionRect:{width:0,height:0,startX:W,startY:V,x:W,y:V}}),R||(P.stopPropagation(),P.preventDefault())},I=P=>{const{userSelectionRect:T,transform:R,nodeLookup:H,edgeLookup:$,connectionLookup:W,triggerNodeChanges:V,triggerEdgeChanges:U,defaultEdgeOptions:q,resetSelectedElements:Y}=w.getState();if(!N.current||!T)return;const{x:O,y:Z}=pe(P.nativeEvent,N.current),{startX:Q,startY:K}=T;if(!D.current){const te=t?0:s;if(Math.hypot(O-Q,Z-K)<=te)return;Y(),i?.(P)}D.current=!0;const X={startX:Q,startY:K,x:O<Q?O:Q,y:Z<K?Z:K,width:Math.abs(O-Q),height:Math.abs(Z-K)},G=S.current,ee=k.current;S.current=new Set(bn(H,X,R,n===nt.Partial,!0).map(te=>te.id)),k.current=new Set;const ne=q?.selectable??!0;for(const te of S.current){const ie=W.get(te);if(ie)for(const{edgeId:be}of ie.values()){const we=$.get(be);we&&(we.selectable??ne)&&k.current.add(be)}}if(!qn(G,S.current)){const te=Re(H,S.current,!0);V(te)}if(!qn(ee,k.current)){const te=Re($,k.current);U(te)}w.setState({userSelectionRect:X,userSelectionActive:!0,nodesSelectionActive:!1})},M=P=>{P.button===0&&(P.target?.releasePointerCapture?.(P.pointerId),!v&&P.target===C.current&&w.getState().userSelectionRect&&F?.(P),w.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(c?.(P),w.setState({nodesSelectionActive:S.current.size>0})))},A=o===!0||Array.isArray(o)&&o.includes(0);return f.jsxs("div",{className:re(["react-flow__pane",{draggable:A,dragging:b,selection:e}]),onClick:y?void 0:sn(F,C),onContextMenu:sn(_,C),onWheel:sn(L,C),onPointerEnter:y?void 0:d,onPointerMove:y?I:u,onPointerUp:y?M:void 0,onPointerDownCapture:y?E:void 0,onClickCapture:y?z:void 0,onPointerLeave:x,ref:C,style:Ot,children:[g,f.jsx(Wc,{})]})}function mn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:c,onError:h}=t.getState(),a=c.get(e);if(!a){h?.("012",ge.error012(e));return}t.setState({nodesSelectionActive:!1}),a.selected?(n||a.selected&&i)&&(r({nodes:[a],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function Ps({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const c=se(),[h,a]=j.useState(!1),p=j.useRef();return j.useEffect(()=>{p.current=La({getStoreItems:()=>c.getState(),onNodeMouseDown:d=>{mn({id:d,store:c,nodeRef:e})},onDragStart:()=>{a(!0)},onDragStop:()=>{a(!1)}})},[]),j.useEffect(()=>{if(t)p.current?.destroy();else if(e.current)return p.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{p.current?.destroy()}},[n,o,t,r,e,s]),h}const Uc=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function js(){const e=se();return j.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:c,updateNodePositions:h,nodeLookup:a,nodeOrigin:p}=e.getState(),d=new Map,u=Uc(i),x=s?r[0]:5,g=s?r[1]:5,w=n.direction.x*x*n.factor,v=n.direction.y*g*n.factor;for(const[,m]of a){if(!u(m))continue;let b={x:m.internals.positionAbsolute.x+w,y:m.internals.positionAbsolute.y+v};s&&(b=ct(b,r));const{position:l,positionAbsolute:y}=Go({nodeId:m.id,nextPosition:b,nodeLookup:a,nodeExtent:o,nodeOrigin:p,onError:c});m.position=l,m.internals.positionAbsolute=y,d.set(m.id,m)}h(d)},[])}const jn=j.createContext(null),Xc=jn.Provider;jn.Consumer;const As=()=>j.useContext(jn),Gc=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),qc=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:c,toHandle:h,isValid:a}=i,p=h?.nodeId===e&&h?.id===t&&h?.type===n;return{connectingFrom:c?.nodeId===e&&c?.id===t&&c?.type===n,connectingTo:p,clickConnecting:s?.nodeId===e&&s?.id===t&&s?.type===n,isPossibleEndHandle:r===He.Strict?c?.type!==n:e!==c?.nodeId||t!==c?.id,connectionInProcess:!!c,clickConnectionInProcess:!!s,valid:p&&a}};function Kc({type:e="source",position:t=B.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:c,children:h,className:a,onMouseDown:p,onTouchStart:d,...u},x){const g=i||null,w=e==="target",v=se(),m=As(),{connectOnClick:b,noPanClassName:l,rfId:y}=J(Gc,oe),{connectingFrom:C,connectingTo:N,clickConnecting:S,isPossibleEndHandle:k,connectionInProcess:D,clickConnectionInProcess:F,valid:_}=J(qc(m,g,e),oe);m||v.getState().onError?.("010",ge.error010());const L=I=>{const{defaultEdgeOptions:M,onConnect:A,hasDefaultEdges:P}=v.getState(),T={...M,...I};if(P){const{edges:R,setEdges:H}=v.getState();H(wa(T,R))}A?.(T),c?.(T)},z=I=>{if(!m)return;const M=os(I.nativeEvent);if(s&&(M&&I.button===0||!M)){const A=v.getState();pn.onPointerDown(I.nativeEvent,{handleDomNode:I.currentTarget,autoPanOnConnect:A.autoPanOnConnect,connectionMode:A.connectionMode,connectionRadius:A.connectionRadius,domNode:A.domNode,nodeLookup:A.nodeLookup,lib:A.lib,isTarget:w,handleId:g,nodeId:m,flowId:A.rfId,panBy:A.panBy,cancelConnection:A.cancelConnection,onConnectStart:A.onConnectStart,onConnectEnd:A.onConnectEnd,updateConnection:A.updateConnection,onConnect:L,isValidConnection:n||A.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:A.autoPanSpeed,dragThreshold:A.connectionDragThreshold})}M?p?.(I):d?.(I)},E=I=>{const{onClickConnectStart:M,onClickConnectEnd:A,connectionClickStartHandle:P,connectionMode:T,isValidConnection:R,lib:H,rfId:$,nodeLookup:W,connection:V}=v.getState();if(!m||!P&&!s)return;if(!P){M?.(I.nativeEvent,{nodeId:m,handleId:g,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:m,type:e,id:g}});return}const U=ts(I.target),q=n||R,{connection:Y,isValid:O}=pn.isValid(I.nativeEvent,{handle:{nodeId:m,id:g,type:e},connectionMode:T,fromNodeId:P.nodeId,fromHandleId:P.id||null,fromType:P.type,isValidConnection:q,flowId:$,doc:U,lib:H,nodeLookup:W});O&&Y&&L(Y);const Z=structuredClone(V);delete Z.inProgress,Z.toPosition=Z.toHandle?Z.toHandle.position:null,A?.(I,Z),v.setState({connectionClickStartHandle:null})};return f.jsx("div",{"data-handleid":g,"data-nodeid":m,"data-handlepos":t,"data-id":`${y}-${m}-${g}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",l,a,{source:!w,target:w,connectable:o,connectablestart:s,connectableend:r,clickconnecting:S,connectingfrom:C,connectingto:N,valid:_,connectionindicator:o&&(!D||k)&&(D||F?r:s)}]),onMouseDown:z,onTouchStart:z,onClick:b?E:void 0,ref:x,...u,children:h})}const ce=j.memo(ks(Kc));function Qc({data:e,isConnectable:t,sourcePosition:n=B.Bottom}){return f.jsxs(f.Fragment,{children:[e?.label,f.jsx(ce,{type:"source",position:n,isConnectable:t})]})}function Jc({data:e,isConnectable:t,targetPosition:n=B.Top,sourcePosition:o=B.Bottom}){return f.jsxs(f.Fragment,{children:[f.jsx(ce,{type:"target",position:n,isConnectable:t}),e?.label,f.jsx(ce,{type:"source",position:o,isConnectable:t})]})}function el(){return null}function tl({data:e,isConnectable:t,targetPosition:n=B.Top}){return f.jsxs(f.Fragment,{children:[f.jsx(ce,{type:"target",position:n,isConnectable:t}),e?.label]})}const Lt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Co={input:Qc,default:Jc,output:tl,group:el};function nl(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const ol=e=>{const{width:t,height:n,x:o,y:s}=at(e.nodeLookup,{filter:r=>!!r.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function sl({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=se(),{width:s,height:r,transformString:i,userSelectionActive:c}=J(ol,oe),h=js(),a=j.useRef(null);if(j.useEffect(()=>{n||a.current?.focus({preventScroll:!0})},[n]),Ps({nodeRef:a}),c||!s||!r)return null;const p=e?u=>{const x=o.getState().nodes.filter(g=>g.selected);e(u,x)}:void 0,d=u=>{Object.prototype.hasOwnProperty.call(Lt,u.key)&&(u.preventDefault(),h({direction:Lt[u.key],factor:u.shiftKey?4:1}))};return f.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:f.jsx("div",{ref:a,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:s,height:r}})})}const Mo=typeof window<"u"?window:void 0,rl=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ds({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:c,deleteKeyCode:h,selectionKeyCode:a,selectionOnDrag:p,selectionMode:d,onSelectionStart:u,onSelectionEnd:x,multiSelectionKeyCode:g,panActivationKeyCode:w,zoomActivationKeyCode:v,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:l,panOnScroll:y,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:S,panOnDrag:k,defaultViewport:D,translateExtent:F,minZoom:_,maxZoom:L,preventScrolling:z,onSelectionContextMenu:E,noWheelClassName:I,noPanClassName:M,disableKeyboardA11y:A,onViewportChange:P,isControlledViewport:T}){const{nodesSelectionActive:R,userSelectionActive:H}=J(rl,oe),$=rt(a,{target:Mo}),W=rt(w,{target:Mo}),V=W||k,U=W||y,q=p&&V!==!0,Y=$||H||q;return Hc({deleteKeyCode:h,multiSelectionKeyCode:g}),f.jsx(Vc,{onPaneContextMenu:r,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:l,panOnScroll:U,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:S,panOnDrag:!$&&V,defaultViewport:D,translateExtent:F,minZoom:_,maxZoom:L,zoomActivationKeyCode:v,preventScrolling:z,noWheelClassName:I,noPanClassName:M,onViewportChange:P,isControlledViewport:T,paneClickDistance:c,selectionOnDrag:q,children:f.jsxs(Yc,{onSelectionStart:u,onSelectionEnd:x,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:V,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:$,paneClickDistance:c,selectionOnDrag:q,children:[e,R&&f.jsx(sl,{onSelectionContextMenu:E,noPanClassName:M,disableKeyboardA11y:A})]})})}Ds.displayName="FlowRenderer";const il=j.memo(Ds),al=e=>t=>e?bn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function cl(e){return J(j.useCallback(al(e),[e]),oe)}const ll=e=>e.updateNodeInternals;function dl(){const e=J(ll),[t]=j.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return j.useEffect(()=>()=>{t?.disconnect()},[t]),t}function ul({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=se(),r=j.useRef(null),i=j.useRef(null),c=j.useRef(e.sourcePosition),h=j.useRef(e.targetPosition),a=j.useRef(t),p=n&&!!e.internals.handleBounds;return j.useEffect(()=>{r.current&&!e.hidden&&(!p||i.current!==r.current)&&(i.current&&o?.unobserve(i.current),o?.observe(r.current),i.current=r.current)},[p,e.hidden]),j.useEffect(()=>()=>{i.current&&(o?.unobserve(i.current),i.current=null)},[]),j.useEffect(()=>{if(r.current){const d=a.current!==t,u=c.current!==e.sourcePosition,x=h.current!==e.targetPosition;(d||u||x)&&(a.current=t,c.current=e.sourcePosition,h.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function fl({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:c,elementsSelectable:h,nodesConnectable:a,nodesFocusable:p,resizeObserver:d,noDragClassName:u,noPanClassName:x,disableKeyboardA11y:g,rfId:w,nodeTypes:v,nodeClickDistance:m,onError:b}){const{node:l,internals:y,isParent:C}=J(O=>{const Z=O.nodeLookup.get(e),Q=O.parentLookup.has(e);return{node:Z,internals:Z.internals,isParent:Q}},oe);let N=l.type||"default",S=v?.[N]||Co[N];S===void 0&&(b?.("003",ge.error003(N)),N="default",S=v?.default||Co.default);const k=!!(l.draggable||c&&typeof l.draggable>"u"),D=!!(l.selectable||h&&typeof l.selectable>"u"),F=!!(l.connectable||a&&typeof l.connectable>"u"),_=!!(l.focusable||p&&typeof l.focusable>"u"),L=se(),z=Jo(l),E=ul({node:l,nodeType:N,hasDimensions:z,resizeObserver:d}),I=Ps({nodeRef:E,disabled:l.hidden||!k,noDragClassName:u,handleSelector:l.dragHandle,nodeId:e,isSelectable:D,nodeClickDistance:m}),M=js();if(l.hidden)return null;const A=ve(l),P=nl(l),T=D||k||t||n||o||s,R=n?O=>n(O,{...y.userNode}):void 0,H=o?O=>o(O,{...y.userNode}):void 0,$=s?O=>s(O,{...y.userNode}):void 0,W=r?O=>r(O,{...y.userNode}):void 0,V=i?O=>i(O,{...y.userNode}):void 0,U=O=>{const{selectNodesOnDrag:Z,nodeDragThreshold:Q}=L.getState();D&&(!Z||!k||Q>0)&&mn({id:e,store:L,nodeRef:E}),t&&t(O,{...y.userNode})},q=O=>{if(!(ns(O.nativeEvent)||g)){if(Wo.includes(O.key)&&D){const Z=O.key==="Escape";mn({id:e,store:L,unselect:Z,nodeRef:E})}else if(k&&l.selected&&Object.prototype.hasOwnProperty.call(Lt,O.key)){O.preventDefault();const{ariaLabelConfig:Z}=L.getState();L.setState({ariaLiveMessage:Z["node.a11yDescription.ariaLiveMessage"]({direction:O.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),M({direction:Lt[O.key],factor:O.shiftKey?4:1})}}},Y=()=>{if(g||!E.current?.matches(":focus-visible"))return;const{transform:O,width:Z,height:Q,autoPanOnNodeFocus:K,setCenter:X}=L.getState();if(!K)return;bn(new Map([[e,l]]),{x:0,y:0,width:Z,height:Q},O,!0).length>0||X(l.position.x+A.width/2,l.position.y+A.height/2,{zoom:O[2]})};return f.jsx("div",{className:re(["react-flow__node",`react-flow__node-${N}`,{[x]:k},l.className,{selected:l.selected,selectable:D,parent:C,draggable:k,dragging:I}]),ref:E,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:T?"all":"none",visibility:z?"visible":"hidden",...l.style,...P},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:R,onMouseMove:H,onMouseLeave:$,onContextMenu:W,onClick:U,onDoubleClick:V,onKeyDown:_?q:void 0,tabIndex:_?0:void 0,onFocus:_?Y:void 0,role:l.ariaRole??(_?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${bs}-${w}`,"aria-label":l.ariaLabel,...l.domAttributes,children:f.jsx(Xc,{value:e,children:f.jsx(S,{id:e,data:l.data,type:N,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:l.selected??!1,selectable:D,draggable:k,deletable:l.deletable??!0,isConnectable:F,sourcePosition:l.sourcePosition,targetPosition:l.targetPosition,dragging:I,dragHandle:l.dragHandle,zIndex:y.z,parentId:l.parentId,...A})})})}var hl=j.memo(fl);const pl=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function _s(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(pl,oe),i=cl(e.onlyRenderVisibleElements),c=dl();return f.jsx("div",{className:"react-flow__nodes",style:Ot,children:i.map(h=>f.jsx(hl,{id:h,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},h))})}_s.displayName="NodeRenderer";const ml=j.memo(_s);function gl(e){return J(j.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&ga({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const yl=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return f.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},xl=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return f.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},ko={[Fe.Arrow]:yl,[Fe.ArrowClosed]:xl};function wl(e){const t=se();return j.useMemo(()=>Object.prototype.hasOwnProperty.call(ko,e)?ko[e]:(t.getState().onError?.("009",ge.error009(e)),null),[e])}const vl=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const h=wl(t);return h?f.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:c,refX:"0",refY:"0",children:f.jsx(h,{color:n,strokeWidth:i})}):null},Ts=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=j.useMemo(()=>Na(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return s.length?f.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:f.jsx("defs",{children:s.map(r=>f.jsx(vl,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Ts.displayName="MarkerDefinitions";var bl=j.memo(Ts);function Ls({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:h,className:a,...p}){const[d,u]=j.useState({x:1,y:0,width:0,height:0}),x=re(["react-flow__edge-textwrapper",a]),g=j.useRef(null);return j.useEffect(()=>{if(g.current){const w=g.current.getBBox();u({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?f.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:x,visibility:d.width?"visible":"hidden",...p,children:[s&&f.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:c,ry:c}),f.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:g,style:o,children:n}),h]}):null}Ls.displayName="EdgeText";const El=j.memo(Ls);function Vt({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:h,interactionWidth:a=20,...p}){return f.jsxs(f.Fragment,{children:[f.jsx("path",{...p,d:e,fill:"none",className:re(["react-flow__edge-path",p.className])}),a?f.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:a,className:"react-flow__edge-interaction"}):null,o&&he(t)&&he(n)?f.jsx(El,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:h}):null]})}function Io({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===B.Left||e===B.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Rs({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:r=B.Top}){const[i,c]=Io({pos:n,x1:e,y1:t,x2:o,y2:s}),[h,a]=Io({pos:r,x1:o,y1:s,x2:e,y2:t}),[p,d,u,x]=ss({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:c,targetControlX:h,targetControlY:a});return[`M${e},${t} C${i},${c} ${h},${a} ${o},${s}`,p,d,u,x]}function zs(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:c,label:h,labelStyle:a,labelShowBg:p,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:x,style:g,markerEnd:w,markerStart:v,interactionWidth:m})=>{const[b,l,y]=Rs({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c}),C=e.isInternal?void 0:t;return f.jsx(Vt,{id:C,path:b,labelX:l,labelY:y,label:h,labelStyle:a,labelShowBg:p,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:x,style:g,markerEnd:w,markerStart:v,interactionWidth:m})})}const Sl=zs({isInternal:!1}),$s=zs({isInternal:!0});Sl.displayName="SimpleBezierEdge";$s.displayName="SimpleBezierEdgeInternal";function Hs(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:h,labelBgStyle:a,labelBgPadding:p,labelBgBorderRadius:d,style:u,sourcePosition:x=B.Bottom,targetPosition:g=B.Top,markerEnd:w,markerStart:v,pathOptions:m,interactionWidth:b})=>{const[l,y,C]=un({sourceX:n,sourceY:o,sourcePosition:x,targetX:s,targetY:r,targetPosition:g,borderRadius:m?.borderRadius,offset:m?.offset,stepPosition:m?.stepPosition}),N=e.isInternal?void 0:t;return f.jsx(Vt,{id:N,path:l,labelX:y,labelY:C,label:i,labelStyle:c,labelShowBg:h,labelBgStyle:a,labelBgPadding:p,labelBgBorderRadius:d,style:u,markerEnd:w,markerStart:v,interactionWidth:b})})}const Fs=Hs({isInternal:!1}),Os=Hs({isInternal:!0});Fs.displayName="SmoothStepEdge";Os.displayName="SmoothStepEdgeInternal";function Vs(e){return j.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return f.jsx(Fs,{...n,id:o,pathOptions:j.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const Nl=Vs({isInternal:!1}),Bs=Vs({isInternal:!0});Nl.displayName="StepEdge";Bs.displayName="StepEdgeInternal";function Ws(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:h,labelBgStyle:a,labelBgPadding:p,labelBgBorderRadius:d,style:u,markerEnd:x,markerStart:g,interactionWidth:w})=>{const[v,m,b]=as({sourceX:n,sourceY:o,targetX:s,targetY:r}),l=e.isInternal?void 0:t;return f.jsx(Vt,{id:l,path:v,labelX:m,labelY:b,label:i,labelStyle:c,labelShowBg:h,labelBgStyle:a,labelBgPadding:p,labelBgBorderRadius:d,style:u,markerEnd:x,markerStart:g,interactionWidth:w})})}const Cl=Ws({isInternal:!1}),Zs=Ws({isInternal:!0});Cl.displayName="StraightEdge";Zs.displayName="StraightEdgeInternal";function Ys(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=B.Bottom,targetPosition:c=B.Top,label:h,labelStyle:a,labelShowBg:p,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:x,style:g,markerEnd:w,markerStart:v,pathOptions:m,interactionWidth:b})=>{const[l,y,C]=rs({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c,curvature:m?.curvature}),N=e.isInternal?void 0:t;return f.jsx(Vt,{id:N,path:l,labelX:y,labelY:C,label:h,labelStyle:a,labelShowBg:p,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:x,style:g,markerEnd:w,markerStart:v,interactionWidth:b})})}const Ml=Ys({isInternal:!1}),Us=Ys({isInternal:!0});Ml.displayName="BezierEdge";Us.displayName="BezierEdgeInternal";const Po={default:Us,straight:Zs,step:Bs,smoothstep:Os,simplebezier:$s},jo={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},kl=(e,t,n)=>n===B.Left?e-t:n===B.Right?e+t:e,Il=(e,t,n)=>n===B.Top?e-t:n===B.Bottom?e+t:e,Ao="react-flow__edgeupdater";function Do({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:c}){return f.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([Ao,`${Ao}-${c}`]),cx:kl(t,o,e),cy:Il(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function Pl({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:c,targetPosition:h,onReconnect:a,onReconnectStart:p,onReconnectEnd:d,setReconnecting:u,setUpdateHover:x}){const g=se(),w=(y,C)=>{if(y.button!==0)return;const{autoPanOnConnect:N,domNode:S,isValidConnection:k,connectionMode:D,connectionRadius:F,lib:_,onConnectStart:L,onConnectEnd:z,cancelConnection:E,nodeLookup:I,rfId:M,panBy:A,updateConnection:P}=g.getState(),T=C.type==="target",R=(W,V)=>{u(!1),d?.(W,n,C.type,V)},H=W=>a?.(n,W),$=(W,V)=>{u(!0),p?.(y,n,C.type),L?.(W,V)};pn.onPointerDown(y.nativeEvent,{autoPanOnConnect:N,connectionMode:D,connectionRadius:F,domNode:S,handleId:C.id,nodeId:C.nodeId,nodeLookup:I,isTarget:T,edgeUpdaterType:C.type,lib:_,flowId:M,cancelConnection:E,panBy:A,isValidConnection:k,onConnect:H,onConnectStart:$,onConnectEnd:z,onReconnectEnd:R,updateConnection:P,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:y.currentTarget})},v=y=>w(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=y=>w(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>x(!0),l=()=>x(!1);return f.jsxs(f.Fragment,{children:[(e===!0||e==="source")&&f.jsx(Do,{position:c,centerX:o,centerY:s,radius:t,onMouseDown:v,onMouseEnter:b,onMouseOut:l,type:"source"}),(e===!0||e==="target")&&f.jsx(Do,{position:h,centerX:r,centerY:i,radius:t,onMouseDown:m,onMouseEnter:b,onMouseOut:l,type:"target"})]})}function jl({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:c,onMouseMove:h,onMouseLeave:a,reconnectRadius:p,onReconnect:d,onReconnectStart:u,onReconnectEnd:x,rfId:g,edgeTypes:w,noPanClassName:v,onError:m,disableKeyboardA11y:b}){let l=J(X=>X.edgeLookup.get(e));const y=J(X=>X.defaultEdgeOptions);l=y?{...y,...l}:l;let C=l.type||"default",N=w?.[C]||Po[C];N===void 0&&(m?.("011",ge.error011(C)),C="default",N=w?.default||Po.default);const S=!!(l.focusable||t&&typeof l.focusable>"u"),k=typeof d<"u"&&(l.reconnectable||n&&typeof l.reconnectable>"u"),D=!!(l.selectable||o&&typeof l.selectable>"u"),F=j.useRef(null),[_,L]=j.useState(!1),[z,E]=j.useState(!1),I=se(),{zIndex:M,sourceX:A,sourceY:P,targetX:T,targetY:R,sourcePosition:H,targetPosition:$}=J(j.useCallback(X=>{const G=X.nodeLookup.get(l.source),ee=X.nodeLookup.get(l.target);if(!G||!ee)return{zIndex:l.zIndex,...jo};const ne=Sa({id:e,sourceNode:G,targetNode:ee,sourceHandle:l.sourceHandle||null,targetHandle:l.targetHandle||null,connectionMode:X.connectionMode,onError:m});return{zIndex:ma({selected:l.selected,zIndex:l.zIndex,sourceNode:G,targetNode:ee,elevateOnSelect:X.elevateEdgesOnSelect,zIndexMode:X.zIndexMode}),...ne||jo}},[l.source,l.target,l.sourceHandle,l.targetHandle,l.selected,l.zIndex]),oe),W=j.useMemo(()=>l.markerStart?`url('#${fn(l.markerStart,g)}')`:void 0,[l.markerStart,g]),V=j.useMemo(()=>l.markerEnd?`url('#${fn(l.markerEnd,g)}')`:void 0,[l.markerEnd,g]);if(l.hidden||A===null||P===null||T===null||R===null)return null;const U=X=>{const{addSelectedEdges:G,unselectNodesAndEdges:ee,multiSelectionActive:ne}=I.getState();D&&(I.setState({nodesSelectionActive:!1}),l.selected&&ne?(ee({nodes:[],edges:[l]}),F.current?.blur()):G([e])),s&&s(X,l)},q=r?X=>{r(X,{...l})}:void 0,Y=i?X=>{i(X,{...l})}:void 0,O=c?X=>{c(X,{...l})}:void 0,Z=h?X=>{h(X,{...l})}:void 0,Q=a?X=>{a(X,{...l})}:void 0,K=X=>{if(!b&&Wo.includes(X.key)&&D){const{unselectNodesAndEdges:G,addSelectedEdges:ee}=I.getState();X.key==="Escape"?(F.current?.blur(),G({edges:[l]})):ee([e])}};return f.jsx("svg",{style:{zIndex:M},children:f.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${C}`,l.className,v,{selected:l.selected,animated:l.animated,inactive:!D&&!s,updating:_,selectable:D}]),onClick:U,onDoubleClick:q,onContextMenu:Y,onMouseEnter:O,onMouseMove:Z,onMouseLeave:Q,onKeyDown:S?K:void 0,tabIndex:S?0:void 0,role:l.ariaRole??(S?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":l.ariaLabel===null?void 0:l.ariaLabel||`Edge from ${l.source} to ${l.target}`,"aria-describedby":S?`${Es}-${g}`:void 0,ref:F,...l.domAttributes,children:[!z&&f.jsx(N,{id:e,source:l.source,target:l.target,type:l.type,selected:l.selected,animated:l.animated,selectable:D,deletable:l.deletable??!0,label:l.label,labelStyle:l.labelStyle,labelShowBg:l.labelShowBg,labelBgStyle:l.labelBgStyle,labelBgPadding:l.labelBgPadding,labelBgBorderRadius:l.labelBgBorderRadius,sourceX:A,sourceY:P,targetX:T,targetY:R,sourcePosition:H,targetPosition:$,data:l.data,style:l.style,sourceHandleId:l.sourceHandle,targetHandleId:l.targetHandle,markerStart:W,markerEnd:V,pathOptions:"pathOptions"in l?l.pathOptions:void 0,interactionWidth:l.interactionWidth}),k&&f.jsx(Pl,{edge:l,isReconnectable:k,reconnectRadius:p,onReconnect:d,onReconnectStart:u,onReconnectEnd:x,sourceX:A,sourceY:P,targetX:T,targetY:R,sourcePosition:H,targetPosition:$,setUpdateHover:L,setReconnecting:E})]})})}var Al=j.memo(jl);const Dl=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Xs({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:h,onEdgeMouseLeave:a,onEdgeClick:p,reconnectRadius:d,onEdgeDoubleClick:u,onReconnectStart:x,onReconnectEnd:g,disableKeyboardA11y:w}){const{edgesFocusable:v,edgesReconnectable:m,elementsSelectable:b,onError:l}=J(Dl,oe),y=gl(t);return f.jsxs("div",{className:"react-flow__edges",children:[f.jsx(bl,{defaultColor:e,rfId:n}),y.map(C=>f.jsx(Al,{id:C,edgesFocusable:v,edgesReconnectable:m,elementsSelectable:b,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:c,onMouseMove:h,onMouseLeave:a,onClick:p,reconnectRadius:d,onDoubleClick:u,onReconnectStart:x,onReconnectEnd:g,rfId:n,onError:l,edgeTypes:o,disableKeyboardA11y:w},C))]})}Xs.displayName="EdgeRenderer";const _l=j.memo(Xs),Tl=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Ll({children:e}){const t=J(Tl);return f.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Rl(e){const t=Pn(),n=j.useRef(!1);j.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const zl=e=>e.panZoom?.syncViewport;function $l(e){const t=J(zl),n=se();return j.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Hl(e){return e.connection.inProgress?{...e.connection,to:lt(e.connection.to,e.transform)}:{...e.connection}}function Fl(e){return Hl}function Ol(e){const t=Fl();return J(t,oe)}const Vl=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Bl({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:c,inProgress:h}=J(Vl,oe);return!(r&&s&&h)?null:f.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:f.jsx("g",{className:re(["react-flow__connection",Uo(c)]),children:f.jsx(Gs,{style:t,type:n,CustomComponent:o,isValid:c})})})}const Gs=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:c,fromPosition:h,to:a,toNode:p,toHandle:d,toPosition:u,pointer:x}=Ol();if(!s)return;if(n)return f.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:c,fromX:r.x,fromY:r.y,toX:a.x,toY:a.y,fromPosition:h,toPosition:u,connectionStatus:Uo(o),toNode:p,toHandle:d,pointer:x});let g="";const w={sourceX:r.x,sourceY:r.y,sourcePosition:h,targetX:a.x,targetY:a.y,targetPosition:u};switch(t){case Me.Bezier:[g]=rs(w);break;case Me.SimpleBezier:[g]=Rs(w);break;case Me.Step:[g]=un({...w,borderRadius:0});break;case Me.SmoothStep:[g]=un(w);break;default:[g]=as(w)}return f.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Gs.displayName="ConnectionLine";const Wl={};function _o(e=Wl){j.useRef(e),se(),j.useEffect(()=>{},[e])}function Zl(){se(),j.useRef(!1),j.useEffect(()=>{},[])}function qs({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:c,onNodeMouseMove:h,onNodeMouseLeave:a,onNodeContextMenu:p,onSelectionContextMenu:d,onSelectionStart:u,onSelectionEnd:x,connectionLineType:g,connectionLineStyle:w,connectionLineComponent:v,connectionLineContainerStyle:m,selectionKeyCode:b,selectionOnDrag:l,selectionMode:y,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:S,deleteKeyCode:k,onlyRenderVisibleElements:D,elementsSelectable:F,defaultViewport:_,translateExtent:L,minZoom:z,maxZoom:E,preventScrolling:I,defaultMarkerColor:M,zoomOnScroll:A,zoomOnPinch:P,panOnScroll:T,panOnScrollSpeed:R,panOnScrollMode:H,zoomOnDoubleClick:$,panOnDrag:W,onPaneClick:V,onPaneMouseEnter:U,onPaneMouseMove:q,onPaneMouseLeave:Y,onPaneScroll:O,onPaneContextMenu:Z,paneClickDistance:Q,nodeClickDistance:K,onEdgeContextMenu:X,onEdgeMouseEnter:G,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,onReconnect:ie,onReconnectStart:be,onReconnectEnd:we,noDragClassName:Ie,noWheelClassName:Ye,noPanClassName:Ue,disableKeyboardA11y:Xe,nodeExtent:Zt,rfId:dt,viewport:_e,onViewportChange:Ge}){return _o(e),_o(t),Zl(),Rl(n),$l(_e),f.jsx(il,{onPaneClick:V,onPaneMouseEnter:U,onPaneMouseMove:q,onPaneMouseLeave:Y,onPaneContextMenu:Z,onPaneScroll:O,paneClickDistance:Q,deleteKeyCode:k,selectionKeyCode:b,selectionOnDrag:l,selectionMode:y,onSelectionStart:u,onSelectionEnd:x,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:S,elementsSelectable:F,zoomOnScroll:A,zoomOnPinch:P,zoomOnDoubleClick:$,panOnScroll:T,panOnScrollSpeed:R,panOnScrollMode:H,panOnDrag:W,defaultViewport:_,translateExtent:L,minZoom:z,maxZoom:E,onSelectionContextMenu:d,preventScrolling:I,noDragClassName:Ie,noWheelClassName:Ye,noPanClassName:Ue,disableKeyboardA11y:Xe,onViewportChange:Ge,isControlledViewport:!!_e,children:f.jsxs(Ll,{children:[f.jsx(_l,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:ie,onReconnectStart:be,onReconnectEnd:we,onlyRenderVisibleElements:D,onEdgeContextMenu:X,onEdgeMouseEnter:G,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,defaultMarkerColor:M,noPanClassName:Ue,disableKeyboardA11y:Xe,rfId:dt}),f.jsx(Bl,{style:w,type:g,component:v,containerStyle:m}),f.jsx("div",{className:"react-flow__edgelabel-renderer"}),f.jsx(ml,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:c,onNodeMouseMove:h,onNodeMouseLeave:a,onNodeContextMenu:p,nodeClickDistance:K,onlyRenderVisibleElements:D,noPanClassName:Ue,noDragClassName:Ie,disableKeyboardA11y:Xe,nodeExtent:Zt,rfId:dt}),f.jsx("div",{className:"react-flow__viewport-portal"})]})})}qs.displayName="GraphView";const Yl=j.memo(qs),To=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:h=.5,maxZoom:a=2,nodeOrigin:p,nodeExtent:d,zIndexMode:u="basic"}={})=>{const x=new Map,g=new Map,w=new Map,v=new Map,m=o??t??[],b=n??e??[],l=p??[0,0],y=d??tt;ds(w,v,m);const C=hn(b,x,g,{nodeOrigin:l,nodeExtent:y,zIndexMode:u});let N=[0,0,1];if(i&&s&&r){const S=at(x,{filter:_=>!!((_.width||_.initialWidth)&&(_.height||_.initialHeight))}),{x:k,y:D,zoom:F}=En(S,s,r,h,a,c?.padding??.1);N=[k,D,F]}return{rfId:"1",width:s??0,height:r??0,transform:N,nodes:b,nodesInitialized:C,nodeLookup:x,parentLookup:g,edges:m,edgeLookup:v,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:h,maxZoom:a,translateExtent:tt,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:He.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:l,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:c,fitViewResolver:null,connection:{...Yo},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:la,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Zo,zIndexMode:u,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Ul=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:h,maxZoom:a,nodeOrigin:p,nodeExtent:d,zIndexMode:u})=>uc((x,g)=>{async function w(){const{nodeLookup:v,panZoom:m,fitViewOptions:b,fitViewResolver:l,width:y,height:C,minZoom:N,maxZoom:S}=g();m&&(await aa({nodes:v,width:y,height:C,panZoom:m,minZoom:N,maxZoom:S},b),l?.resolve(!0),x({fitViewResolver:null}))}return{...To({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:h,maxZoom:a,nodeOrigin:p,nodeExtent:d,defaultNodes:n,defaultEdges:o,zIndexMode:u}),setNodes:v=>{const{nodeLookup:m,parentLookup:b,nodeOrigin:l,elevateNodesOnSelect:y,fitViewQueued:C,zIndexMode:N}=g(),S=hn(v,m,b,{nodeOrigin:l,nodeExtent:d,elevateNodesOnSelect:y,checkEquality:!0,zIndexMode:N});C&&S?(w(),x({nodes:v,nodesInitialized:S,fitViewQueued:!1,fitViewOptions:void 0})):x({nodes:v,nodesInitialized:S})},setEdges:v=>{const{connectionLookup:m,edgeLookup:b}=g();ds(m,b,v),x({edges:v})},setDefaultNodesAndEdges:(v,m)=>{if(v){const{setNodes:b}=g();b(v),x({hasDefaultNodes:!0})}if(m){const{setEdges:b}=g();b(m),x({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:m,nodeLookup:b,parentLookup:l,domNode:y,nodeOrigin:C,nodeExtent:N,debug:S,fitViewQueued:k,zIndexMode:D}=g(),{changes:F,updatedInternals:_}=Aa(v,b,l,y,C,N,D);_&&(ka(b,l,{nodeOrigin:C,nodeExtent:N,zIndexMode:D}),k?(w(),x({fitViewQueued:!1,fitViewOptions:void 0})):x({}),F?.length>0&&(S&&console.log("React Flow: trigger node changes",F),m?.(F)))},updateNodePositions:(v,m=!1)=>{const b=[];let l=[];const{nodeLookup:y,triggerNodeChanges:C,connection:N,updateConnection:S,onNodesChangeMiddlewareMap:k}=g();for(const[D,F]of v){const _=y.get(D),L=!!(_?.expandParent&&_?.parentId&&F?.position),z={id:D,type:"position",position:L?{x:Math.max(0,F.position.x),y:Math.max(0,F.position.y)}:F.position,dragging:m};if(_&&N.inProgress&&N.fromNode.id===_.id){const E=De(_,N.fromHandle,B.Left,!0);S({...N,from:E})}L&&_.parentId&&b.push({id:D,parentId:_.parentId,rect:{...F.internals.positionAbsolute,width:F.measured.width??0,height:F.measured.height??0}}),l.push(z)}if(b.length>0){const{parentLookup:D,nodeOrigin:F}=g(),_=In(b,y,D,F);l.push(..._)}for(const D of k.values())l=D(l);C(l)},triggerNodeChanges:v=>{const{onNodesChange:m,setNodes:b,nodes:l,hasDefaultNodes:y,debug:C}=g();if(v?.length){if(y){const N=Cs(v,l);b(N)}C&&console.log("React Flow: trigger node changes",v),m?.(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:m,setEdges:b,edges:l,hasDefaultEdges:y,debug:C}=g();if(v?.length){if(y){const N=Ms(v,l);b(N)}C&&console.log("React Flow: trigger edge changes",v),m?.(v)}},addSelectedNodes:v=>{const{multiSelectionActive:m,edgeLookup:b,nodeLookup:l,triggerNodeChanges:y,triggerEdgeChanges:C}=g();if(m){const N=v.map(S=>Pe(S,!0));y(N);return}y(Re(l,new Set([...v]),!0)),C(Re(b))},addSelectedEdges:v=>{const{multiSelectionActive:m,edgeLookup:b,nodeLookup:l,triggerNodeChanges:y,triggerEdgeChanges:C}=g();if(m){const N=v.map(S=>Pe(S,!0));C(N);return}C(Re(b,new Set([...v]))),y(Re(l,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:m}={})=>{const{edges:b,nodes:l,nodeLookup:y,triggerNodeChanges:C,triggerEdgeChanges:N}=g(),S=v||l,k=m||b,D=S.map(_=>{const L=y.get(_.id);return L&&(L.selected=!1),Pe(_.id,!1)}),F=k.map(_=>Pe(_.id,!1));C(D),N(F)},setMinZoom:v=>{const{panZoom:m,maxZoom:b}=g();m?.setScaleExtent([v,b]),x({minZoom:v})},setMaxZoom:v=>{const{panZoom:m,minZoom:b}=g();m?.setScaleExtent([b,v]),x({maxZoom:v})},setTranslateExtent:v=>{g().panZoom?.setTranslateExtent(v),x({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:m,triggerNodeChanges:b,triggerEdgeChanges:l,elementsSelectable:y}=g();if(!y)return;const C=m.reduce((S,k)=>k.selected?[...S,Pe(k.id,!1)]:S,[]),N=v.reduce((S,k)=>k.selected?[...S,Pe(k.id,!1)]:S,[]);b(C),l(N)},setNodeExtent:v=>{const{nodes:m,nodeLookup:b,parentLookup:l,nodeOrigin:y,elevateNodesOnSelect:C,nodeExtent:N,zIndexMode:S}=g();v[0][0]===N[0][0]&&v[0][1]===N[0][1]&&v[1][0]===N[1][0]&&v[1][1]===N[1][1]||(hn(m,b,l,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:C,checkEquality:!1,zIndexMode:S}),x({nodeExtent:v}))},panBy:v=>{const{transform:m,width:b,height:l,panZoom:y,translateExtent:C}=g();return Da({delta:v,panZoom:y,transform:m,translateExtent:C,width:b,height:l})},setCenter:async(v,m,b)=>{const{width:l,height:y,maxZoom:C,panZoom:N}=g();if(!N)return Promise.resolve(!1);const S=typeof b?.zoom<"u"?b.zoom:C;return await N.setViewport({x:l/2-v*S,y:y/2-m*S,zoom:S},{duration:b?.duration,ease:b?.ease,interpolate:b?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{x({connection:{...Yo}})},updateConnection:v=>{x({connection:v})},reset:()=>x({...To()})}},Object.is);function An({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:c,initialFitViewOptions:h,fitView:a,nodeOrigin:p,nodeExtent:d,zIndexMode:u,children:x}){const[g]=j.useState(()=>Ul({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:a,minZoom:i,maxZoom:c,fitViewOptions:h,nodeOrigin:p,nodeExtent:d,zIndexMode:u}));return f.jsx(fc,{value:g,children:f.jsx(Lc,{children:x})})}function Xl({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:c,fitViewOptions:h,minZoom:a,maxZoom:p,nodeOrigin:d,nodeExtent:u,zIndexMode:x}){return j.useContext(Ht)?f.jsx(f.Fragment,{children:e}):f.jsx(An,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:c,initialFitViewOptions:h,initialMinZoom:a,initialMaxZoom:p,nodeOrigin:d,nodeExtent:u,zIndexMode:x,children:e})}const Gl={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function ql({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:c,onEdgeClick:h,onInit:a,onMove:p,onMoveStart:d,onMoveEnd:u,onConnect:x,onConnectStart:g,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:m,onNodeMouseEnter:b,onNodeMouseMove:l,onNodeMouseLeave:y,onNodeContextMenu:C,onNodeDoubleClick:N,onNodeDragStart:S,onNodeDrag:k,onNodeDragStop:D,onNodesDelete:F,onEdgesDelete:_,onDelete:L,onSelectionChange:z,onSelectionDragStart:E,onSelectionDrag:I,onSelectionDragStop:M,onSelectionContextMenu:A,onSelectionStart:P,onSelectionEnd:T,onBeforeDelete:R,connectionMode:H,connectionLineType:$=Me.Bezier,connectionLineStyle:W,connectionLineComponent:V,connectionLineContainerStyle:U,deleteKeyCode:q="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:O=!1,selectionMode:Z=nt.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:K=st()?"Meta":"Control",zoomActivationKeyCode:X=st()?"Meta":"Control",snapToGrid:G,snapGrid:ee,onlyRenderVisibleElements:ne=!1,selectNodesOnDrag:te,nodesDraggable:ie,autoPanOnNodeFocus:be,nodesConnectable:we,nodesFocusable:Ie,nodeOrigin:Ye=Ss,edgesFocusable:Ue,edgesReconnectable:Xe,elementsSelectable:Zt=!0,defaultViewport:dt=Cc,minZoom:_e=.5,maxZoom:Ge=2,translateExtent:Rn=tt,preventScrolling:cr=!0,nodeExtent:Yt,defaultMarkerColor:lr="#b1b1b7",zoomOnScroll:dr=!0,zoomOnPinch:ur=!0,panOnScroll:fr=!1,panOnScrollSpeed:hr=.5,panOnScrollMode:pr=je.Free,zoomOnDoubleClick:mr=!0,panOnDrag:gr=!0,onPaneClick:yr,onPaneMouseEnter:xr,onPaneMouseMove:wr,onPaneMouseLeave:vr,onPaneScroll:br,onPaneContextMenu:Er,paneClickDistance:Sr=1,nodeClickDistance:Nr=0,children:Cr,onReconnect:Mr,onReconnectStart:kr,onReconnectEnd:Ir,onEdgeContextMenu:Pr,onEdgeDoubleClick:jr,onEdgeMouseEnter:Ar,onEdgeMouseMove:Dr,onEdgeMouseLeave:_r,reconnectRadius:Tr=10,onNodesChange:Lr,onEdgesChange:Rr,noDragClassName:zr="nodrag",noWheelClassName:$r="nowheel",noPanClassName:zn="nopan",fitView:$n,fitViewOptions:Hn,connectOnClick:Hr,attributionPosition:Fr,proOptions:Or,defaultEdgeOptions:Vr,elevateNodesOnSelect:Br=!0,elevateEdgesOnSelect:Wr=!1,disableKeyboardA11y:Fn=!1,autoPanOnConnect:Zr,autoPanOnNodeDrag:Yr,autoPanSpeed:Ur,connectionRadius:Xr,isValidConnection:Gr,onError:qr,style:Kr,id:On,nodeDragThreshold:Qr,connectionDragThreshold:Jr,viewport:ei,onViewportChange:ti,width:ni,height:oi,colorMode:si="light",debug:ri,onScroll:Vn,ariaLabelConfig:ii,zIndexMode:Bn="basic",...ai},ci){const Ut=On||"1",li=Pc(si),di=j.useCallback(Wn=>{Wn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Vn?.(Wn)},[Vn]);return f.jsx("div",{"data-testid":"rf__wrapper",...ai,onScroll:di,style:{...Kr,...Gl},ref:ci,className:re(["react-flow",s,li]),id:On,role:"application",children:f.jsxs(Xl,{nodes:e,edges:t,width:ni,height:oi,fitView:$n,fitViewOptions:Hn,minZoom:_e,maxZoom:Ge,nodeOrigin:Ye,nodeExtent:Yt,zIndexMode:Bn,children:[f.jsx(Yl,{onInit:a,onNodeClick:c,onEdgeClick:h,onNodeMouseEnter:b,onNodeMouseMove:l,onNodeMouseLeave:y,onNodeContextMenu:C,onNodeDoubleClick:N,nodeTypes:r,edgeTypes:i,connectionLineType:$,connectionLineStyle:W,connectionLineComponent:V,connectionLineContainerStyle:U,selectionKeyCode:Y,selectionOnDrag:O,selectionMode:Z,deleteKeyCode:q,multiSelectionKeyCode:K,panActivationKeyCode:Q,zoomActivationKeyCode:X,onlyRenderVisibleElements:ne,defaultViewport:dt,translateExtent:Rn,minZoom:_e,maxZoom:Ge,preventScrolling:cr,zoomOnScroll:dr,zoomOnPinch:ur,zoomOnDoubleClick:mr,panOnScroll:fr,panOnScrollSpeed:hr,panOnScrollMode:pr,panOnDrag:gr,onPaneClick:yr,onPaneMouseEnter:xr,onPaneMouseMove:wr,onPaneMouseLeave:vr,onPaneScroll:br,onPaneContextMenu:Er,paneClickDistance:Sr,nodeClickDistance:Nr,onSelectionContextMenu:A,onSelectionStart:P,onSelectionEnd:T,onReconnect:Mr,onReconnectStart:kr,onReconnectEnd:Ir,onEdgeContextMenu:Pr,onEdgeDoubleClick:jr,onEdgeMouseEnter:Ar,onEdgeMouseMove:Dr,onEdgeMouseLeave:_r,reconnectRadius:Tr,defaultMarkerColor:lr,noDragClassName:zr,noWheelClassName:$r,noPanClassName:zn,rfId:Ut,disableKeyboardA11y:Fn,nodeExtent:Yt,viewport:ei,onViewportChange:ti}),f.jsx(Ic,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:x,onConnectStart:g,onConnectEnd:w,onClickConnectStart:v,onClickConnectEnd:m,nodesDraggable:ie,autoPanOnNodeFocus:be,nodesConnectable:we,nodesFocusable:Ie,edgesFocusable:Ue,edgesReconnectable:Xe,elementsSelectable:Zt,elevateNodesOnSelect:Br,elevateEdgesOnSelect:Wr,minZoom:_e,maxZoom:Ge,nodeExtent:Yt,onNodesChange:Lr,onEdgesChange:Rr,snapToGrid:G,snapGrid:ee,connectionMode:H,translateExtent:Rn,connectOnClick:Hr,defaultEdgeOptions:Vr,fitView:$n,fitViewOptions:Hn,onNodesDelete:F,onEdgesDelete:_,onDelete:L,onNodeDragStart:S,onNodeDrag:k,onNodeDragStop:D,onSelectionDrag:I,onSelectionDragStart:E,onSelectionDragStop:M,onMove:p,onMoveStart:d,onMoveEnd:u,noPanClassName:zn,nodeOrigin:Ye,rfId:Ut,autoPanOnConnect:Zr,autoPanOnNodeDrag:Yr,autoPanSpeed:Ur,onError:qr,connectionRadius:Xr,isValidConnection:Gr,selectNodesOnDrag:te,nodeDragThreshold:Qr,connectionDragThreshold:Jr,onBeforeDelete:R,debug:ri,ariaLabelConfig:ii,zIndexMode:Bn}),f.jsx(Nc,{onSelectionChange:z}),Cr,f.jsx(wc,{proOptions:Or,position:Fr}),f.jsx(xc,{rfId:Ut,disableKeyboardA11y:Fn})]})})}var Kl=ks(ql);function Ql(e){const[t,n]=j.useState(e),o=j.useCallback(s=>n(r=>Cs(s,r)),[]);return[t,n,o]}function Jl(e){const[t,n]=j.useState(e),o=j.useCallback(s=>n(r=>Ms(s,r)),[]);return[t,n,o]}function ed({dimensions:e,lineWidth:t,variant:n,className:o}){return f.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function td({radius:e,className:t}){return f.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var ke;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ke||(ke={}));const nd={[ke.Dots]:1,[ke.Lines]:1,[ke.Cross]:6},od=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ks({id:e,variant:t=ke.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:c,style:h,className:a,patternClassName:p}){const d=j.useRef(null),{transform:u,patternId:x}=J(od,oe),g=o||nd[t],w=t===ke.Dots,v=t===ke.Cross,m=Array.isArray(n)?n:[n,n],b=[m[0]*u[2]||1,m[1]*u[2]||1],l=g*u[2],y=Array.isArray(r)?r:[r,r],C=v?[l,l]:b,N=[y[0]*u[2]||1+C[0]/2,y[1]*u[2]||1+C[1]/2],S=`${x}${e||""}`;return f.jsxs("svg",{className:re(["react-flow__background",a]),style:{...h,...Ot,"--xy-background-color-props":c,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[f.jsx("pattern",{id:S,x:u[0]%b[0],y:u[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`,children:w?f.jsx(td,{radius:l/2,className:p}):f.jsx(ed,{dimensions:C,lineWidth:s,variant:t,className:p})}),f.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S})`})]})}Ks.displayName="Background";const sd=j.memo(Ks);function rd(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:f.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function id(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:f.jsx("path",{d:"M0 0h32v4.2H0z"})})}function ad(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:f.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function cd(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function ld(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function gt({children:e,className:t,...n}){return f.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const dd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Qs({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:c,onInteractiveChange:h,className:a,children:p,position:d="bottom-left",orientation:u="vertical","aria-label":x}){const g=se(),{isInteractive:w,minZoomReached:v,maxZoomReached:m,ariaLabelConfig:b}=J(dd,oe),{zoomIn:l,zoomOut:y,fitView:C}=Pn(),N=()=>{l(),r?.()},S=()=>{y(),i?.()},k=()=>{C(s),c?.()},D=()=>{g.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),h?.(!w)},F=u==="horizontal"?"horizontal":"vertical";return f.jsxs(Ft,{className:re(["react-flow__controls",F,a]),position:d,style:e,"data-testid":"rf__controls","aria-label":x??b["controls.ariaLabel"],children:[t&&f.jsxs(f.Fragment,{children:[f.jsx(gt,{onClick:N,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:m,children:f.jsx(rd,{})}),f.jsx(gt,{onClick:S,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:v,children:f.jsx(id,{})})]}),n&&f.jsx(gt,{className:"react-flow__controls-fitview",onClick:k,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:f.jsx(ad,{})}),o&&f.jsx(gt,{className:"react-flow__controls-interactive",onClick:D,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:w?f.jsx(ld,{}):f.jsx(cd,{})}),p]})}Qs.displayName="Controls";const ud=j.memo(Qs);function fd({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:c,strokeWidth:h,className:a,borderRadius:p,shapeRendering:d,selected:u,onClick:x}){const{background:g,backgroundColor:w}=r||{},v=i||g||w;return f.jsx("rect",{className:re(["react-flow__minimap-node",{selected:u},a]),x:t,y:n,rx:p,ry:p,width:o,height:s,style:{fill:v,stroke:c,strokeWidth:h},shapeRendering:d,onClick:x?m=>x(m,e):void 0})}const hd=j.memo(fd),pd=e=>e.nodes.map(t=>t.id),rn=e=>e instanceof Function?e:()=>e;function md({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=hd,onClick:i}){const c=J(pd,oe),h=rn(t),a=rn(e),p=rn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return f.jsx(f.Fragment,{children:c.map(u=>f.jsx(yd,{id:u,nodeColorFunc:h,nodeStrokeColorFunc:a,nodeClassNameFunc:p,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:d},u))})}function gd({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:c,onClick:h}){const{node:a,x:p,y:d,width:u,height:x}=J(g=>{const{internals:w}=g.nodeLookup.get(e),v=w.userNode,{x:m,y:b}=w.positionAbsolute,{width:l,height:y}=ve(v);return{node:v,x:m,y:b,width:l,height:y}},oe);return!a||a.hidden||!Jo(a)?null:f.jsx(c,{x:p,y:d,width:u,height:x,style:a.style,selected:!!a.selected,className:o(a),color:t(a),borderRadius:s,strokeColor:n(a),strokeWidth:r,shapeRendering:i,onClick:h,id:a.id})}const yd=j.memo(gd);var xd=j.memo(md);const wd=200,vd=150,bd=e=>!e.hidden,Ed=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Qo(at(e.nodeLookup,{filter:bd}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Sd="react-flow__minimap-desc";function Js({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:c,bgColor:h,maskColor:a,maskStrokeColor:p,maskStrokeWidth:d,position:u="bottom-right",onClick:x,onNodeClick:g,pannable:w=!1,zoomable:v=!1,ariaLabel:m,inversePan:b,zoomStep:l=1,offsetScale:y=5}){const C=se(),N=j.useRef(null),{boundingRect:S,viewBB:k,rfId:D,panZoom:F,translateExtent:_,flowWidth:L,flowHeight:z,ariaLabelConfig:E}=J(Ed,oe),I=e?.width??wd,M=e?.height??vd,A=S.width/I,P=S.height/M,T=Math.max(A,P),R=T*I,H=T*M,$=y*T,W=S.x-(R-S.width)/2-$,V=S.y-(H-S.height)/2-$,U=R+$*2,q=H+$*2,Y=`${Sd}-${D}`,O=j.useRef(0),Z=j.useRef();O.current=T,j.useEffect(()=>{if(N.current&&F)return Z.current=Oa({domNode:N.current,panZoom:F,getTransform:()=>C.getState().transform,getViewScale:()=>O.current}),()=>{Z.current?.destroy()}},[F]),j.useEffect(()=>{Z.current?.update({translateExtent:_,width:L,height:z,inversePan:b,pannable:w,zoomStep:l,zoomable:v})},[w,v,b,l,_,L,z]);const Q=x?G=>{const[ee,ne]=Z.current?.pointer(G)||[0,0];x(G,{x:ee,y:ne})}:void 0,K=g?j.useCallback((G,ee)=>{const ne=C.getState().nodeLookup.get(ee).internals.userNode;g(G,ne)},[]):void 0,X=m??E["minimap.ariaLabel"];return f.jsx(Ft,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-background-color-props":typeof a=="string"?a:void 0,"--xy-minimap-mask-stroke-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*T:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:f.jsxs("svg",{width:I,height:M,viewBox:`${W} ${V} ${U} ${q}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:N,onClick:Q,children:[X&&f.jsx("title",{id:Y,children:X}),f.jsx(xd,{onClick:K,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:c}),f.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-$},${V-$}h${U+$*2}v${q+$*2}h${-U-$*2}z
        M${k.x},${k.y}h${k.width}v${k.height}h${-k.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Js.displayName="MiniMap";const Nd=j.memo(Js),Cd=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Md={[We.Line]:"right",[We.Handle]:"bottom-right"};function kd({nodeId:e,position:t,variant:n=We.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:c=10,minHeight:h=10,maxWidth:a=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:u,autoScale:x=!0,shouldResize:g,onResizeStart:w,onResize:v,onResizeEnd:m}){const b=As(),l=typeof e=="string"?e:b,y=se(),C=j.useRef(null),N=n===We.Handle,S=J(j.useCallback(Cd(N&&x),[N,x]),oe),k=j.useRef(null),D=t??Md[n];j.useEffect(()=>{if(!(!C.current||!l))return k.current||(k.current=tc({domNode:C.current,nodeId:l,getStoreItems:()=>{const{nodeLookup:_,transform:L,snapGrid:z,snapToGrid:E,nodeOrigin:I,domNode:M}=y.getState();return{nodeLookup:_,transform:L,snapGrid:z,snapToGrid:E,nodeOrigin:I,paneDomNode:M}},onChange:(_,L)=>{const{triggerNodeChanges:z,nodeLookup:E,parentLookup:I,nodeOrigin:M}=y.getState(),A=[],P={x:_.x,y:_.y},T=E.get(l);if(T&&T.expandParent&&T.parentId){const R=T.origin??M,H=_.width??T.measured.width??0,$=_.height??T.measured.height??0,W={id:T.id,parentId:T.parentId,rect:{width:H,height:$,...es({x:_.x??T.position.x,y:_.y??T.position.y},{width:H,height:$},T.parentId,E,R)}},V=In([W],E,I,M);A.push(...V),P.x=_.x?Math.max(R[0]*H,_.x):void 0,P.y=_.y?Math.max(R[1]*$,_.y):void 0}if(P.x!==void 0&&P.y!==void 0){const R={id:l,type:"position",position:{...P}};A.push(R)}if(_.width!==void 0&&_.height!==void 0){const H={id:l,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:_.width,height:_.height}};A.push(H)}for(const R of L){const H={...R,type:"position"};A.push(H)}z(A)},onEnd:({width:_,height:L})=>{const z={id:l,type:"dimensions",resizing:!1,dimensions:{width:_,height:L}};y.getState().triggerNodeChanges([z])}})),k.current.update({controlPosition:D,boundaries:{minWidth:c,minHeight:h,maxWidth:a,maxHeight:p},keepAspectRatio:d,resizeDirection:u,onResizeStart:w,onResize:v,onResizeEnd:m,shouldResize:g}),()=>{k.current?.destroy()}},[D,c,h,a,p,d,w,v,m,g]);const F=D.split("-");return f.jsx("div",{className:re(["react-flow__resize-control","nodrag",...F,n,o]),ref:C,style:{...s,scale:S,...i&&{[N?"backgroundColor":"borderColor"]:i}},children:r})}j.memo(kd);const Ne={person:{bg:"#08427B",border:"#052E56",text:"#FFFFFF"},systemInternal:{bg:"#1168BD",border:"#0B4884",text:"#FFFFFF"},systemExternal:{bg:"#999999",border:"#6B6B6B",text:"#FFFFFF"},container:{bg:"#438DD5",border:"#2E6295",text:"#FFFFFF"},component:{bg:"#85BBF0",border:"#5D99C9",text:"#000000"},datastore:{bg:"#438DD5",border:"#2E6295",text:"#FFFFFF"},queue:{bg:"#438DD5",border:"#2E6295",text:"#FFFFFF"}};function Ze(e,t){switch(e){case"person":return Ne.person;case"system":return t?Ne.systemExternal:Ne.systemInternal;case"container":return Ne.container;case"component":return Ne.component;case"datastore":return Ne.datastore;case"queue":return Ne.queue;default:return Ne.systemInternal}}const Lo=e=>{let t;const n=new Set,o=(a,p)=>{const d=typeof a=="function"?a(t):a;if(!Object.is(d,t)){const u=t;t=p??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(x=>x(t,u))}},s=()=>t,c={setState:o,getState:s,getInitialState:()=>h,subscribe:a=>(n.add(a),()=>n.delete(a))},h=t=e(o,s,c);return c},Id=(e=>e?Lo(e):Lo),Pd=e=>e;function jd(e,t=Pd){const n=Ke.useSyncExternalStore(e.subscribe,Ke.useCallback(()=>t(e.getState()),[e,t]),Ke.useCallback(()=>t(e.getInitialState()),[e,t]));return Ke.useDebugValue(n),n}const Ro=e=>{const t=Id(e),n=o=>jd(t,o);return Object.assign(n,t),n},Bt=(e=>e?Ro(e):Ro),ye=Bt(e=>({data:null,isLoading:!1,error:null,loadFromJSON:t=>{e({data:t,isLoading:!1,error:null})},loadFromURL:async t=>{e({isLoading:!0,error:null});try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch: ${n.statusText}`);const o=await n.json();e({data:o,isLoading:!1,error:null})}catch(n){e({isLoading:!1,error:n instanceof Error?n.message:"Unknown error"})}},reset:()=>{e({data:null,isLoading:!1,error:null})}})),ue=Bt((e,t)=>({currentLevel:"L1",focusedSystemId:null,focusedContainerId:null,expandedNodes:new Set,breadcrumb:["Architecture"],setLevel:n=>{e({currentLevel:n})},drillDown:(n,o)=>{const s=t();o==="system"?e({currentLevel:"L2",focusedSystemId:n,focusedContainerId:null,breadcrumb:[...s.breadcrumb,n]}):o==="container"&&e({currentLevel:"L3",focusedContainerId:n,breadcrumb:[...s.breadcrumb,n]})},goUp:()=>{const n=t(),o=[...n.breadcrumb];o.pop(),n.currentLevel==="L3"?e({currentLevel:"L2",focusedContainerId:null,breadcrumb:o}):n.currentLevel==="L2"&&e({currentLevel:"L1",focusedSystemId:null,breadcrumb:o})},goToRoot:()=>{e({currentLevel:"L1",focusedSystemId:null,focusedContainerId:null,breadcrumb:["Architecture"]})},toggleExpand:n=>{const o=t(),s=new Set(o.expandedNodes);s.has(n)?s.delete(n):s.add(n),e({expandedNodes:s})}})),ae=Bt((e,t)=>({selectedNodeId:null,activeFlow:null,flowStep:0,isFlowPlaying:!1,selectNode:n=>{e({selectedNodeId:n})},setActiveFlow:n=>{e({activeFlow:n,flowStep:0,isFlowPlaying:!1})},setFlowStep:n=>{e({flowStep:n})},playFlow:()=>{e({isFlowPlaying:!0})},pauseFlow:()=>{e({isFlowPlaying:!1})},nextStep:()=>{const n=t(),o=(n.activeFlow?.steps?.length??1)-1;e({flowStep:Math.min(n.flowStep+1,o)})},prevStep:()=>{const n=t();e({flowStep:Math.max(n.flowStep-1,0)})}}));function Ad(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var r;const i=h=>h===null?null:JSON.parse(h,void 0),c=(r=n.getItem(s))!=null?r:null;return c instanceof Promise?c.then(i):i(c)},setItem:(s,r)=>n.setItem(s,JSON.stringify(r,void 0)),removeItem:s=>n.removeItem(s)}}const gn=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(o){return gn(o)(n)},catch(o){return this}}}catch(n){return{then(o){return this},catch(o){return gn(o)(n)}}}},Dd=(e,t)=>(n,o,s)=>{let r={storage:Ad(()=>localStorage),partialize:w=>w,version:0,merge:(w,v)=>({...v,...w}),...t},i=!1;const c=new Set,h=new Set;let a=r.storage;if(!a)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...w)},o,s);const p=()=>{const w=r.partialize({...o()});return a.setItem(r.name,{state:w,version:r.version})},d=s.setState;s.setState=(w,v)=>(d(w,v),p());const u=e((...w)=>(n(...w),p()),o,s);s.getInitialState=()=>u;let x;const g=()=>{var w,v;if(!a)return;i=!1,c.forEach(b=>{var l;return b((l=o())!=null?l:u)});const m=((v=r.onRehydrateStorage)==null?void 0:v.call(r,(w=o())!=null?w:u))||void 0;return gn(a.getItem.bind(a))(r.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==r.version){if(r.migrate){const l=r.migrate(b.state,b.version);return l instanceof Promise?l.then(y=>[!0,y]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var l;const[y,C]=b;if(x=r.merge(C,(l=o())!=null?l:u),n(x,!0),y)return p()}).then(()=>{m?.(x,void 0),x=o(),i=!0,h.forEach(b=>b(x))}).catch(b=>{m?.(void 0,b)})};return s.persist={setOptions:w=>{r={...r,...w},w.storage&&(a=w.storage)},clearStorage:()=>{a?.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(h.add(w),()=>{h.delete(w)})},r.skipHydration||g(),x||u},_d=Dd;Bt()(_d((e,t)=>({theme:"system",setTheme:n=>{e({theme:n}),Je(n)},toggleTheme:()=>{const o=t().theme==="dark"?"light":"dark";e({theme:o}),Je(o)}}),{name:"sruja-theme"}));function Je(e){const t=document.documentElement;if(e==="system"){const n=window.matchMedia("(prefers-color-scheme: dark)").matches;t.setAttribute("data-theme",n?"dark":"light")}else t.setAttribute("data-theme",e)}if(typeof window<"u"){const e=localStorage.getItem("sruja-theme");if(e)try{const{state:t}=JSON.parse(e);Je(t.theme)}catch{Je("system")}else Je("system")}function er({data:e,selected:t}){const n=e,o=Ze("system",n.isExternal),s=n.isExternal===!0,r=n.expanded===!0,i=(n.childCount??0)>0,c=ue(a=>a.toggleExpand),h=a=>{a.stopPropagation(),c(n.id)};return f.jsxs("div",{className:`c4-node system-node ${t?"selected":""} ${s?"external":""} ${r?"expanded":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx(ce,{type:"target",position:B.Top,className:"c4-handle"}),f.jsxs("div",{className:"node-header",children:[f.jsx("div",{className:"node-icon",children:f.jsx(wn,{size:24})}),f.jsxs("div",{className:"node-content",children:[f.jsx("div",{className:"node-label",children:n.label}),n.description&&f.jsx("div",{className:"node-description",children:n.description})]}),i&&f.jsxs("button",{className:"expand-btn",onClick:h,title:r?"Collapse":"Expand containers",children:[r?f.jsx(Si,{size:16}):f.jsx(bi,{size:16}),f.jsx("span",{className:"child-count",children:n.childCount})]})]}),!r&&i&&f.jsxs("div",{className:"node-badge",children:[n.childCount," container",(n.childCount??0)>1?"s":""]}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}er.__docgenInfo={description:"",methods:[],displayName:"SystemNode"};function tr({data:e,selected:t}){const n=e,o=Ze("container",n.isExternal),s=n.isExternal===!0;return f.jsxs("div",{className:`c4-node container-node ${t?"selected":""} ${s?"external":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx(ce,{type:"target",position:B.Top,className:"c4-handle"}),f.jsx("div",{className:"node-icon",children:f.jsx(xi,{size:20})}),f.jsxs("div",{className:"node-content",children:[f.jsx("div",{className:"node-label",children:n.label}),n.technology&&f.jsxs("div",{className:"node-technology",children:["[",n.technology,"]"]}),n.description&&f.jsx("div",{className:"node-description",children:n.description}),n.childCount!==void 0&&n.childCount>0&&f.jsxs("div",{className:"node-badge",children:[n.childCount," component",n.childCount>1?"s":""]})]}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}tr.__docgenInfo={description:"",methods:[],displayName:"ContainerNode"};function nr({data:e,selected:t}){const n=e,o=Ze("component",n.isExternal),s=n.isExternal===!0;return f.jsxs("div",{className:`c4-node component-node ${t?"selected":""} ${s?"external":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx(ce,{type:"target",position:B.Top,className:"c4-handle"}),f.jsx("div",{className:"node-icon",children:f.jsx(Ci,{size:18})}),f.jsxs("div",{className:"node-content",children:[f.jsx("div",{className:"node-label",children:n.label}),n.technology&&f.jsxs("div",{className:"node-technology",children:["[",n.technology,"]"]})]}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}nr.__docgenInfo={description:"",methods:[],displayName:"ComponentNode"};function or({data:e,selected:t}){const n=e,o=Ze("person",n.isExternal),s=n.isExternal===!0;return f.jsxs("div",{className:`c4-node person-node ${t?"selected":""} ${s?"external":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx("div",{className:"person-icon-circle",children:f.jsx(cn,{size:32})}),f.jsxs("div",{className:"node-content",children:[f.jsx("div",{className:"node-label",children:n.label}),n.description&&f.jsx("div",{className:"node-description",children:n.description})]}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}or.__docgenInfo={description:"",methods:[],displayName:"PersonNode"};function sr({data:e,selected:t}){const n=e,o=Ze("datastore",n.isExternal),s=n.isExternal===!0;return f.jsxs("div",{className:`c4-node datastore-node ${t?"selected":""} ${s?"external":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx(ce,{type:"target",position:B.Top,className:"c4-handle"}),f.jsx("div",{className:"node-icon",children:f.jsx(ki,{size:20})}),f.jsx("div",{className:"node-content",children:f.jsx("div",{className:"node-label",children:n.label})}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}sr.__docgenInfo={description:"",methods:[],displayName:"DataStoreNode"};function rr({data:e,selected:t}){const n=e,o=Ze("queue",n.isExternal),s=n.isExternal===!0;return f.jsxs("div",{className:`c4-node queue-node ${t?"selected":""} ${s?"external":""}`,style:{backgroundColor:o.bg,borderColor:o.border,color:o.text},children:[f.jsx(ce,{type:"target",position:B.Top,className:"c4-handle"}),f.jsx("div",{className:"node-icon",children:f.jsx(Ai,{size:20})}),f.jsx("div",{className:"node-content",children:f.jsx("div",{className:"node-label",children:n.label})}),f.jsx(ce,{type:"source",position:B.Bottom,className:"c4-handle"})]})}rr.__docgenInfo={description:"",methods:[],displayName:"QueueNode"};const Td={system:er,container:tr,component:nr,person:or,datastore:sr,queue:rr};function Wt({onHighlightEdge:e,onClearHighlight:t}){const n=ye(l=>l.data),o=ae(l=>l.activeFlow),s=ae(l=>l.flowStep),r=ae(l=>l.isFlowPlaying),i=ae(l=>l.setActiveFlow),c=ae(l=>l.playFlow),h=ae(l=>l.pauseFlow),a=ae(l=>l.nextStep),p=ae(l=>l.prevStep),d=j.useRef(null);j.useEffect(()=>(r&&o&&(d.current=window.setInterval(()=>{a()},2e3)),()=>{d.current&&(clearInterval(d.current),d.current=null)}),[r,o,a]),j.useEffect(()=>{o&&s>=(o.steps?.length??0)-1&&h()},[s,o,h]),j.useEffect(()=>{if(o?.steps&&s<o.steps.length){const l=o.steps[s];e&&e(l.from,l.to)}else t&&t()},[o,s,e,t]);const u=n?.architecture?.scenarios??[],x=n?.architecture?.flows??[],g=[...u,...x];if(g.length===0&&!o)return null;const w=l=>{i(l)},v=()=>{i(null),t&&t()},m=o?.steps?.[s],b=o?.steps?.length??0;return f.jsx("div",{className:"flow-controller",children:o?f.jsxs("div",{className:"flow-player",children:[f.jsxs("div",{className:"flow-info",children:[f.jsx("span",{className:"flow-title",children:o.title||o.label||o.id}),f.jsx("button",{className:"close-flow-btn",onClick:v,children:f.jsx(Ho,{size:14})})]}),f.jsxs("div",{className:"flow-controls",children:[f.jsx("button",{className:"control-btn",onClick:p,disabled:s===0,title:"Previous step",children:f.jsx(Ri,{size:16})}),r?f.jsx("button",{className:"control-btn play-btn",onClick:h,title:"Pause",children:f.jsx(_i,{size:18})}):f.jsx("button",{className:"control-btn play-btn",onClick:c,disabled:s>=b-1,title:"Play",children:f.jsx(an,{size:18})}),f.jsx("button",{className:"control-btn",onClick:a,disabled:s>=b-1,title:"Next step",children:f.jsx($i,{size:16})}),f.jsxs("span",{className:"step-indicator",children:[s+1," / ",b]})]}),m&&f.jsxs("div",{className:"step-info",children:[f.jsxs("div",{className:"step-path",children:[f.jsx("span",{className:"step-from",children:m.from}),f.jsx("span",{className:"step-arrow",children:""}),f.jsx("span",{className:"step-to",children:m.to})]}),m.description&&f.jsx("p",{className:"step-description",children:m.description})]})]}):f.jsxs("div",{className:"flow-selector",children:[f.jsx("span",{className:"flow-label",children:"Scenarios & Flows:"}),f.jsx("div",{className:"flow-list",children:g.map(l=>f.jsx("button",{className:"flow-item",onClick:()=>w(l),children:l.title||l.label||l.id},l.id))})]})})}Wt.__docgenInfo={description:"",methods:[],displayName:"FlowController",props:{onHighlightEdge:{required:!1,tsType:{name:"signature",type:"function",raw:"(from: string, to: string) => void",signature:{arguments:[{type:{name:"string"},name:"from"},{type:{name:"string"},name:"to"}],return:{name:"void"}}},description:""},onClearHighlight:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};function Ld(e,t){return e.views?Rd(e,t):Fd(e,t)}function Rd(e,t){const n=e.views,o=t.expandedNodes??new Set;let s;switch(t.level){case"L0":case"L1":s=n.L1;break;case"L2":t.focusedSystemId&&(s=n.L2[t.focusedSystemId]);break;case"L3":if(t.focusedSystemId&&t.focusedContainerId){const r=`${t.focusedSystemId}.${t.focusedContainerId}`;s=n.L3[r]}break}return s||(s=n.L1),zd(s,o)}function zd(e,t){const n=e.nodes.map((s,r)=>$d(s,r,t)),o=e.edges.map(s=>Hd(s));return{nodes:n,edges:o}}function $d(e,t,n){const o=t%4,s=Math.floor(t/4),r=250,i=180,c=n.has(e.id);return{id:e.id,type:e.type,position:{x:o*r,y:s*i},data:{id:e.id,label:e.label,type:e.type,technology:e.technology,description:e.description,isExternal:e.isExternal??!1,parentId:e.parentId,childCount:e.childCount,expanded:c}}}function Hd(e){return{id:e.id,source:e.source,target:e.target,label:e.label,type:"default",animated:!1,style:{stroke:"#707070",strokeWidth:1.5},markerEnd:{type:Fe.ArrowClosed,color:"#707070",width:20,height:20}}}function Fd(e,t){const n=[],o=[],s=new Set,r=t.expandedNodes??new Set;switch(t.level){case"L0":case"L1":Od(e,n,o,s,r);break;case"L2":Vd(e,t.focusedSystemId,n,o,s);break;case"L3":Bd(e,t.focusedSystemId,t.focusedContainerId,n,o,s);break}return{nodes:n,edges:o}}function Od(e,t,n,o,s){const r=e.architecture;let i=0;const c=300,h=200;r.persons?.forEach((a,p)=>{t.push(yn(a,p*c,0)),o.add(a.id)}),i=h,r.systems?.forEach((a,p)=>{const d=s.has(a.id);t.push(Wd(a,p*c,i,d)),o.add(a.id),d&&a.containers&&a.containers.forEach((u,x)=>{t.push(ir(u,p*c+50,i+100+x*80,a.id)),o.add(u.id)})}),r.relations?.forEach(a=>{if(o.has(a.from)&&o.has(a.to))n.push($e(a));else{const p=Ce(a.from,r,o),d=Ce(a.to,r,o);p&&d&&n.push($e({...a,from:p,to:d}))}})}function Vd(e,t,n,o,s){const r=e.architecture,i=r.systems?.find(m=>m.id===t);if(!i)return;const c=280,h=150,a=-200,p=0,d=new Set,u=Math.ceil(Math.sqrt(i.containers?.length??1));i.containers?.forEach((m,b)=>{const l=b%u,y=Math.floor(b/u);n.push(ir(m,l*c,h+y*180,t,!1)),s.add(m.id),d.add(m.id)});const x=h+Math.ceil((i.containers?.length??1)/u)*180+50;i.datastores?.forEach((m,b)=>{n.push(ar(m,b*c,x,!1)),s.add(m.id)}),i.queues?.forEach((m,b)=>{const l=(i.datastores?.length??0)*c+b*c;n.push(Yd(m,l,x,!1)),s.add(m.id)});const g=new Set;i.containers?.forEach(m=>{m.relations?.forEach(b=>{!d.has(b.from)&&!s.has(b.from)&&g.add(b.from),!d.has(b.to)&&!s.has(b.to)&&g.add(b.to)})}),i.relations?.forEach(m=>{s.has(m.from)||g.add(m.from),s.has(m.to)||g.add(m.to)}),r.relations?.forEach(m=>{const b=s.has(m.from)||m.from.startsWith(t+"."),l=s.has(m.to)||m.to.startsWith(t+".");b&&!l&&g.add(m.to),l&&!b&&g.add(m.from)});let w=0;g.forEach(m=>{const b=r.persons?.find(C=>C.id===m),l=r.systems?.find(C=>C.id===m||C.id===m.split(".")[0]),y=p+w*120;b?(n.push({...yn(b,a,y),data:{...yn(b,0,0).data,isExternal:!0}}),s.add(b.id)):l&&l.id!==t&&(n.push({id:l.id,type:"system",position:{x:a,y},data:{id:l.id,label:l.label??l.id,description:l.description,type:"system",isExternal:!0,childCount:l.containers?.length??0}}),s.add(l.id)),w++});const v=new Set;i.containers?.forEach(m=>{m.relations?.forEach(b=>{const l=`${b.from}-${b.to}`;if(!v.has(l)){const y=Ce(b.from,r,s),C=Ce(b.to,r,s);y&&C&&(o.push($e({...b,from:y,to:C})),v.add(l))}})}),i.relations?.forEach(m=>{const b=`${m.from}-${m.to}`;if(!v.has(b)){const l=Ce(m.from,r,s),y=Ce(m.to,r,s);l&&y&&(o.push($e({...m,from:l,to:y})),v.add(b))}}),r.relations?.forEach(m=>{const b=`${m.from}-${m.to}`;if(!v.has(b)){const l=Ce(m.from,r,s),y=Ce(m.to,r,s);l&&y&&(o.push($e({...m,from:l,to:y})),v.add(b))}})}function Bd(e,t,n,o,s,r){const i=e.architecture.systems?.find(p=>p.id===t);if(!i)return;const c=i.containers?.find(p=>p.id===n);if(!c)return;const h=200,a=50;c.components?.forEach((p,d)=>{o.push(Zd(p,d*h,a,n)),r.add(p.id)}),c.datastores?.forEach((p,d)=>{o.push(ar(p,d*h,a+150)),r.add(p.id)}),c.components?.forEach(p=>{p.relations?.forEach(d=>{s.push($e(d))})})}function Ce(e,t,n){if(n.has(e))return e;const o=e.split(".");if(o.length>1){const s=o[0];if(n.has(s))return s}return null}function yn(e,t,n){return{id:e.id,type:"person",position:{x:t,y:n},data:{id:e.id,label:e.label??e.id,description:e.description,type:"person"}}}function Wd(e,t,n,o){return{id:e.id,type:"system",position:{x:t,y:n},data:{id:e.id,label:e.label??e.id,description:e.description,type:"system",childCount:e.containers?.length??0,expanded:o}}}function ir(e,t,n,o,s=!1){return{id:e.id,type:"container",position:{x:t,y:n},parentId:o,data:{id:e.id,label:e.label??e.id,description:e.description,technology:e.technology,type:"container",childCount:e.components?.length??0,isExternal:s}}}function Zd(e,t,n,o){return{id:e.id,type:"component",position:{x:t,y:n},parentId:o,data:{id:e.id,label:e.label??e.id,description:e.description,technology:e.technology,type:"component"}}}function ar(e,t,n,o=!1){return{id:e.id,type:"datastore",position:{x:t,y:n},data:{id:e.id,label:e.label??e.id,type:"datastore",isExternal:o}}}function Yd(e,t,n,o=!1){return{id:e.id,type:"queue",position:{x:t,y:n},data:{id:e.id,label:e.label??e.id,type:"queue",isExternal:o}}}function $e(e,t=0){return{id:`edge-${e.from}-${e.to}-${t}`,source:e.from,target:e.to,label:e.label??e.verb,type:"default",animated:!1,style:{stroke:"#707070",strokeWidth:1.5},markerEnd:{type:Fe.ArrowClosed,color:"#707070",width:20,height:20}}}const Ud=new mi;async function Xd(e,t,n={}){const{direction:o="DOWN",nodeSpacing:s=80,layerSpacing:r=150}=n,i=new Set(e.map(d=>d.id)),c=t.filter(d=>i.has(d.source)&&i.has(d.target)),h=e.map(d=>({id:d.id,width:Gd(d.data?.type),height:qd(d.data?.type)})),a=c.map(d=>({id:d.id,sources:[d.source],targets:[d.target]})),p={id:"root",layoutOptions:{"elk.algorithm":"layered","elk.direction":o,"elk.spacing.nodeNode":String(s),"elk.layered.spacing.nodeNodeBetweenLayers":String(r),"elk.layered.considerModelOrder.strategy":"NODES_AND_EDGES"},children:h,edges:a};try{const d=await Ud.layout(p);return{nodes:e.map(x=>{const g=d.children?.find(w=>w.id===x.id);return g&&g.x!==void 0&&g.y!==void 0?{...x,position:{x:g.x,y:g.y}}:x}),edges:c}}catch(d){return console.error("ELK layout error:",d),{nodes:e,edges:c}}}function Gd(e){switch(e){case"person":return 120;case"system":return 200;case"container":return 180;case"component":return 160;case"datastore":return 160;case"queue":return 160;default:return 180}}function qd(e){switch(e){case"person":return 140;case"system":return 120;case"container":return 100;case"component":return 80;case"datastore":return 80;case"queue":return 80;default:return 100}}function Dn(){const e=ye(S=>S.data),t=ue(S=>S.currentLevel),n=ue(S=>S.focusedSystemId),o=ue(S=>S.focusedContainerId),s=ue(S=>S.expandedNodes),r=ue(S=>S.drillDown),i=ae(S=>S.selectNode),[c,h]=j.useState(!1),[a,p]=j.useState(null),{rawNodes:d,rawEdges:u}=j.useMemo(()=>{if(!e)return{rawNodes:[],rawEdges:[]};const S=Ld(e,{level:t,focusedSystemId:n??void 0,focusedContainerId:o??void 0,expandedNodes:s});return{rawNodes:S.nodes,rawEdges:S.edges}},[e,t,n,o,s]),[x,g,w]=Ql([]),[v,m,b]=Jl([]);j.useEffect(()=>{if(d.length===0){g([]),m([]),h(!1);return}h(!1),Xd(d,u,{direction:"DOWN"}).then(S=>{g(S.nodes),m(S.edges),h(!0)}).catch(S=>{console.error("Layout error:",S);const k=new Set(d.map(F=>F.id)),D=u.filter(F=>k.has(F.source)&&k.has(F.target));g(d),m(D),h(!0)})},[d,u,g,m]),j.useEffect(()=>{m(a?S=>S.map(k=>{const D=k.source===a.from&&k.target===a.to||k.source.endsWith(a.from)&&k.target.endsWith(a.to);return{...k,animated:D,style:{...k.style,stroke:D?"#ff6b35":"#707070",strokeWidth:D?3:1.5}}}):S=>S.map(k=>({...k,animated:!1,style:{...k.style,stroke:"#707070",strokeWidth:1.5}})))},[a,m]);const l=j.useCallback((S,k)=>{p({from:S,to:k})},[]),y=j.useCallback(()=>{p(null)},[]),C=j.useCallback((S,k)=>{i(k.id)},[i]),N=j.useCallback((S,k)=>{const D=k.data.type;D==="system"&&t==="L1"?r(k.id,"system"):D==="container"&&t==="L2"&&r(k.id,"container")},[t,r]);return e?f.jsxs("div",{className:"architecture-canvas",children:[!c&&x.length>0&&f.jsx("div",{className:"loading-overlay",children:f.jsx("div",{className:"loading-spinner"})}),f.jsx("div",{className:`canvas-fade ${c?"":"loading"}`,children:f.jsxs(Kl,{nodes:x,edges:v,onNodesChange:w,onEdgesChange:b,onNodeClick:C,onNodeDoubleClick:N,nodeTypes:Td,fitView:c,fitViewOptions:{padding:.2},minZoom:.1,maxZoom:2,children:[f.jsx(ud,{}),f.jsx(Nd,{nodeColor:S=>{switch(S.data?.type){case"person":return"var(--c4-person)";case"system":return"var(--c4-system)";case"container":return"var(--c4-container)";case"component":return"var(--c4-component)";default:return"#999"}}}),f.jsx(sd,{gap:16,size:1,color:"var(--border-color)"})]})}),f.jsx(Wt,{onHighlightEdge:l,onClearHighlight:y})]}):f.jsxs("div",{className:"empty-canvas",children:[f.jsx("p",{children:"No architecture loaded"}),f.jsx("p",{className:"hint",children:"Load a JSON file or paste JSON content to visualize"})]})}Dn.__docgenInfo={description:"",methods:[],displayName:"ArchitectureCanvas"};function _n(){const e=ye(a=>a.data),t=ue(a=>a.currentLevel),n=ue(a=>a.focusedSystemId),o=ue(a=>a.drillDown),s=ue(a=>a.goToRoot),r=ae(a=>a.setActiveFlow),i=j.useMemo(()=>e?.architecture.systems??[],[e]),c=j.useMemo(()=>e?.architecture.persons??[],[e]),h=j.useMemo(()=>e?.architecture.flows??[],[e]);return e?f.jsxs("div",{className:"navigation-panel",children:[f.jsxs("div",{className:"nav-section",children:[f.jsx("div",{className:"nav-section-title",children:"View Level"}),f.jsxs("div",{className:"level-buttons",children:[f.jsx("button",{className:`level-btn ${t==="L1"?"active":""}`,onClick:s,children:"L1 Context"}),f.jsx("button",{className:`level-btn ${t==="L2"?"active":""}`,disabled:!n,children:"L2 Container"}),f.jsx("button",{className:`level-btn ${t==="L3"?"active":""}`,disabled:t!=="L3",children:"L3 Component"})]})]}),f.jsxs("div",{className:"nav-section",children:[f.jsxs("div",{className:"nav-section-title",children:[f.jsx(wn,{size:14}),"Systems (",i.length,")"]}),f.jsx("ul",{className:"nav-tree",children:i.map(a=>f.jsx(Kd,{system:a,isSelected:n===a.id,onSelect:()=>o(a.id,"system")},a.id))})]}),c.length>0&&f.jsxs("div",{className:"nav-section",children:[f.jsxs("div",{className:"nav-section-title",children:[f.jsx(cn,{size:14}),"Actors (",c.length,")"]}),f.jsx("ul",{className:"nav-tree",children:c.map(a=>f.jsxs("li",{className:"nav-item",children:[f.jsx(cn,{size:12}),f.jsx("span",{children:a.label??a.id})]},a.id))})]}),h.length>0&&f.jsxs("div",{className:"nav-section",children:[f.jsxs("div",{className:"nav-section-title",children:[f.jsx(an,{size:14}),"Flows (",h.length,")"]}),f.jsx("ul",{className:"nav-tree",children:h.map(a=>f.jsxs("li",{className:"nav-item clickable",onClick:()=>r(a),children:[f.jsx(an,{size:12}),f.jsx("span",{children:a.title??a.label??a.id})]},a.id))})]})]}):f.jsx("div",{className:"navigation-panel",children:f.jsx("div",{className:"panel-empty",children:"Load an architecture to see navigation"})})}function Kd({system:e,isSelected:t,onSelect:n}){const o=(e.containers?.length??0)>0;return f.jsx("li",{className:`nav-item ${t?"selected":""}`,children:f.jsxs("button",{className:"nav-item-btn",onClick:n,children:[o?f.jsx(gi,{size:12}):f.jsx("span",{className:"spacer"}),f.jsx(wn,{size:12}),f.jsx("span",{className:"nav-item-label",children:e.label??e.id}),o&&f.jsx("span",{className:"nav-item-count",children:e.containers?.length})]})})}_n.__docgenInfo={description:"",methods:[],displayName:"NavigationPanel"};function Tn(){const e=ye(i=>i.data),t=ae(i=>i.selectedNodeId),n=ae(i=>i.selectNode);if(!t||!e)return null;const o=Qd(e,t);if(!o)return null;const{node:s,type:r}=o;return f.jsxs("div",{className:"details-panel",children:[f.jsxs("div",{className:"details-header",children:[f.jsx("h3",{className:"details-title",children:Jd(s)}),f.jsx("button",{className:"close-btn",onClick:()=>n(null),children:f.jsx(Ho,{size:16})})]}),f.jsxs("div",{className:"details-content",children:[f.jsxs("div",{className:"detail-row",children:[f.jsx("span",{className:"detail-label",children:"Type"}),f.jsx("span",{className:"detail-value type-badge",children:r})]}),f.jsxs("div",{className:"detail-row",children:[f.jsx("span",{className:"detail-label",children:"ID"}),f.jsx("span",{className:"detail-value code",children:s.id})]}),zo(s)&&f.jsxs("div",{className:"detail-section",children:[f.jsxs("div",{className:"section-title",children:[f.jsx(Pi,{size:14}),"Description"]}),f.jsx("p",{className:"description-text",children:zo(s)})]}),"technology"in s&&s.technology&&f.jsxs("div",{className:"detail-row",children:[f.jsx("span",{className:"detail-label",children:"Technology"}),f.jsx("span",{className:"detail-value",children:s.technology})]}),"tags"in s&&s.tags&&s.tags.length>0&&f.jsxs("div",{className:"detail-section",children:[f.jsxs("div",{className:"section-title",children:[f.jsx(Fi,{size:14}),"Tags"]}),f.jsx("div",{className:"tags-list",children:s.tags.map((i,c)=>f.jsx("span",{className:"tag",children:i},c))})]}),"containers"in s&&s.containers&&s.containers.length>0&&f.jsxs("div",{className:"detail-row",children:[f.jsx("span",{className:"detail-label",children:"Containers"}),f.jsx("span",{className:"detail-value",children:s.containers.length})]}),"components"in s&&s.components&&s.components.length>0&&f.jsxs("div",{className:"detail-row",children:[f.jsx("span",{className:"detail-label",children:"Components"}),f.jsx("span",{className:"detail-value",children:s.components.length})]})]})]})}function Qd(e,t){if(!e)return null;const n=e.architecture,o=n.persons?.find(s=>s.id===t);if(o)return{node:o,type:"Person"};for(const s of n.systems??[]){if(s.id===t)return{node:s,type:"System"};for(const r of s.containers??[]){if(r.id===t)return{node:r,type:"Container"};for(const i of r.components??[])if(i.id===t)return{node:i,type:"Component"}}}return null}function Jd(e){return e.label??e.id}function zo(e){return e.description}Tn.__docgenInfo={description:"",methods:[],displayName:"DetailsPanel"};const Ln={metadata:{name:"Simple Web App",version:"1.0.0",generated:new Date().toISOString()},architecture:{systems:[{id:"WebApp",label:"Web Application",description:"User-facing SPA",containers:[{id:"Frontend",label:"Frontend SPA",technology:"React",description:"React-based UI"},{id:"Backend",label:"API Server",technology:"Node.js",description:"REST API"}]},{id:"Database",label:"Database",description:"PostgreSQL database"}],persons:[{id:"User",label:"End User",description:"Customer using the web app"},{id:"Admin",label:"Administrator",description:"System administrator"}],relations:[{from:"User",to:"WebApp",label:"Uses",verb:"Uses"},{from:"Admin",to:"WebApp",label:"Administers",verb:"Administers"},{from:"WebApp",to:"Database",label:"Reads/Writes",verb:"Reads/Writes"}]},navigation:{levels:["L1","L2","L3"]}},xe={metadata:{name:"E-Commerce Platform",version:"1.0.0",generated:new Date().toISOString()},architecture:{systems:[{id:"EcommercePlatform",label:"E-Commerce Platform",description:"Main e-commerce system",containers:[{id:"WebStore",label:"Web Store",technology:"Next.js",description:"Customer-facing storefront"},{id:"API",label:"API Gateway",technology:"Express.js",description:"Central API"},{id:"OrderService",label:"Order Service",technology:"Node.js",description:"Order processing"},{id:"PaymentService",label:"Payment Service",technology:"Go",description:"Payment processing"},{id:"InventoryService",label:"Inventory Service",technology:"Python",description:"Stock management"}],datastores:[{id:"UserDB",label:"User Database"},{id:"ProductDB",label:"Product Database"},{id:"OrderDB",label:"Order Database"}]},{id:"PaymentGateway",label:"Payment Gateway",description:"External payment provider (Stripe)"},{id:"ShippingProvider",label:"Shipping Provider",description:"External shipping service"}],persons:[{id:"Customer",label:"Customer",description:"Online shopper"},{id:"Admin",label:"Store Admin",description:"Store administrator"},{id:"Supplier",label:"Supplier",description:"Product supplier"}],relations:[{from:"Customer",to:"EcommercePlatform.WebStore",label:"Browses & Purchases",verb:"Uses"},{from:"Admin",to:"EcommercePlatform.API",label:"Manages store",verb:"Manages"},{from:"EcommercePlatform.WebStore",to:"EcommercePlatform.API",label:"API calls",verb:"Calls"},{from:"EcommercePlatform.API",to:"EcommercePlatform.OrderService",label:"Orders",verb:"Routes"},{from:"EcommercePlatform.API",to:"EcommercePlatform.PaymentService",label:"Payments",verb:"Routes"},{from:"EcommercePlatform.API",to:"EcommercePlatform.InventoryService",label:"Inventory",verb:"Queries"},{from:"EcommercePlatform.PaymentService",to:"PaymentGateway",label:"Processes payment",verb:"Uses"},{from:"EcommercePlatform.OrderService",to:"ShippingProvider",label:"Ships order",verb:"Uses"}],flows:[{id:"checkout-flow",title:"Checkout Flow",description:"Customer completes a purchase",steps:[{from:"Customer",to:"EcommercePlatform.WebStore",description:"Customer adds items to cart"},{from:"EcommercePlatform.WebStore",to:"EcommercePlatform.API",description:"Submit order"},{from:"EcommercePlatform.API",to:"EcommercePlatform.InventoryService",description:"Check stock availability"},{from:"EcommercePlatform.API",to:"EcommercePlatform.PaymentService",description:"Process payment"},{from:"EcommercePlatform.PaymentService",to:"PaymentGateway",description:"Charge credit card"},{from:"EcommercePlatform.API",to:"EcommercePlatform.OrderService",description:"Create order"},{from:"EcommercePlatform.OrderService",to:"ShippingProvider",description:"Schedule delivery"}]}]},navigation:{levels:["L1","L2","L3"]}},eu={metadata:{name:"Microservices Demo",version:"1.0.0",generated:new Date().toISOString()},architecture:{systems:[{id:"Gateway",label:"API Gateway",description:"Kong API Gateway",containers:[{id:"Auth",label:"Auth Service",technology:"Keycloak"},{id:"Routing",label:"Routing",technology:"Kong"}]},{id:"UserService",label:"User Service",description:"User management microservice",containers:[{id:"UserAPI",label:"User API",technology:"Go"},{id:"UserDB",label:"User DB",technology:"PostgreSQL"}]},{id:"ProductService",label:"Product Service",description:"Product catalog microservice",containers:[{id:"ProductAPI",label:"Product API",technology:"Python"},{id:"ProductDB",label:"Product DB",technology:"MongoDB"},{id:"SearchIndex",label:"Search Index",technology:"Elasticsearch"}]},{id:"NotificationService",label:"Notification Service",description:"Email and push notifications",containers:[{id:"NotifyAPI",label:"Notification API",technology:"Node.js"},{id:"Queue",label:"Message Queue",technology:"RabbitMQ"}]}],persons:[{id:"Developer",label:"Developer",description:"API Consumer"},{id:"EndUser",label:"Mobile User",description:"Mobile app user"}],relations:[{from:"EndUser",to:"Gateway",label:"Mobile requests",verb:"Uses"},{from:"Developer",to:"Gateway",label:"API integration",verb:"Uses"},{from:"Gateway",to:"UserService",label:"User ops",verb:"Routes"},{from:"Gateway",to:"ProductService",label:"Product ops",verb:"Routes"},{from:"UserService",to:"NotificationService",label:"Send notifications",verb:"Publishes"},{from:"ProductService",to:"NotificationService",label:"Product alerts",verb:"Publishes"}]},navigation:{levels:["L1","L2","L3"]}};function me({data:e,showNavigation:t=!1,showDetails:n=!1,showFlow:o=!1,height:s="600px",selectNodeId:r}){const i=ye(a=>a.loadFromJSON),c=ae(a=>a.selectNode),h=ue(a=>a.goToRoot);return j.useEffect(()=>(h(),i(e),r&&setTimeout(()=>c(r),500),()=>{ye.getState().reset(),ue.getState().goToRoot(),ae.getState().selectNode(null)}),[e,i,h,c,r]),f.jsx(An,{children:f.jsxs("div",{style:{display:"flex",height:s,border:"1px solid var(--color-border, #e2e8f0)",borderRadius:8,overflow:"hidden",backgroundColor:"var(--color-surface, #fff)"},children:[t&&f.jsx("div",{style:{width:260,borderRight:"1px solid var(--color-border, #e2e8f0)",overflow:"auto"},children:f.jsx(_n,{})}),f.jsxs("div",{style:{flex:1,position:"relative"},children:[f.jsx(Dn,{}),o&&f.jsx("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)"},children:f.jsx(Wt,{})})]}),n&&f.jsx("div",{style:{width:300,borderLeft:"1px solid var(--color-border, #e2e8f0)"},children:f.jsx(Tn,{})})]})})}const fu={title:"Components/Architecture Visualizer",parameters:{layout:"fullscreen",docs:{description:{component:`
# Architecture Visualizer

A **ReactFlow-based** interactive C4 architecture viewer with support for:
- **Multi-level navigation** (L1 System Context  L2 Container  L3 Component)
- **Custom C4 node types** (System, Container, Component, Person, DataStore, Queue)
- **ELK auto-layout** for automatic node positioning
- **Flow/Scenario playback** with animated edge highlighting
- **Interactive selection** with detail panels

## Viewport Testing

Use the viewport toolbar to test responsive behavior. Architecture diagrams are best viewed on desktop or larger screens.
        `}}},globals:{viewport:{value:"desktop",isRotated:!1}}},yt={render:()=>f.jsx(me,{data:Ln,height:"500px"}),parameters:{docs:{description:{story:"A simple web application architecture with a frontend, backend, and database. Shows basic C4 visualization at the System Context (L1) level."}}}},xt={render:()=>f.jsx(me,{data:xe,height:"600px"}),parameters:{docs:{description:{story:"A complex e-commerce platform with multiple microservices, external integrations (payment gateway, shipping), and a checkout flow. Double-click on a system to drill down to the Container (L2) level."}}}},wt={render:()=>f.jsx(me,{data:eu,height:"600px"}),parameters:{docs:{description:{story:"A microservices architecture with an API gateway, multiple services (User, Product, Notification), and inter-service communication."}}}},vt={render:()=>f.jsx(me,{data:xe,showNavigation:!0,height:"650px"}),parameters:{docs:{description:{story:"Architecture canvas with the navigation sidebar. The sidebar shows view levels (L1/L2/L3), systems tree, actors, and available flows. Click on systems in the tree to drill down."}}}},bt={render:()=>f.jsx(me,{data:xe,showDetails:!0,selectNodeId:"EcommercePlatform",height:"600px"}),parameters:{docs:{description:{story:"Architecture canvas with the details panel shown on the right. Click any node to see its details including type, ID, description, technology, and child counts."}}}},Et={render:()=>f.jsx(me,{data:xe,showFlow:!0,height:"650px"}),parameters:{docs:{description:{story:'Architecture canvas with the flow controller. The e-commerce architecture includes a "Checkout Flow" that can be played step-by-step with animated edge highlighting. Click on the flow to start playback.'}}}},St={render:()=>f.jsx(me,{data:xe,showNavigation:!0,showDetails:!0,showFlow:!0,height:"700px"}),globals:{viewport:{value:"largeMonitor",isRotated:!1}},parameters:{docs:{description:{story:"Complete application layout with navigation panel, canvas, details panel, and flow controller. This shows all components working together as they would in the full Architecture Visualizer app. **Locked to Large Monitor (1920x1080) viewport.**"}}}},Nt={render:()=>{const e=()=>(j.useEffect(()=>{ye.getState().reset()},[]),f.jsx(An,{children:f.jsx("div",{style:{height:"400px",border:"1px solid var(--color-border, #e2e8f0)",borderRadius:8,overflow:"hidden"},children:f.jsx(Dn,{})})}));return f.jsx(e,{})},parameters:{docs:{description:{story:"The canvas in its empty state, showing the placeholder message prompting users to load architecture data."}}}},Ct={render:()=>{const e=()=>{const t=ye(n=>n.loadFromJSON);return j.useEffect(()=>{t(xe)},[t]),f.jsx("div",{style:{width:280,height:"500px",border:"1px solid var(--color-border, #e2e8f0)",borderRadius:8,overflow:"hidden",backgroundColor:"var(--color-surface, #fff)"},children:f.jsx(_n,{})})};return f.jsx(e,{})},parameters:{docs:{description:{story:"The navigation panel component shown standalone. Displays view level selector, systems tree with expandable items, actors list, and available flows."}}}},Mt={render:()=>{const e=()=>{const t=ye(o=>o.loadFromJSON),n=ae(o=>o.selectNode);return j.useEffect(()=>{t(xe),setTimeout(()=>n("EcommercePlatform"),100)},[t,n]),f.jsx("div",{style:{width:320,border:"1px solid var(--color-border, #e2e8f0)",borderRadius:8,overflow:"hidden",backgroundColor:"var(--color-surface, #fff)"},children:f.jsx(Tn,{})})};return f.jsx(e,{})},parameters:{docs:{description:{story:"The details panel component shown standalone. Displays selected node information including type badge, ID, description, technology, and child counts."}}}},kt={render:()=>{const e=()=>{const t=ye(n=>n.loadFromJSON);return j.useEffect(()=>{t(xe)},[t]),f.jsx("div",{style:{padding:16,backgroundColor:"var(--color-surface, #fff)",border:"1px solid var(--color-border, #e2e8f0)",borderRadius:8},children:f.jsx(Wt,{})})};return f.jsx(e,{})},parameters:{docs:{description:{story:"The flow controller component shown standalone. Select a flow to see the playback controls with play/pause, step forward/back, and current step information."}}}},It={render:()=>f.jsxs("div",{style:{padding:24,backgroundColor:"#1a1a2e",minHeight:"100vh"},children:[f.jsx("style",{children:`
        :root {
          --color-surface: #16213e;
          --color-border: #374151;
          --color-text-primary: #e5e7eb;
          --color-text-secondary: #9ca3af;
          --c4-person: #08a045;
          --c4-system: #438dd5;
          --c4-container: #438dd5;
          --c4-component: #85bbf0;
        }
      `}),f.jsx(me,{data:xe,showNavigation:!0,showFlow:!0,height:"600px"})]}),parameters:{docs:{description:{story:"Preview of the architecture visualizer in dark mode. The component respects CSS custom properties for theming."}},backgrounds:{default:"Dark Surface"}}},Pt={render:()=>f.jsx(me,{data:Ln,showNavigation:!0,height:"100%"}),globals:{viewport:{value:"tabletLandscape",isRotated:!1}},parameters:{docs:{description:{story:"Architecture canvas on a tablet-sized viewport (1024x768). Navigation panel is shown but may need scrolling. **Viewport is locked and cannot be changed.**"}}}},jt={render:()=>f.jsx(me,{data:Ln,height:"100%"}),globals:{viewport:{value:"mobile1",isRotated:!1}},parameters:{docs:{description:{story:"Architecture canvas on a mobile viewport (320x568). Demonstrates how the diagram scales on small screens - note that architecture diagrams are not optimized for mobile viewing. **Viewport is locked and cannot be changed.**"}}}},At={render:()=>f.jsx(me,{data:xe,height:"100%"}),globals:{viewport:{value:"presentation",isRotated:!1}},parameters:{docs:{description:{story:"Architecture canvas optimized for presentations (1600x900, 16:9 aspect ratio). Ideal for screen sharing or embedding in slides. **Viewport is locked and cannot be changed.**"}}}};yt.parameters={...yt.parameters,docs:{...yt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={SIMPLE_ARCHITECTURE} height="500px" />,
  parameters: {
    docs: {
      description: {
        story: 'A simple web application architecture with a frontend, backend, and database. Shows basic C4 visualization at the System Context (L1) level.'
      }
    }
  }
}`,...yt.parameters?.docs?.source}}};xt.parameters={...xt.parameters,docs:{...xt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} height="600px" />,
  parameters: {
    docs: {
      description: {
        story: 'A complex e-commerce platform with multiple microservices, external integrations (payment gateway, shipping), and a checkout flow. Double-click on a system to drill down to the Container (L2) level.'
      }
    }
  }
}`,...xt.parameters?.docs?.source}}};wt.parameters={...wt.parameters,docs:{...wt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={MICROSERVICES_ARCHITECTURE} height="600px" />,
  parameters: {
    docs: {
      description: {
        story: 'A microservices architecture with an API gateway, multiple services (User, Product, Notification), and inter-service communication.'
      }
    }
  }
}`,...wt.parameters?.docs?.source}}};vt.parameters={...vt.parameters,docs:{...vt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} showNavigation={true} height="650px" />,
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas with the navigation sidebar. The sidebar shows view levels (L1/L2/L3), systems tree, actors, and available flows. Click on systems in the tree to drill down.'
      }
    }
  }
}`,...vt.parameters?.docs?.source}}};bt.parameters={...bt.parameters,docs:{...bt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} showDetails={true} selectNodeId="EcommercePlatform" height="600px" />,
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas with the details panel shown on the right. Click any node to see its details including type, ID, description, technology, and child counts.'
      }
    }
  }
}`,...bt.parameters?.docs?.source}}};Et.parameters={...Et.parameters,docs:{...Et.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} showFlow={true} height="650px" />,
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas with the flow controller. The e-commerce architecture includes a "Checkout Flow" that can be played step-by-step with animated edge highlighting. Click on the flow to start playback.'
      }
    }
  }
}`,...Et.parameters?.docs?.source}}};St.parameters={...St.parameters,docs:{...St.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} showNavigation={true} showDetails={true} showFlow={true} height="700px" />,
  // Force this story to always render in Large Monitor viewport
  globals: {
    viewport: {
      value: 'largeMonitor',
      isRotated: false
    }
  },
  parameters: {
    docs: {
      description: {
        story: 'Complete application layout with navigation panel, canvas, details panel, and flow controller. This shows all components working together as they would in the full Architecture Visualizer app. **Locked to Large Monitor (1920x1080) viewport.**'
      }
    }
  }
}`,...St.parameters?.docs?.source}}};Nt.parameters={...Nt.parameters,docs:{...Nt.parameters?.docs,source:{originalSource:`{
  render: () => {
    const EmptyCanvas = () => {
      useEffect(() => {
        useArchitectureStore.getState().reset();
      }, []);
      return <ReactFlowProvider>
                    <div style={{
          height: '400px',
          border: '1px solid var(--color-border, #e2e8f0)',
          borderRadius: 8,
          overflow: 'hidden'
        }}>
                        <ArchitectureCanvas />
                    </div>
                </ReactFlowProvider>;
    };
    return <EmptyCanvas />;
  },
  parameters: {
    docs: {
      description: {
        story: 'The canvas in its empty state, showing the placeholder message prompting users to load architecture data.'
      }
    }
  }
}`,...Nt.parameters?.docs?.source}}};Ct.parameters={...Ct.parameters,docs:{...Ct.parameters?.docs,source:{originalSource:`{
  render: () => {
    const Wrapper = () => {
      const loadFromJSON = useArchitectureStore(s => s.loadFromJSON);
      useEffect(() => {
        loadFromJSON(ECOMMERCE_ARCHITECTURE);
      }, [loadFromJSON]);
      return <div style={{
        width: 280,
        height: '500px',
        border: '1px solid var(--color-border, #e2e8f0)',
        borderRadius: 8,
        overflow: 'hidden',
        backgroundColor: 'var(--color-surface, #fff)'
      }}>
                    <NavigationPanel />
                </div>;
    };
    return <Wrapper />;
  },
  parameters: {
    docs: {
      description: {
        story: 'The navigation panel component shown standalone. Displays view level selector, systems tree with expandable items, actors list, and available flows.'
      }
    }
  }
}`,...Ct.parameters?.docs?.source}}};Mt.parameters={...Mt.parameters,docs:{...Mt.parameters?.docs,source:{originalSource:`{
  render: () => {
    const Wrapper = () => {
      const loadFromJSON = useArchitectureStore(s => s.loadFromJSON);
      const selectNode = useSelectionStore(s => s.selectNode);
      useEffect(() => {
        loadFromJSON(ECOMMERCE_ARCHITECTURE);
        setTimeout(() => selectNode('EcommercePlatform'), 100);
      }, [loadFromJSON, selectNode]);
      return <div style={{
        width: 320,
        border: '1px solid var(--color-border, #e2e8f0)',
        borderRadius: 8,
        overflow: 'hidden',
        backgroundColor: 'var(--color-surface, #fff)'
      }}>
                    <DetailsPanel />
                </div>;
    };
    return <Wrapper />;
  },
  parameters: {
    docs: {
      description: {
        story: 'The details panel component shown standalone. Displays selected node information including type badge, ID, description, technology, and child counts.'
      }
    }
  }
}`,...Mt.parameters?.docs?.source}}};kt.parameters={...kt.parameters,docs:{...kt.parameters?.docs,source:{originalSource:`{
  render: () => {
    const Wrapper = () => {
      const loadFromJSON = useArchitectureStore(s => s.loadFromJSON);
      useEffect(() => {
        loadFromJSON(ECOMMERCE_ARCHITECTURE);
      }, [loadFromJSON]);
      return <div style={{
        padding: 16,
        backgroundColor: 'var(--color-surface, #fff)',
        border: '1px solid var(--color-border, #e2e8f0)',
        borderRadius: 8
      }}>
                    <FlowController />
                </div>;
    };
    return <Wrapper />;
  },
  parameters: {
    docs: {
      description: {
        story: 'The flow controller component shown standalone. Select a flow to see the playback controls with play/pause, step forward/back, and current step information.'
      }
    }
  }
}`,...kt.parameters?.docs?.source}}};It.parameters={...It.parameters,docs:{...It.parameters?.docs,source:{originalSource:`{
  render: () => <div style={{
    padding: 24,
    backgroundColor: '#1a1a2e',
    minHeight: '100vh'
  }}>
            <style>{\`
        :root {
          --color-surface: #16213e;
          --color-border: #374151;
          --color-text-primary: #e5e7eb;
          --color-text-secondary: #9ca3af;
          --c4-person: #08a045;
          --c4-system: #438dd5;
          --c4-container: #438dd5;
          --c4-component: #85bbf0;
        }
      \`}</style>
            <StoryWrapper data={ECOMMERCE_ARCHITECTURE} showNavigation={true} showFlow={true} height="600px" />
        </div>,
  parameters: {
    docs: {
      description: {
        story: 'Preview of the architecture visualizer in dark mode. The component respects CSS custom properties for theming.'
      }
    },
    backgrounds: {
      default: 'Dark Surface'
    }
  }
}`,...It.parameters?.docs?.source}}};Pt.parameters={...Pt.parameters,docs:{...Pt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={SIMPLE_ARCHITECTURE} showNavigation={true} height="100%" />,
  // Force tablet landscape viewport
  globals: {
    viewport: {
      value: 'tabletLandscape',
      isRotated: false
    }
  },
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas on a tablet-sized viewport (1024x768). Navigation panel is shown but may need scrolling. **Viewport is locked and cannot be changed.**'
      }
    }
  }
}`,...Pt.parameters?.docs?.source}}};jt.parameters={...jt.parameters,docs:{...jt.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={SIMPLE_ARCHITECTURE} height="100%" />,
  // Force mobile viewport
  globals: {
    viewport: {
      value: 'mobile1',
      isRotated: false
    }
  },
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas on a mobile viewport (320x568). Demonstrates how the diagram scales on small screens - note that architecture diagrams are not optimized for mobile viewing. **Viewport is locked and cannot be changed.**'
      }
    }
  }
}`,...jt.parameters?.docs?.source}}};At.parameters={...At.parameters,docs:{...At.parameters?.docs,source:{originalSource:`{
  render: () => <StoryWrapper data={ECOMMERCE_ARCHITECTURE} height="100%" />,
  // Force presentation viewport (16:9)
  globals: {
    viewport: {
      value: 'presentation',
      isRotated: false
    }
  },
  parameters: {
    docs: {
      description: {
        story: 'Architecture canvas optimized for presentations (1600x900, 16:9 aspect ratio). Ideal for screen sharing or embedding in slides. **Viewport is locked and cannot be changed.**'
      }
    }
  }
}`,...At.parameters?.docs?.source}}};const hu=["SimpleArchitecture","EcommercePlatform","MicroservicesDemo","WithNavigationPanel","WithDetailsPanel","WithFlowController","FullLayout","EmptyState","NavigationPanelStandalone","DetailsPanelStandalone","FlowControllerStandalone","DarkModePreview","TabletView","MobileView","PresentationView"];export{It as DarkModePreview,Mt as DetailsPanelStandalone,xt as EcommercePlatform,Nt as EmptyState,kt as FlowControllerStandalone,St as FullLayout,wt as MicroservicesDemo,jt as MobileView,Ct as NavigationPanelStandalone,At as PresentationView,yt as SimpleArchitecture,Pt as TabletView,bt as WithDetailsPanel,Et as WithFlowController,vt as WithNavigationPanel,hu as __namedExportsOrder,fu as default};
