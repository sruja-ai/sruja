import{a as s,R as C}from"./iframe-CLHqt8sP.js";import{p as F,n as E,a as h}from"./use-sync-refs-v6ctzwoA.js";function A(e=0){let[t,n]=s.useState(e),l=s.useCallback(r=>n(r),[]),i=s.useCallback(r=>n(d=>d|r),[]),a=s.useCallback(r=>(t&r)===r,[t]),u=s.useCallback(r=>n(d=>d&~r),[]),o=s.useCallback(r=>n(d=>d^r),[]);return{flags:t,setFlag:l,addFlag:i,hasFlag:a,removeFlag:u,toggleFlag:o}}var k={},g,v;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((g=process==null?void 0:k)==null?void 0:g.NODE_ENV)==="test"&&typeof((v=Element?.prototype)==null?void 0:v.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var S=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(S||{});function T(e){let t={};for(let n in e)e[n]===!0&&(t[`data-${n}`]="");return t}function _(e,t,n,l){let[i,a]=s.useState(n),{hasFlag:u,addFlag:o,removeFlag:r}=A(e&&i?3:0),d=s.useRef(!1),c=s.useRef(!1),y=F();return E(()=>{var p;if(e){if(n&&a(!0),!t){n&&o(3);return}return(p=l?.start)==null||p.call(l,n),x(t,{inFlight:d,prepare(){c.current?c.current=!1:c.current=d.current,d.current=!0,!c.current&&(n?(o(3),r(4)):(o(4),r(2)))},run(){c.current?n?(r(3),o(4)):(r(4),o(3)):n?r(1):o(1)},done(){var m;c.current&&O(t)||(d.current=!1,r(7),n||a(!1),(m=l?.end)==null||m.call(l,n))}})}},[e,n,t,y]),e?[i,{closed:u(1),enter:u(2),leave:u(4),transition:u(2)||u(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function x(e,{prepare:t,run:n,done:l,inFlight:i}){let a=h();return N(e,{prepare:t,inFlight:i}),a.nextFrame(()=>{n(),a.requestAnimationFrame(()=>{a.add(b(e,l))})}),a.dispose}function b(e,t){var n,l;let i=h();if(!e)return i.dispose;let a=!1;i.add(()=>{a=!0});let u=(l=(n=e.getAnimations)==null?void 0:n.call(e).filter(o=>o instanceof CSSTransition))!=null?l:[];return u.length===0?(t(),i.dispose):(Promise.allSettled(u.map(o=>o.finished)).then(()=>{a||t()}),i.dispose)}function N(e,{inFlight:t,prepare:n}){if(t!=null&&t.current){n();return}let l=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=l}function O(e){var t,n;return((n=(t=e.getAnimations)==null?void 0:t.call(e))!=null?n:[]).some(l=>l instanceof CSSTransition&&l.playState!=="finished")}let f=s.createContext(null);f.displayName="OpenClosedContext";var j=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(j||{});function $(){return s.useContext(f)}function w({value:e,children:t}){return C.createElement(f.Provider,{value:e},t)}function D({children:e}){return C.createElement(f.Provider,{value:null},e)}export{_ as N,w as c,j as i,D as s,$ as u,T as x};
