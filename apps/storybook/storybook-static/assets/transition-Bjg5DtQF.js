import{a as n,b as ee,R as h}from"./iframe-CLHqt8sP.js";import{c as z,n as F,Y as G,y as re,o as R,K as ne,A as me,b as pe,s as be,p as ge,C as x,u as te,m as Ee,d as Ce}from"./use-sync-refs-v6ctzwoA.js";import{u as le,i as y,N as Re,x as Te,c as $e}from"./open-closed-B--VY9yg.js";function we(){let e=typeof document>"u";return"useSyncExternalStore"in ee?(r=>r.useSyncExternalStore)(ee)(()=>()=>{},()=>!1,()=>!e):!1}function ie(){let e=we(),[r,t]=n.useState(z.isHandoffComplete);return r&&z.isHandoffComplete===!1&&t(!1),n.useEffect(()=>{r!==!0&&t(!0)},[r]),n.useEffect(()=>z.handoff(),[]),e?!1:r}function Se(){let e=n.useRef(!1);return F(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function se(e){var r;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!pe((r=e.as)!=null?r:ae)||h.Children.count(e.children)===1}let M=n.createContext(null);M.displayName="TransitionContext";var xe=(e=>(e.Visible="visible",e.Hidden="hidden",e))(xe||{});function Pe(){let e=n.useContext(M);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function ye(){let e=n.useContext(D);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let D=n.createContext(null);D.displayName="NestingContext";function I(e){return"children"in e?I(e.children):e.current.filter(({el:r})=>r.current!==null).filter(({state:r})=>r==="visible").length>0}function ue(e,r){let t=be(e),a=n.useRef([]),T=Se(),P=ge(),m=R((s,l=x.Hidden)=>{let u=a.current.findIndex(({el:i})=>i===s);u!==-1&&(te(l,{[x.Unmount](){a.current.splice(u,1)},[x.Hidden](){a.current[u].state="hidden"}}),P.microTask(()=>{var i;!I(a)&&T.current&&((i=t.current)==null||i.call(t))}))}),$=R(s=>{let l=a.current.find(({el:u})=>u===s);return l?l.state!=="visible"&&(l.state="visible"):a.current.push({el:s,state:"visible"}),()=>m(s,x.Unmount)}),b=n.useRef([]),d=n.useRef(Promise.resolve()),p=n.useRef({enter:[],leave:[]}),g=R((s,l,u)=>{b.current.splice(0),r&&(r.chains.current[l]=r.chains.current[l].filter(([i])=>i!==s)),r?.chains.current[l].push([s,new Promise(i=>{b.current.push(i)})]),r?.chains.current[l].push([s,new Promise(i=>{Promise.all(p.current[l].map(([w,H])=>H)).then(()=>i())})]),l==="enter"?d.current=d.current.then(()=>r?.wait.current).then(()=>u(l)):u(l)}),E=R((s,l,u)=>{Promise.all(p.current[l].splice(0).map(([i,w])=>w)).then(()=>{var i;(i=b.current.shift())==null||i()}).then(()=>u(l))});return n.useMemo(()=>({children:a,register:$,unregister:m,onStart:g,onStop:E,wait:d,chains:p}),[$,m,a,g,E,p,d])}let ae=n.Fragment,oe=me.RenderStrategy;function Fe(e,r){var t,a;let{transition:T=!0,beforeEnter:P,afterEnter:m,beforeLeave:$,afterLeave:b,enter:d,enterFrom:p,enterTo:g,entered:E,leave:s,leaveFrom:l,leaveTo:u,...i}=e,[w,H]=n.useState(null),o=n.useRef(null),C=se(e),S=re(...C?[o,r,H]:r===null?[]:[r]),Q=(t=i.unmount)==null||t?x.Unmount:x.Hidden,{show:f,appear:X,initial:Z}=Pe(),[v,j]=n.useState(f?"visible":"hidden"),q=ye(),{register:N,unregister:A}=q;F(()=>N(o),[N,o]),F(()=>{if(Q===x.Hidden&&o.current){if(f&&v!=="visible"){j("visible");return}return te(v,{hidden:()=>A(o),visible:()=>N(o)})}},[v,o,N,A,f,Q]);let V=ie();F(()=>{if(C&&V&&v==="visible"&&o.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[o,v,V,C]);let fe=Z&&!X,J=X&&f&&Z,Y=n.useRef(!1),U=ue(()=>{Y.current||(j("hidden"),A(o))},q),W=R(k=>{Y.current=!0;let K=k?"enter":"leave";U.onStart(o,K,L=>{L==="enter"?P?.():L==="leave"&&$?.()})}),_=R(k=>{let K=k?"enter":"leave";Y.current=!1,U.onStop(o,K,L=>{L==="enter"?m?.():L==="leave"&&b?.()}),K==="leave"&&!I(U)&&(j("hidden"),A(o))});n.useEffect(()=>{C&&T||(W(f),_(f))},[f,C,T]);let de=!(!T||!C||!V||fe),[,c]=Re(de,w,f,{start:W,end:_}),ve=Ee({ref:S,className:((a=Ce(i.className,J&&d,J&&p,c.enter&&d,c.enter&&c.closed&&p,c.enter&&!c.closed&&g,c.leave&&s,c.leave&&!c.closed&&l,c.leave&&c.closed&&u,!c.transition&&f&&E))==null?void 0:a.trim())||void 0,...Te(c)}),O=0;v==="visible"&&(O|=y.Open),v==="hidden"&&(O|=y.Closed),f&&v==="hidden"&&(O|=y.Opening),!f&&v==="visible"&&(O|=y.Closing);let he=ne();return h.createElement(D.Provider,{value:U},h.createElement($e,{value:O},he({ourProps:ve,theirProps:i,defaultTag:ae,features:oe,visible:v==="visible",name:"Transition.Child"})))}function He(e,r){let{show:t,appear:a=!1,unmount:T=!0,...P}=e,m=n.useRef(null),$=se(e),b=re(...$?[m,r]:r===null?[]:[r]);ie();let d=le();if(t===void 0&&d!==null&&(t=(d&y.Open)===y.Open),t===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[p,g]=n.useState(t?"visible":"hidden"),E=ue(()=>{t||g("hidden")}),[s,l]=n.useState(!0),u=n.useRef([t]);F(()=>{s!==!1&&u.current[u.current.length-1]!==t&&(u.current.push(t),l(!1))},[u,t]);let i=n.useMemo(()=>({show:t,appear:a,initial:s}),[t,a,s]);F(()=>{t?g("visible"):!I(E)&&m.current!==null&&g("hidden")},[t,E]);let w={unmount:T},H=R(()=>{var S;s&&l(!1),(S=e.beforeEnter)==null||S.call(e)}),o=R(()=>{var S;s&&l(!1),(S=e.beforeLeave)==null||S.call(e)}),C=ne();return h.createElement(D.Provider,{value:E},h.createElement(M.Provider,{value:i},C({ourProps:{...w,as:n.Fragment,children:h.createElement(ce,{ref:b,...w,...P,beforeEnter:H,beforeLeave:o})},theirProps:{},defaultTag:n.Fragment,features:oe,visible:p==="visible",name:"Transition"})))}function Oe(e,r){let t=n.useContext(M)!==null,a=le()!==null;return h.createElement(h.Fragment,null,!t&&a?h.createElement(B,{ref:r,...e}):h.createElement(ce,{ref:r,...e}))}let B=G(He),ce=G(Fe),Le=G(Oe),Ke=Object.assign(B,{Child:Le,Root:B});export{Ke as K,Le as O,Se as f,ie as l};
