function c(e){return typeof window>"u"?null:window[e]}function m(){return{async getDiagnostics(e){const o=c("sruja_get_diagnostics");if(!o)return[];try{const n=o(e);if(!n||!n.ok)return[];const i=JSON.parse(n.data);return Array.isArray(i)?i:[]}catch(n){return console.warn("WASM getDiagnostics failed:",n),[]}},async getSymbols(e){const o=c("sruja_get_symbols");if(!o)return[];try{const n=o(e);if(!n||!n.ok)return[];const i=JSON.parse(n.data);return Array.isArray(i)?i:[]}catch(n){return console.warn("WASM getSymbols failed:",n),[]}},async hover(e,o,n){const i=c("sruja_hover");if(!i)return null;try{const r=i(e,o,n);return!r||!r.ok||!r.data||r.data==="null"?null:JSON.parse(r.data)}catch(r){return console.warn("WASM hover failed:",r),null}},async completion(e,o,n){const i=c("sruja_completion");if(!i)return[];try{const r=i(e,o,n);if(!r||!r.ok)return[];const t=JSON.parse(r.data);return Array.isArray(t)?t:[]}catch(r){return console.warn("WASM completion failed:",r),[]}},async goToDefinition(e,o,n){const i=c("sruja_go_to_definition");if(!i)return null;try{const r=i(e,o,n);return!r||!r.ok||!r.data||r.data==="null"?null:JSON.parse(r.data)}catch(r){return console.warn("WASM goToDefinition failed:",r),null}},async format(e){const o=c("sruja_format");if(!o)return e;try{const n=o(e);return!n||!n.ok?e:n.data}catch(n){return console.warn("WASM format failed:",n),e}}}}function y(e,o,n){const i={provideDiagnostics:async t=>{const a=t.getValue(),s=(await n.getDiagnostics(a)).map(u=>({severity:u.severity==="Error"?e.MarkerSeverity.Error:u.severity==="Warning"?e.MarkerSeverity.Warning:e.MarkerSeverity.Info,message:u.message,startLineNumber:u.location.line,startColumn:u.location.column,endLineNumber:u.location.line,endColumn:u.location.column+10,code:u.code}));e.editor.setModelMarkers(t,"sruja-wasm",s)}};o.onDidChangeModelContent(()=>{const t=o.getModel();t&&i.provideDiagnostics(t)});const r=o.getModel();r&&i.provideDiagnostics(r),e.languages.registerHoverProvider("sruja",{provideHover:async(t,a)=>{const l=t.getValue(),s=await n.hover(l,a.lineNumber,a.column);return s?{range:new e.Range(a.lineNumber,a.column,a.lineNumber,a.column),contents:[{value:s.contents}]}:null}}),e.languages.registerCompletionItemProvider("sruja",{provideCompletionItems:async(t,a)=>{const l=t.getValue(),s=await n.completion(l,a.lineNumber,a.column),u=t.getWordUntilPosition(a),d=new e.Range(a.lineNumber,u.startColumn,a.lineNumber,u.endColumn);return{suggestions:s.map(g=>({label:g.label,kind:e.languages.CompletionItemKind.Keyword,insertText:g.label,range:d}))}}}),e.languages.registerDefinitionProvider("sruja",{provideDefinition:async(t,a)=>{const l=t.getValue(),s=await n.goToDefinition(l,a.lineNumber,a.column);return s?[{uri:t.uri,range:new e.Range(s.line,s.column,s.line,s.column+10)}]:[]}}),e.languages.registerDocumentFormattingEditProvider("sruja",{provideDocumentFormattingEdits:async t=>{const a=t.getValue(),l=await n.format(a);return[{range:t.getFullModelRange(),text:l}]}})}export{m as createWasmLspApi,y as initializeMonacoWasmLsp};
